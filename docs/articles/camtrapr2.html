<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Species and Individual Identification • camtrapR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Species and Individual Identification">
<meta property="og:description" content="camtrapR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">camtrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jniedballa/camtrapR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Species and Individual Identification</h1>
                        <h4 data-toc-skip class="author">Juergen
Niedballa (<a href="mailto:camtrapr@gmail.com" class="email">camtrapr@gmail.com</a>)</h4>
            
            <h4 data-toc-skip class="date">2023-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jniedballa/camtrapR/blob/HEAD/vignettes/camtrapr2.Rmd" class="external-link"><code>vignettes/camtrapr2.Rmd</code></a></small>
      <div class="hidden name"><code>camtrapr2.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jniedballa/camtrapR" class="external-link">camtrapR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">camtraps</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="methods-for-species-and-individual-identification---general">Methods for species and individual identification - General<a class="anchor" aria-label="anchor" href="#methods-for-species-and-individual-identification---general"></a>
</h2>
<p>Having organised your camera trap images into station (and camera)
directories as explained in the vignette “Organising raw camera trap
images in camtrapR”, you can begin with species (and individual)
identification.</p>
<p>Generally, species identification comes before individual
identification. camtrapR supports two different methods for identifying
species and individuals:</p>
<ol style="list-style-type: decimal">
<li>by moving renamed images into species/individual directories within
station directories (drag &amp; drop) or</li>
<li>by assigning metadata tags to images in image management software
(metadata tagging).</li>
</ol>
<p>It is recommended to to work with the renamed images (function
<code>imageRename</code>), not the original generic file names. Species
names are case-sensitive and must be spelled <em>exactly</em> the same
in each station, including interpunction and white spaces. “Leopard” is
not identical to “leopard” and “Pig-tailed Macaque” is different from
“Pig tailed Macaque”.</p>
<p>Since version 2.0.0, camtrapR supports video files. You can use both
of the following methods for identification (drag &amp; drop, metadata)
for video files as well.</p>
<div class="section level3">
<h3 id="drag-drop">Drag &amp; drop<a class="anchor" aria-label="anchor" href="#drag-drop"></a>
</h3>
<p>For species identification, images can be moved into species
directories created within station directories. The species ID is then
read from the directory name. Likewise, individuals can be identified by
moving them into indivdual directories. Be aware that one first needs to
collect all images of the species of interest (using
<code>getSpeciesImages</code> described below) before individual
identification.</p>
</div>
<div class="section level3">
<h3 id="metadata-tagging">Metadata tagging<a class="anchor" aria-label="anchor" href="#metadata-tagging"></a>
</h3>
<p>Metadata tags can be assigned to images in image management software.
They are saved in the image metadata automatically, from where they can
later be read out by two camtrapR functions (<code>recordTable</code>
and <code>recordTableIndividual</code>). Metadata tagging can be used to
assign custom tags to images, e.g. species ID, individual ID for
capture-recapture analyses, number of individuals on images, sex or age
class of individuals, behaviour etc..</p>
<div class="section level4">
<h4 id="image-management-software-recommendations-for-metadata-tagging">Image management software recommendations for metadata tagging<a class="anchor" aria-label="anchor" href="#image-management-software-recommendations-for-metadata-tagging"></a>
</h4>
<p>Here is a list of suitable software for metadata tagging:</p>
<ul>
<li>digiKam (<a href="https://www.digikam.org" class="external-link uri">https://www.digikam.org</a>)</li>
<li>Adobe Bridge</li>
<li>Adobe Lightroom</li>
</ul>
<p>Among these, we recommend digiKam because it is free and open-source
software. Furthermore, if you wish to assign tags to videos and read
them in camtrapR, tag the videos in digiKam. Extracting video tags
currently only works if videos were tagged with digiKam (requires
digiKam 6.0.0 or higher, tested with version 6.1.0).</p>
<p>All of these programs offer customisable metadata structures and are
easy to use. We only tested these three programs and it is unclear what
other software will work smoothly, if at all.</p>
</div>
<div class="section level4">
<h4 id="digikam-setup">digiKam setup<a class="anchor" aria-label="anchor" href="#digikam-setup"></a>
</h4>
<p>digiKam needs to write metadata tags into image metadata, not into
.xmp sidecar files. Its behaviour can be configured. Here’s how to set
up digiKam:</p>
<p>If installing for the first time, it will ask you to make a few
settings when you first start the program. When asked “Configure
Metadata Storage to Files”, set “Add Information to Files” instead of
the default “Do Nothing”.</p>
<p>If digiKam was installed already, go to “Settings”, then “Configure
digiKam”. There, select “Metadata” on the left and, in the tab
“Behaviour”, make sure that “Image tags” is checked in the box titled
“Write This Information to the Metadata”. Below, in the box “Reading and
Writing Metadata”, make sure that both “Read from sidecar files” and
“Write to sidecar files” are unchecked. In more recent versions of
digiKam, these two options are in a separate “Sidecars” tab, next to the
“Behaviour” tab.</p>
</div>
<div class="section level4">
<h4 id="metadata-tag-structure">Metadata tag structure<a class="anchor" aria-label="anchor" href="#metadata-tag-structure"></a>
</h4>
<p>Before assigning metadata tags, users need to set up a hierarchical
tag structure in image management software. This structure is
customisable and can be expanded as needed. In digiKam, this is done in
the Tag Manager. Here’s some examples:</p>
<ul>
<li>Species
<ul>
<li>SpeciesA</li>
<li>SpeciesB</li>
</ul>
</li>
<li>Individual
<ul>
<li>Female1</li>
<li>Female2</li>
<li>Male1</li>
<li>Male2</li>
</ul>
</li>
</ul>
<p>Previously, only one level of hierarchy was allowed in tags. Since
v.2.1.1, it is possible to specify multiple levels of hierarchy,
e.g. the following structure is now accepted:</p>
<ul>
<li>Species
<ul>
<li>Cat
<ul>
<li>Leopard Cat</li>
<li>Tiger</li>
</ul>
</li>
<li>Civet
<ul>
<li>Masked palm civet</li>
<li>Large Indian civet</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>If multiple tags are assigned in the same image (e.g. “Cat” and
“Leopard Cat”), the function will assign the “deepest” tag (“Leopard
Cat” in this case). Theoretically one can even set up even more tag
levels.</p>
<p>The crucial point is to set up tag groups (e.g. “Species” for species
identification) which then contain the desired tags (e.g. species tags
such as “Leopard Cat”, “Malay Civet” etc.) or further tag group
(e.g. “Cat” or “Civet” in the example above). This is what is meant by
hierarchical tag structure. For clarification, here is a screenshot of
the digiKam tag tree in which an image was identified as showing a
Leopard Cat.</p>
<div class="figure">
<img src="SpeciesID_digiKam.png" alt=""><p class="caption">The desired tag structure shown in a digiKam
screenshot</p>
</div>
<p>Two <strong>important</strong> warnings about metadata tagging: image
management software must be configured to write custom image metadata
tags into the images themselves, not into .xmp sidecar files. The
relevant functions cannot read tags from .xmp sidecar files. Make sure
you set the preferences in your image management software accordingly.
In digiKam, go to Settings/Configure digiKam/Metadata. There, make sure
“Write to sidecar files” is unchecked.</p>
<p>Secondly, do not use spaces or interpunction in the tag group
names.</p>
</div>
<div class="section level4">
<h4 id="how-does-metadata-extraction-work">How does metadata extraction work?<a class="anchor" aria-label="anchor" href="#how-does-metadata-extraction-work"></a>
</h4>
<p>This if for those who are interested in the technical details of how
custom metadata are saved in images. The image management software will
save metadata in a metadata tag field called “HierarchicalSubject” which
camtrapR can then read out. Let’s assume that in the above example we
had three images, showing:</p>
<ol style="list-style-type: decimal">
<li>SpeciesA,</li>
<li>Female1 of SpeciesB,</li>
<li>both species in the same image.</li>
</ol>
<p>Here’s what the content of the HierarchicalSubject field would look
like:</p>
<p>Species|SpeciesA</p>
<p>Species|SpeciesB, Individual|Female1</p>
<p>Species|SpeciesA, Species|SpeciesB</p>
<p>Note that multiple tags are separated by commas and hierarchy levels
are by default separated by a vertical bar (“|”). Adobe software also
lets you use colon (“:”); you can tell camtrapR which to use using
argument <code>metadataHierarchyDelimitor</code> in a number of
functions. camtrapR reads the content of HierarchicalSubject and can
automatically tabulate the contents.</p>
</div>
<div class="section level4">
<h4 id="and-how-about-metadata-extraction-from-videos">And how about metadata extraction from videos?<a class="anchor" aria-label="anchor" href="#and-how-about-metadata-extraction-from-videos"></a>
</h4>
<p>I’m glad you asked. In digiKam, it is possible to assign tags to
videos, just like tagging images. BUT, in contrast to images, digiKam
cannot write these tags directly into the video metadata. Instead, video
tags are stored in the digiKam database on your hard disk. So camtrapR
has to go straight to the digiKam database to read the tags directly
from the there. After some internal magic, it will construct and return
a HierarchicalSubject field as seen above for JPG images. camtrapR can
then extract and tabulate the relevant information of images and videos
alike.</p>
<p>That means that video tags are not extracted from the metadata, but
from the digiKam database. It also means that the tags are not part of
the video files and that sharing data and even copying video files on
your hard disk after tagging might cause the loss of metadata, so please
check carefully each step of what you are doing.</p>
</div>
<div class="section level4">
<h4 id="what-if-non-hierarchical-metadata-tags-were-assigned-to-images-already">What if non-hierarchical metadata tags were assigned to images
already?<a class="anchor" aria-label="anchor" href="#what-if-non-hierarchical-metadata-tags-were-assigned-to-images-already"></a>
</h4>
<p>If you have set of tagged images, but the tags are not structured
hierarchically as explained above, but rather flat (no tag groups, only
tags), they can easily be brought into the format needed by camtrapR in
digiKam. This will, however, change your original metadata structure. So
to be on the safe side, take some precautions:</p>
<ul>
<li>make a backup of your images,</li>
<li>first try it on a sub-dataset,</li>
<li>and maybe even do it on another computer (digiKam’s internal tag
structure changes and even re-loading the original images will not
restore it).</li>
</ul>
<p>Let’s assume you have species tags (e.g. “Leopard Cat”) that are not
hierarchically ordered. The digiKam workflow to order them
hierarchically (in order to make them readable in camtrapR) is as
follows:</p>
<ol style="list-style-type: decimal">
<li>Open the captions/tags window on the right side of your screen.</li>
<li>create a new tag (e.g. “Species”).</li>
<li>You can manipulate the tag structure by dragging tags around. So you
could then drag your species tags (e.g. “Leopard Cat”) into the
“Species” tag group (afterwards it should look similar to the screenshot
above). But note: dragging the tags around doesn’t update the image
metadata yet!</li>
<li>To update the image metadata with your new tag structure (and to
populate the image metadata tag “HierarchicalSubject” that camtrapR
reads), select the images, click the “More” button in the bottom right
corner of the screen, then “Write metadata to each file”.</li>
<li>Repeat the last step for each station directory.</li>
</ol>
<p>Afterwards, the “HierarchicalSubject” of your image metadata should
contain the tag structure. You can check using the
<code>exifTagNames</code> function as described in vignette 1.</p>
<p>This procedure also works for other tags, not only “Species”.</p>
</div>
<div class="section level4">
<h4 id="how-to-import-a-metadata-tag-tree-into-digikam">How to import a metadata tag tree into digiKam<a class="anchor" aria-label="anchor" href="#how-to-import-a-metadata-tag-tree-into-digikam"></a>
</h4>
<p>Consider this scenario: you created an elaborate tag tree and would
like to share it with colleagues for them to tag images independently,
but using the same tags that you use. Instead of making them create the
tags manually, you can use a dummy image, assign <em>all</em> possible
metadata tags of interest to it and share that tagged dummy image. Once
imported into digiKam on another machine, that machine’s digiKam tag
tree will be updated automatically and will then contain all tags
present in your dummy image.</p>
</div>
</div>
<div class="section level3">
<h3 id="double-observer-identification">Double observer identification<a class="anchor" aria-label="anchor" href="#double-observer-identification"></a>
</h3>
<p>Double observer identification is only available with metadata
tagging, not with the drag &amp; drop method. It can be used both for
species and individual identification (the latter with some limitations
detailed below). Both observers need to tag images independently using
separate metadata tag groups (e.g. “SpeciesID_Peter” and
“SpeciesID_Paul”). but with both observers using identical tags for the
same species/individual (e.g., not “Leopard Cat” and “leopard cat”). The
function <code>checkSpeciesIdentification</code> then returns images
that were assigned to different species/individuals by different
observers, which can then be harmonised (see below). It also returns
images that were tagged by one observer only.</p>
</div>
<div class="section level3">
<h3 id="comparison-of-identification-methods">Comparison of identification methods<a class="anchor" aria-label="anchor" href="#comparison-of-identification-methods"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Functionality</th>
<th>metadata tagging</th>
<th>drag &amp; drop</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>double observer identification</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="even">
<td>multiple species per image</td>
<td>yes</td>
<td>no<sup>1</sup>
</td>
</tr>
<tr class="odd">
<td>batch ID</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="even">
<td>filtering by tags</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="odd">
<td>crowd-source ID<sup>2</sup>
</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="even">
<td>portability and robustness</td>
<td>high<sup>3</sup>
</td>
<td>medium<sup>4</sup>
</td>
</tr>
</tbody>
</table>
<p><sup>1</sup> images need to be copied and moved to different species
directories to allow for this functionality</p>
<p><sup>2</sup> identification performed by independent observers on
sub-datasets</p>
<p><sup>3</sup> species identification tags are written into metadata
permanently</p>
<p><sup>4</sup> Species ID depends on directory structure</p>
</div>
</div>
<div class="section level2">
<h2 id="species-identification">Species identification<a class="anchor" aria-label="anchor" href="#species-identification"></a>
</h2>
<div class="section level3">
<h3 id="checking-species-names-with-the-itis-taxonomic-database">Checking species names with the ITIS taxonomic database<a class="anchor" aria-label="anchor" href="#checking-species-names-with-the-itis-taxonomic-database"></a>
</h3>
<p>Generally, you are free to use any species names you wish to -
scientific names, common names, local names, abbreviations, codes, etc.
But it may often be desirable to be consistent with species names,
e.g. to ensure long-term usability of data or to facilitate data
exchange between researchers. Therefore, users can check the species
names they wish to use in species identification (common or scientific
names) against the <a href="http://www.itis.gov" class="external-link">ITIS taxonomic
database</a> using the function <code>checkSpeciesNames</code>. The
function returns matching common and scientific names to the names
provided by the user, taxon ranks and authors, the ITIS taxonomic serial
number (TSN) and an ITIS taxon url. Internally, the function
<code>checkSpeciesNames</code> makes use of the R package
<code>taxize</code>.</p>
<p>If multiple matches are found, a menu allows users to choose their
species of interest (if argument <code>ask = TRUE</code>). By default,
only accepted species names are returned (controlled by argument
<code>accepted</code>). Invalid names will return NA.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find data for 2 species with correctly spelled names</span></span>
<span><span class="va">checkNames1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesNames.html">checkSpeciesNames</a></span> <span class="op">(</span>speciesNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bearded Pig"</span>, <span class="st">"Malayan Civet"</span><span class="op">)</span>,</span>
<span>                                  searchtype   <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span></span>
<span><span class="va">checkNames1</span></span></code></pre></div>
<pre><code><span><span class="co">##      tsn     user_name     scientificName              commonName   authorship</span></span>
<span><span class="co">## 1 625012   Bearded Pig       Sus barbatus bearded pig/Bearded Pig Müller, 1838</span></span>
<span><span class="co">## 2 622004 Malayan Civet Viverra tangalunga           Malayan Civet   Gray, 1832</span></span>
<span><span class="co">##   rankname</span></span>
<span><span class="co">## 1  Species</span></span>
<span><span class="co">## 2  Species</span></span>
<span><span class="co">##                                                                                itis_url</span></span>
<span><span class="co">## 1 https://www.itis.gov/servlet/SingleRpt/SingleRpt?search_topic=TSN&amp;search_value=625012</span></span>
<span><span class="co">## 2 https://www.itis.gov/servlet/SingleRpt/SingleRpt?search_topic=TSN&amp;search_value=622004</span></span>
<span><span class="co">##   taxon_status</span></span>
<span><span class="co">## 1        valid</span></span>
<span><span class="co">## 2        valid</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># and with scientific names (note that this is for a subspecies)</span></span>
<span><span class="va">checkNames2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesNames.html">checkSpeciesNames</a></span> <span class="op">(</span>speciesNames <span class="op">=</span> <span class="st">"Viverra tangalunga tangalunga"</span>,</span>
<span>                                  searchtype   <span class="op">=</span> <span class="st">"scientific"</span><span class="op">)</span></span>
<span><span class="va">checkNames2</span></span></code></pre></div>
<pre><code><span><span class="co">##      tsn                     user_name                scientificName commonName</span></span>
<span><span class="co">## 1 726578 Viverra tangalunga tangalunga Viverra tangalunga tangalunga         NA</span></span>
<span><span class="co">##   authorship   rankname</span></span>
<span><span class="co">## 1 Gray, 1832 Subspecies</span></span>
<span><span class="co">##                                                                                itis_url</span></span>
<span><span class="co">## 1 https://www.itis.gov/servlet/SingleRpt/SingleRpt?search_topic=TSN&amp;search_value=726578</span></span>
<span><span class="co">##   taxon_status</span></span>
<span><span class="co">## 1        valid</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># an invalid name: the accepted name of the leopard cat is Prionailurus bengalensis</span></span>
<span><span class="va">checkNames3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesNames.html">checkSpeciesNames</a></span> <span class="op">(</span>speciesNames <span class="op">=</span> <span class="st">"Felis bengalensis"</span>,</span>
<span>                                  searchtype   <span class="op">=</span> <span class="st">"scientific"</span>,</span>
<span>                                  accepted     <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">checkNames3</span></span></code></pre></div>
<pre><code><span><span class="co">##      tsn         user_name    scientificName  commonName authorship rankname</span></span>
<span><span class="co">## 1 183793 Felis bengalensis Felis bengalensis leopard cat Kerr, 1792  Species</span></span>
<span><span class="co">##                                                                                itis_url</span></span>
<span><span class="co">## 1 https://www.itis.gov/servlet/SingleRpt/SingleRpt?search_topic=TSN&amp;search_value=183793</span></span>
<span><span class="co">##   taxonUsageRating</span></span>
<span><span class="co">## 1          invalid</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># an ambiguous name name: Chevrotain (Tragulus)</span></span>
<span><span class="va">checkNames4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesNames.html">checkSpeciesNames</a></span> <span class="op">(</span>speciesNames <span class="op">=</span> <span class="st">"Chevrotain"</span>,</span>
<span>                                  searchtype   <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span></span>
<span><span class="fl">1</span>              <span class="co"># making a choice from the menu</span></span>
<span><span class="va">checkNames4</span></span></code></pre></div>
<pre><code><span><span class="co">##      tsn  user_name scientificName  commonName          authorship rankname</span></span>
<span><span class="co">## 1 624919 Chevrotain     Tragulidae chevrotains Milne-Edwards, 1864   Family</span></span>
<span><span class="co">##                                                                                itis_url</span></span>
<span><span class="co">## 1 https://www.itis.gov/servlet/SingleRpt/SingleRpt?search_topic=TSN&amp;search_value=624919</span></span>
<span><span class="co">##   taxon_status</span></span>
<span><span class="co">## 1        valid</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="species-identification-via-drag-drop-of-images">Species identification via drag &amp; drop of images<a class="anchor" aria-label="anchor" href="#species-identification-via-drag-drop-of-images"></a>
</h3>
<p>Species identification by moving images into species directories is
simple. It can be done in a generic file manager (provided it shows
preview images) or in the file manager that comes with image management
software (e.g. FastStone Image Viewer, IrfanView or digiKam). Images
must be <strong>moved</strong> into species directories. <strong>Don’t
copy</strong> images into species directories! All images must be placed
in species directories and no image may be left outside species
directories after identification.</p>
<div class="section level4">
<h4 id="creating-species-directories">Creating species directories<a class="anchor" aria-label="anchor" href="#creating-species-directories"></a>
</h4>
<p>The function <code>createSpeciesFolders</code> assists with species
identification by drag &amp; drop by creating species directories
automatically in all station directories. Alternatively, directories can
be created manually. <code>createSpeciesFolders</code> can also remove
empty species directories after identification (by setting
<code>removeFolders = FALSE</code>). In doing so, it will not touch
directories that contain any files.</p>
<p>It makes sense to create directories for all species one expects to
find in the study area, and possibly also for images one wants to
exclude later on, e.g. unidentifiable images, blank images or team
photos.</p>
<p>Here is an example in which we first create station directories and
the then species directories within these. Note that creating station
directories in the example is for demonstration purposes only. Normally,
at this point you would already have a directory structure with station
directories (possibly with camera subdirectories), each containing
renamed, unsorted images. Running <code>createStationFolders</code> here
therefore is for demonstration only.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this dummy directory will be used as inDir (containing station directories with species subdirectories)</span></span>
<span><span class="va">wd_createSpeciesFoldersTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, <span class="st">"createSpeciesFoldersTest"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now first create the station directories</span></span>
<span><span class="co"># (normally, you'd create species directories in the station directories that </span></span>
<span><span class="co"># already contain renamed, unsorted images). Again, this is for demonstation only.</span></span>
<span><span class="va">StationFolderCreate1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStationFolders.html">createStationFolders</a></span> <span class="op">(</span>inDir       <span class="op">=</span> <span class="va">wd_createSpeciesFoldersTest</span>,</span>
<span>                                              stations    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">camtraps</span><span class="op">$</span><span class="va">Station</span><span class="op">)</span>, </span>
<span>                                              createinDir <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## created 3 directories</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StationFolderCreate1</span></span></code></pre></div>
<pre><code><span><span class="co">##    station</span></span>
<span><span class="co">## 1 StationA</span></span>
<span><span class="co">## 2 StationB</span></span>
<span><span class="co">## 3 StationC</span></span>
<span><span class="co">##                                                                            directory</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationA</span></span>
<span><span class="co">## 2 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationB</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationC</span></span>
<span><span class="co">##   created exists</span></span>
<span><span class="co">## 1    TRUE   TRUE</span></span>
<span><span class="co">## 2    TRUE   TRUE</span></span>
<span><span class="co">## 3    TRUE   TRUE</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># species names for which we want to create subdirectories</span></span>
<span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sambar Deer"</span>, <span class="st">"Bay Cat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create species subdirectories</span></span>
<span><span class="va">SpeciesFolderCreate1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSpeciesFolders.html">createSpeciesFolders</a></span> <span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_createSpeciesFoldersTest</span>,</span>
<span>                                              species             <span class="op">=</span> <span class="va">species</span>,</span>
<span>                                              hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                              removeFolders       <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## created 6 directories</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpeciesFolderCreate1</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                                        directory</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationA/Sambar Deer</span></span>
<span><span class="co">## 2     C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationA/Bay Cat</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationB/Sambar Deer</span></span>
<span><span class="co">## 4     C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationB/Bay Cat</span></span>
<span><span class="co">## 5 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationC/Sambar Deer</span></span>
<span><span class="co">## 6     C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationC/Bay Cat</span></span>
<span><span class="co">##   created exists</span></span>
<span><span class="co">## 1    TRUE   TRUE</span></span>
<span><span class="co">## 2    TRUE   TRUE</span></span>
<span><span class="co">## 3    TRUE   TRUE</span></span>
<span><span class="co">## 4    TRUE   TRUE</span></span>
<span><span class="co">## 5    TRUE   TRUE</span></span>
<span><span class="co">## 6    TRUE   TRUE</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># delete empty species directories</span></span>
<span><span class="va">SpecFolderCreate2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSpeciesFolders.html">createSpeciesFolders</a></span> <span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_createSpeciesFoldersTest</span>,</span>
<span>                                           species             <span class="op">=</span> <span class="va">species</span>,</span>
<span>                                           hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                           removeFolders       <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## deleted 6 empty directories</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SpecFolderCreate2</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                                        directory</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationA/Sambar Deer</span></span>
<span><span class="co">## 2     C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationA/Bay Cat</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationB/Sambar Deer</span></span>
<span><span class="co">## 4     C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationB/Bay Cat</span></span>
<span><span class="co">## 5 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationC/Sambar Deer</span></span>
<span><span class="co">## 6     C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/createSpeciesFoldersTest/StationC/Bay Cat</span></span>
<span><span class="co">##   still.exists</span></span>
<span><span class="co">## 1        FALSE</span></span>
<span><span class="co">## 2        FALSE</span></span>
<span><span class="co">## 3        FALSE</span></span>
<span><span class="co">## 4        FALSE</span></span>
<span><span class="co">## 5        FALSE</span></span>
<span><span class="co">## 6        FALSE</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="moving-images-into-species-directories">Moving images into species directories<a class="anchor" aria-label="anchor" href="#moving-images-into-species-directories"></a>
</h4>
<p>Now is the time to move (not copy) images of species into the
prepared species directories. If images were misplaced (thereby
misidentified) they can be moved to another species directory at any
time. Rerun the following function and species identification will be
updated in your tables (see function <code>recordTable</code> in the
Data extraction vignette).</p>
</div>
</div>
<div class="section level3">
<h3 id="species-identification-by-metadata-tagging">Species identification by metadata tagging<a class="anchor" aria-label="anchor" href="#species-identification-by-metadata-tagging"></a>
</h3>
<p>If you wish to use metadata tagging for species identification, first
set up the hierarchical metadata tag structure as explained above. Also,
make sure your images are in station directories like this:</p>
<blockquote>
<p>inDir/Station/…</p>
</blockquote>
<p>or</p>
<blockquote>
<p>inDir/Station/Camera/…</p>
</blockquote>
<p>(… being the renamed JPG images). Note that the directory structure
is the one produced by function <code>imageRename</code>.</p>
<p>Now you can begin tagging your images. Contrary to species
identification by drag an drop, it is not necessary to create species
directories and to move images when using metadata tags for
identification. Several species tags can be assigned to the same image
if images recorded several species. They will be separated into separate
records when you tabulate records. Once identification is complete,
function <code>recordTable</code> will extract and tabulate the metadata
for you (see vignette “Extracting Data from Images”).</p>
</div>
<div class="section level3">
<h3 id="checking-species-identification">Checking species identification<a class="anchor" aria-label="anchor" href="#checking-species-identification"></a>
</h3>
<p>Misidentified images can act as false positives and can thus have
grave effects when analysing detection/non-detection data, e.g. with
occupancy models. Therefore it is very important to make sure species
identification is correct. Species may be misidentifed by moving images
into wrong directories or assigning wrong species tags. This can be
(partly) checked using function <code>checkSpeciesIdentification</code>.
Within each station and for each image, it assesses whether there are
images of another species taken within a given time interval. Often, it
is unlikely that different species are encountered within very short
time intervals at the same location. This can help to find images that
were misidentified, particularly if they were part of a sequence of
images. The function will not be able to find “isolated” images,
i.e. images that were misidentified, but were not part of a sequence of
images. Likewise, if all images of a sequence were misidentified, they
cannot be found either.</p>
<p><code>checkSpeciesIdentification</code> can check on species
identification for both methods of species identification: drag &amp;
drop into species directories or metadata tagging. The former requires
one of the following directory structures:</p>
<blockquote>
<p>inDir/Station/Species<br>
inDir/Station/Camera/Species</p>
</blockquote>
<p>The latter requires one of the following directory structures:</p>
<blockquote>
<p>inDir/Station<br>
inDir/Station/Camera</p>
</blockquote>
<p>Here is an example using images identified with the drag &amp; drop
method.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd_images_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"pictures/sample_images_species_dir"</span>, package <span class="op">=</span> <span class="st">"camtrapR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run check with 120 seconds (2 minutes) maximum time differnce</span></span>
<span><span class="va">check.folders</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesIdentification.html">checkSpeciesIdentification</a></span><span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_images_ID</span>,</span>
<span>                                            IDfrom              <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>                                            hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                            maxDeltaTime        <span class="op">=</span> <span class="fl">120</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## StationA : checking 8 images in 2 directories</span></span></code></pre>
<pre><code><span><span class="co">## StationB : checking 23 images in 4 directories</span></span></code></pre>
<pre><code><span><span class="co">## StationC : checking 37 images in 4 directories</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check.folders</span></span></code></pre></div>
<pre><code><span><span class="co">## $temporalIndependenceCheck</span></span>
<span><span class="co">##     station</span></span>
<span><span class="co">## 7  StationC</span></span>
<span><span class="co">## 29 StationC</span></span>
<span><span class="co">##                                                                                                      Directory</span></span>
<span><span class="co">## 7  C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationC/EGY</span></span>
<span><span class="co">## 29 C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationC/TRA</span></span>
<span><span class="co">##                                 FileName species    DateTimeOriginal</span></span>
<span><span class="co">## 7  StationC__2009-04-27__00-17-00(1).JPG     EGY 2009-04-27 00:17:00</span></span>
<span><span class="co">## 29 StationC__2009-04-27__00-19-00(1).JPG     TRA 2009-04-27 00:19:00</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $IDconflictCheck</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span></code></pre>
<p>The function returns a list with 2 elements. The first element
(<code>temporalIndependenceCheck</code>) is the check on temporal
proximity of different species (the second element
<code>IDconflictCheck</code> is describes in the next paragraph). In our
example, two images of different species were taken within 2 minutes of
one another at StationC (a chevrotain and a moon rat in our example).
Now one should check the species identity of these 2 images to make sure
they were identified correctly. If not, the species ID in the
incorrectly identified image is corrected. The function
<code>checkSpeciesIdentification</code> can be re-run as often as
desired. The behaviour of the function can be further specified by
arguments <code>excludeSpecies</code> and <code>stationsToCheck</code>.
The first causes camtrapR to ignore certain species and the latter can
be used to check only certain stations.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check only station A and B (will give no results)</span></span>
<span><span class="fu"><a href="../reference/checkSpeciesIdentification.html">checkSpeciesIdentification</a></span><span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_images_ID</span>,</span>
<span>                           IDfrom              <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>                           hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           maxDeltaTime        <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                           stationsToCheck     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"StationA"</span>, <span class="st">"StationB"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## StationA : checking 8 images in 2 directories</span></span></code></pre>
<pre><code><span><span class="co">## StationB : checking 23 images in 4 directories</span></span></code></pre>
<pre><code><span><span class="co">## $temporalIndependenceCheck</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $IDconflictCheck</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exclude chevrotains (Tragulus spp).  will give no results</span></span>
<span><span class="fu"><a href="../reference/checkSpeciesIdentification.html">checkSpeciesIdentification</a></span><span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_images_ID</span>,</span>
<span>                           IDfrom              <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>                           hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           maxDeltaTime        <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                           excludeSpecies      <span class="op">=</span> <span class="st">"TRA"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## StationA : checking 8 images in 2 directories</span></span>
<span><span class="co">## StationB : checking 23 images in 4 directories</span></span></code></pre>
<pre><code><span><span class="co">## StationC : checking 20 images in 3 directories</span></span></code></pre>
<pre><code><span><span class="co">## $temporalIndependenceCheck</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $IDconflictCheck</span></span>
<span><span class="co">## data frame with 0 columns and 0 rows</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="comparing-double-observer-identification">Comparing double observer identification<a class="anchor" aria-label="anchor" href="#comparing-double-observer-identification"></a>
</h3>
<p>The second element returned by
<code>checkSpeciesIdentification</code> (<code>IDconflictCheck</code>)
reports on images with conflicting IDs if two observers identified
images via metadata tagging. To that end, the arguments
<code>metadataSpeciesTag</code> and
<code>metadataSpeciesTagToCompare</code> need to be set. All records
that differ in their assigned IDs will be reported (also if one of them
is empty). If <code>metadataSpeciesTagToCompare</code> is not defined,
the data frame will be empty.</p>
</div>
<div class="section level3">
<h3 id="appending-species-names-to-image-files">Appending species names to image files<a class="anchor" aria-label="anchor" href="#appending-species-names-to-image-files"></a>
</h3>
<p>Once species are identified correctly, species names can be appended
to image file names using <code>appendSpeciesNames</code>. The species
names are taken from the directory names (of the drag and drop method
was used) or from metadata tags and will be appended to the image file
names. Set argument <code>IDfrom = "directory"</code> or
<code>IDfrom = "metadata"</code>, respectively. A data frame will show
directories, old and new file names.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># copy sample images to another location (so we don't mess around in the package directory)</span></span>
<span><span class="va">wd_images_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"pictures/sample_images_species_dir"</span>, package <span class="op">=</span> <span class="st">"camtrapR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">wd_images_ID</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span> , recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd_images_species_copy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, <span class="st">"sample_images_species_dir"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">species_names_append</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/appendSpeciesNames.html">appendSpeciesNames</a></span><span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_images_species_copy</span>,</span>
<span>                                           IDfrom              <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>                                           hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## renamed 68 out of 68 images in C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">species_names_append</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                                 directory</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 2 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 4 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 5 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 6 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">##                            filename_old species</span></span>
<span><span class="co">## 1 StationA__2009-04-21__00-40-00(1).JPG     PBE</span></span>
<span><span class="co">## 2 StationA__2009-04-22__20-19-00(1).JPG     PBE</span></span>
<span><span class="co">## 3 StationA__2009-04-22__20-21-00(1).JPG     PBE</span></span>
<span><span class="co">## 4 StationA__2009-04-23__00-07-00(1).JPG     PBE</span></span>
<span><span class="co">## 5 StationA__2009-04-23__00-09-00(1).JPG     PBE</span></span>
<span><span class="co">## 6 StationA__2009-05-07__17-11-00(1).JPG     PBE</span></span>
<span><span class="co">##                                 filename_new renamed</span></span>
<span><span class="co">## 1 StationA__2009-04-21__00-40-00(1)__PBE.JPG    TRUE</span></span>
<span><span class="co">## 2 StationA__2009-04-22__20-19-00(1)__PBE.JPG    TRUE</span></span>
<span><span class="co">## 3 StationA__2009-04-22__20-21-00(1)__PBE.JPG    TRUE</span></span>
<span><span class="co">## 4 StationA__2009-04-23__00-07-00(1)__PBE.JPG    TRUE</span></span>
<span><span class="co">## 5 StationA__2009-04-23__00-09-00(1)__PBE.JPG    TRUE</span></span>
<span><span class="co">## 6 StationA__2009-05-07__17-11-00(1)__PBE.JPG    TRUE</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_names_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/appendSpeciesNames.html">appendSpeciesNames</a></span><span class="op">(</span>inDir               <span class="op">=</span> <span class="va">wd_images_species_copy</span>,</span>
<span>                                           IDfrom              <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>                                           hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                           removeNames         <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## renamed 68 out of 68 images in C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">species_names_remove</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                                 directory</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 2 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 4 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 5 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">## 6 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sample_images_species_dir/StationA/PBE</span></span>
<span><span class="co">##                                 filename_old species</span></span>
<span><span class="co">## 1 StationA__2009-04-21__00-40-00(1)__PBE.JPG     PBE</span></span>
<span><span class="co">## 2 StationA__2009-04-22__20-19-00(1)__PBE.JPG     PBE</span></span>
<span><span class="co">## 3 StationA__2009-04-22__20-21-00(1)__PBE.JPG     PBE</span></span>
<span><span class="co">## 4 StationA__2009-04-23__00-07-00(1)__PBE.JPG     PBE</span></span>
<span><span class="co">## 5 StationA__2009-04-23__00-09-00(1)__PBE.JPG     PBE</span></span>
<span><span class="co">## 6 StationA__2009-05-07__17-11-00(1)__PBE.JPG     PBE</span></span>
<span><span class="co">##                            filename_new renamed</span></span>
<span><span class="co">## 1 StationA__2009-04-21__00-40-00(1).JPG    TRUE</span></span>
<span><span class="co">## 2 StationA__2009-04-22__20-19-00(1).JPG    TRUE</span></span>
<span><span class="co">## 3 StationA__2009-04-22__20-21-00(1).JPG    TRUE</span></span>
<span><span class="co">## 4 StationA__2009-04-23__00-07-00(1).JPG    TRUE</span></span>
<span><span class="co">## 5 StationA__2009-04-23__00-09-00(1).JPG    TRUE</span></span>
<span><span class="co">## 6 StationA__2009-05-07__17-11-00(1).JPG    TRUE</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="collecting-all-images-of-a-species">Collecting all images of a species<a class="anchor" aria-label="anchor" href="#collecting-all-images-of-a-species"></a>
</h3>
<p>The function <code>getSpeciesImages</code> collects all images of a
focal species from all stations and saves them in another directory,
creating an image report. This should be done after all images were
identified. The function serves 2 purposes:</p>
<ol style="list-style-type: decimal">
<li>it can be used to check species identification by creating a species
image report (which can then be sent for expert identification and
confirmation), and</li>
<li>it is a prerequisite for individual identification.</li>
</ol>
<p>The images that are to be copied can be specified an a record table
(as returned by function <code>recordTable</code>) or, alternatively,
the function can scan for all images of your target species that were
identified using either the drag and drop method or metadata tagging for
species identification. Please see the function help file for more
detail.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># again, we use a temporary directory for demonstration. Change this in your own code!</span></span>
<span><span class="va">wd_images_species_copy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, <span class="st">"sampleSpeciesImages"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">species_to_copy</span> <span class="op">&lt;-</span> <span class="st">"VTA"</span>    <span class="co"># = Viverra tangalunga, Malay Civet</span></span>
<span></span>
<span><span class="va">specImagecopy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpeciesImages.html">getSpeciesImages</a></span><span class="op">(</span>species                 <span class="op">=</span> <span class="va">species_to_copy</span>,</span>
<span>                                  IDfrom                  <span class="op">=</span> <span class="st">"directory"</span>,</span>
<span>                                  inDir                   <span class="op">=</span> <span class="va">wd_images_ID</span>,</span>
<span>                                  outDir                  <span class="op">=</span> <span class="va">wd_images_species_copy</span>,</span>
<span>                                  createStationSubfolders <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## VTA  - copied 5 out of 5 images in C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir   to   C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sampleSpeciesImages/VTA</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">specImagecopy</span></span></code></pre></div>
<pre><code><span><span class="co">##   species</span></span>
<span><span class="co">## 1     VTA</span></span>
<span><span class="co">## 2     VTA</span></span>
<span><span class="co">## 3     VTA</span></span>
<span><span class="co">## 4     VTA</span></span>
<span><span class="co">## 5     VTA</span></span>
<span><span class="co">##                                                                                                 DirectoryOrig</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationA/VTA</span></span>
<span><span class="co">## 2 C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationA/VTA</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationB/VTA</span></span>
<span><span class="co">## 4 C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationB/VTA</span></span>
<span><span class="co">## 5 C:/Users/niedballa/AppData/Local/R/win-library/4.2/camtrapR/pictures/sample_images_species_dir/StationC/VTA</span></span>
<span><span class="co">##                            FilenameOrig</span></span>
<span><span class="co">## 1 StationA__2009-04-10__05-07-00(1).JPG</span></span>
<span><span class="co">## 2 StationA__2009-05-06__19-06-00(1).JPG</span></span>
<span><span class="co">## 3 StationB__2009-04-15__19-12-00(1).JPG</span></span>
<span><span class="co">## 4 StationB__2009-04-27__05-07-00(1).JPG</span></span>
<span><span class="co">## 5 StationC__2009-04-24__02-57-00(1).JPG</span></span>
<span><span class="co">##                                                              DirectoryCopy</span></span>
<span><span class="co">## 1 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sampleSpeciesImages/VTA</span></span>
<span><span class="co">## 2 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sampleSpeciesImages/VTA</span></span>
<span><span class="co">## 3 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sampleSpeciesImages/VTA</span></span>
<span><span class="co">## 4 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sampleSpeciesImages/VTA</span></span>
<span><span class="co">## 5 C:/Users/niedballa/AppData/Local/Temp/RtmpYVox3y/sampleSpeciesImages/VTA</span></span>
<span><span class="co">##                            FilenameCopy copy_ok</span></span>
<span><span class="co">## 1 StationA__2009-04-10__05-07-00(1).JPG    TRUE</span></span>
<span><span class="co">## 2 StationA__2009-05-06__19-06-00(1).JPG    TRUE</span></span>
<span><span class="co">## 3 StationB__2009-04-15__19-12-00(1).JPG    TRUE</span></span>
<span><span class="co">## 4 StationB__2009-04-27__05-07-00(1).JPG    TRUE</span></span>
<span><span class="co">## 5 StationC__2009-04-24__02-57-00(1).JPG    TRUE</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="individual-identification">Individual identification<a class="anchor" aria-label="anchor" href="#individual-identification"></a>
</h2>
<p>Before individual identification, images need to be identified to
species level using one of the methods described above. All images of
the focal species are then collected using <code>getSpeciesImages</code>
(you could also do it manually, but it is laborious and cumbersome).
Users can choose if they need station directories or not. Note that it
is not possible (but also not needed) to have camera subdirectories in
station directories. Thus, directory structure is one of these:</p>
<blockquote>
<p>speciesImages/SpeciesA/…</p>
</blockquote>
<p>or</p>
<blockquote>
<p>speciesImages/SpeciesA/Station1/…</p>
</blockquote>
<p>where … stands for the renamed JPG images.</p>
<p>As with species identification, individuals can be identified by drag
and drop or by metadata tagging. We recommend identifying individuals
using metadata tags in image management software because is more
convenient.</p>
<div class="section level3">
<h3 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h3>
<p>Identifying individuals from images is similar to species
identification, but there are important differences: In order to use the
function <code>recordTableIndividual</code> which extracts the
information from tagged images, images must have been copied into a
species directory (e.g. with <code>getSpeciesImages</code>). It is
further recommended to use <code>imageRename</code> for renaming images
earlier in the workflow (if images were not renamed, make sure you
create station directories when collecting the species images with
<code>getSpeciesImages</code>.</p>
<p>This will ensure that the function can find all the relevant
information:</p>
<ul>
<li>species names are read from the directory name</li>
<li>station ID: read either from the directory name or file name
(depending on argument <code>hasStationFolders</code>)</li>
<li>camera ID: read from filename (depending on argument
<code>cameraID</code>). This is optional.</li>
<li>individual ID: read from metadata tags or individual directory names
(depending on argument <code>IDfrom</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="individual-identification-by-drag-drop">Individual identification by drag &amp; drop<a class="anchor" aria-label="anchor" href="#individual-identification-by-drag-drop"></a>
</h3>
<p>Individuals can be identified by moving images into individual
directories, either within station directories or not. If no station
directories are used, the images must have been renames with
<code>imageRename</code> because otherwise there will be no way of
deriving the station ID.</p>
</div>
<div class="section level3">
<h3 id="individual-identification-by-metadata-tagging">Individual identification by metadata tagging<a class="anchor" aria-label="anchor" href="#individual-identification-by-metadata-tagging"></a>
</h3>
<p>Metadata tagging of individual IDs is analogous to species assignment
with metadata.</p>
<div class="section level4">
<h4 id="double-observer-identification-of-individuals">Double observer identification of individuals<a class="anchor" aria-label="anchor" href="#double-observer-identification-of-individuals"></a>
</h4>
<p>Despite its name, the function
<code>checkSpeciesIdentification</code>can also be used to compare
individual IDs assigned via metadata by multiple observers (with some
limitations still). The idea is the same as with comparing
double-observer species identifcation. In other words, the function
treats individual IDs as if they were species IDs. Images of a species
need to be stored in a species directory containing only images of that
species (see function <code>getSpeciesImages</code>), preferably in
station subdirectories. If images were not stored in station
directories, the function will not be able to tell you which station the
images were taken at (but you still have unique file names), do be
careful when interpreting the first part of the output (the check for
temporal independence).</p>
<p>For lack of an example dataset in the package, here’s two theoretical
code examples which assumes tagged images of only one species in this
directory “C:/Users/Peter/individualID/SpeciesA”“, either with or
without station subdirectories</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all images in one directory, no station subdirectories</span></span>
<span><span class="co"># column "station" in outtable will be uninformative</span></span>
<span><span class="va">ID_check1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesIdentification.html">checkSpeciesIdentification</a></span><span class="op">(</span>inDir    <span class="op">=</span> <span class="st">"C:/Users/Peter/individualID"</span>,</span>
<span>                                        stationsToCheck   <span class="op">=</span> <span class="st">"SpeciesA"</span>,         <span class="co"># no station subdirectories</span></span>
<span>                                        IDfrom            <span class="op">=</span> <span class="st">"metadata"</span>,</span>
<span>                                        hasCameraFolders  <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                        metadataSpeciesTag          <span class="op">=</span> <span class="st">"Example_Species_ID_Paul"</span>,</span>
<span>                                        metadataSpeciesTagToCompare <span class="op">=</span> <span class="st">"Example_Species_ID_Peter"</span>,</span>
<span>                                        maxDeltaTime        <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check results with either of the following two:</span></span>
<span><span class="co"># ID_check1[[2]]   </span></span>
<span><span class="co"># ID_check1$IDconflictCheck   </span></span>
<span></span>
<span><span class="co"># all images in station subdirectories</span></span>
<span><span class="va">ID_check2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkSpeciesIdentification.html">checkSpeciesIdentification</a></span><span class="op">(</span>inDir    <span class="op">=</span> <span class="st">"C:/Users/Peter/individualID/SpeciesA"</span>,  <span class="co"># with station subdirectories</span></span>
<span>                                        IDfrom   <span class="op">=</span> <span class="st">"metadata"</span>,</span>
<span>                                        hasCameraFolders    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                        metadataSpeciesTag  <span class="op">=</span> <span class="st">"Example_Species_ID_Paul"</span>,</span>
<span>                                        metadataSpeciesTagToCompare <span class="op">=</span> <span class="st">"Example_Species_ID_Peter"</span>,</span>
<span>                                        maxDeltaTime        <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Juergen Niedballa, Alexandre Courtiol, Rahel Sollmann.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
