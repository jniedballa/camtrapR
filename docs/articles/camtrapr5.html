<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5. Multi-species occupancy models • camtrapR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="5. Multi-species occupancy models">
<meta property="og:description" content="camtrapR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">camtrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/camtrapr1.html">1. Organising raw camera trap images in camtrapR</a>
    </li>
    <li>
      <a href="../articles/camtrapr2.html">2. Species and Individual Identification</a>
    </li>
    <li>
      <a href="../articles/camtrapr3.html">3. Data Extraction from Images and videos, creating occupancy &amp; secr input</a>
    </li>
    <li>
      <a href="../articles/camtrapr4.html">4. Data exploration and visualisation</a>
    </li>
    <li>
      <a href="../articles/camtrapr5.html">5. Multi-species occupancy models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jniedballa/camtrapR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="camtrapr5_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="camtrapr5_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="camtrapr5_files/datatables-binding-0.30/datatables.js"></script><link href="camtrapr5_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="camtrapr5_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="camtrapr5_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="camtrapr5_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="camtrapr5_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>5. Multi-species occupancy models</h1>
                        <h4 data-toc-skip class="author">Juergen
Niedballa (<a href="mailto:camtrapr@gmail.com" class="email">camtrapr@gmail.com</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-02-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jniedballa/camtrapR/blob/HEAD/vignettes/camtrapr5.Rmd" class="external-link"><code>vignettes/camtrapr5.Rmd</code></a></small>
      <div class="hidden name"><code>camtrapr5.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jniedballa/camtrapR" class="external-link">camtrapR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE</span></span></code></pre>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Multi-species occupancy models are a powerful tool for combining
information from multiple species to estimate both individual and
community-level responses to environmental variables. These models are
typically fit using Bayesian frameworks such as BUGS, JAGS, or Nimble.
However, preparing the necessary input from camera trapping data,
writing the model code, setting parameters to monitor, and providing
initial values can be a daunting and time-consuming task, even for
experienced users.</p>
<p>To simplify this process, a new extension of camtrapR automatically
generates custom community occupancy models for analysis in JAGS or
Nimble. This flexible workflow supports:</p>
<ul>
<li>standard and Royle-Nichols occupancy models</li>
<li>continuous and categorical site covariates on detection and
occupancy probability</li>
<li>continuous and categorical observation-level covariates on detection
probability</li>
<li>fixed and random effects of all these covariates</li>
<li>independent effects of continuous site covariates between the
different species</li>
<li>nested random effects</li>
<li>fixed, independent or random intercepts of detection and occupancy
probability</li>
<li>data augmentation (fully open community or known maximum species
richness)</li>
<li>species richness estimates</li>
<li>models in JAGS and Nimble</li>
<li>derived quantities, e.g. Bayesian p-values (overall and by species)
and species richness estimates</li>
</ul>
<p>The main function is <code><a href="../reference/communityModel.html">communityModel()</a></code>. It automates:</p>
<ul>
<li>writing model code</li>
<li>setting parameters to monitor</li>
<li>setting initial values</li>
<li>bundling input data</li>
</ul>
<p>The output is a <code>commOccu</code> object. The workflow provides
methods for:</p>
<ul>
<li>fitting models</li>
<li>plotting marginal effects (response curves)</li>
<li>plotting effect sizes</li>
<li>spatial predictions of species occupancy probabilities</li>
<li>spatial predictions of species richness</li>
</ul>
<p>The output of fit() is an mcmc.list from the coda package and can be
uses as such, so the summary(), plot(), etc. methods are available as
well as the functions from bayesplot.</p>
<p>Unlike packages such as unmarked or ubms, the
<code>communityModel</code> function does not currently support R
formula syntax. Instead, covariates and their effect types are specified
through dedicated function arguments. While this non-standard approach
may change in the future to support formula syntax, it may be less
confusing than the lme4 syntax for random effects.</p>
</div>
<div class="section level2">
<h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a>
</h2>
<p>A word of caution, please always check the model code and make sure
you understand the code and agree with it. While the workflow is
designed for convenience and does not require you to examine the model
code, it is highly recommended that you do so. The model code contains
many comments to facilitate understanding. This workflow still requires
a proper understanding of Bayesian modelling frameworks and the concepts
behind multi-species occupancy models.</p>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<p>Please note that the workflow is still experimental and it is
important to carefully review and critically evaluate the results. If
you encounter any issues, do not hesitate to report them.</p>
<p>Currently, there are some limitations to the workflow:</p>
<ul>
<li>priors can not be customized</li>
<li>models with categorical observation-level covariates cannot be
compiled in Nimble and must be fit in JAGS instead</li>
<li>nested random effects and random effects of site covariates are
still experimental, and the plot_* methods don’t work on these yet</li>
<li>likewise, the output of <code>predict</code> may not be correct for
these</li>
<li>input checks are a bit limited and may not always lead to meaningful
error messages. This will improve over time with user feedback.</li>
<li>Nimble does not yet seem to have an advantage in processing speed.
That might require further customization</li>
<li>independent effects are only supported in continuous site
covariates</li>
</ul>
<p>Over time these will likely be worked on.</p>
</div>
<div class="section level2">
<h2 id="parameter-naming-convention">Parameter naming convention<a class="anchor" aria-label="anchor" href="#parameter-naming-convention"></a>
</h2>
<p>The parameter names are assembled from standardized building blocks.
The nomenclature is as follows:</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="17%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Refers to</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="left">Submodel</td>
<td align="left">detection submodel</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="left">Submodel</td>
<td align="left">occupancy submodel</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">Intercept</td>
<td align="left">denotes the intercepts (alpha0, beta0)</td>
</tr>
<tr class="even">
<td align="left">fixed</td>
<td align="left">Effect type</td>
<td align="left">fixed effects (constant across species)</td>
</tr>
<tr class="odd">
<td align="left">indep</td>
<td align="left">Effect type</td>
<td align="left">independent effects (separate and independent between
species)</td>
</tr>
<tr class="even">
<td align="left">ranef</td>
<td align="left">Effect type</td>
<td align="left">random effects (of species and/or other categorical
covariates)</td>
</tr>
<tr class="odd">
<td align="left">cont</td>
<td align="left">Covariate type</td>
<td align="left">continuous covariates</td>
</tr>
<tr class="even">
<td align="left">categ</td>
<td align="left">Covariate type</td>
<td align="left">categorical covariates</td>
</tr>
<tr class="odd">
<td align="left">mean</td>
<td align="left">Hyperparameter</td>
<td align="left">mean of random effect</td>
</tr>
<tr class="even">
<td align="left">sigma</td>
<td align="left">Hyperparameter</td>
<td align="left">standard deviation of random effect</td>
</tr>
<tr class="odd">
<td align="left">tau</td>
<td align="left">Hyperparameter</td>
<td align="left">precision of random effect (used internally, not
returned)</td>
</tr>
</tbody>
</table>
<p>For example, a fixed intercept of occupancy (constant across species)
is <em>beta0</em>, and a fixed intercept of detection probability is
<em>alpha0</em>.</p>
<p>An occupancy probability intercept with a random effect of species
is:</p>
<p><strong>beta0.mean</strong> community mean of the occupancy
probability intercept</p>
<p><strong>beta0.sigma</strong> standard deviation of the community
occupancy probability intercept.</p>
<p><strong>beta0[1]</strong> occupancy probability intercept of species
1 (likewise for other species).</p>
<p>For effects of site covariates, the pattern is:</p>
<p><em>submodel.effectType.covariateType.CovariateName.hyperparameter</em></p>
<p>For example:</p>
<p><strong>beta.ranef.cont.habitat.mean</strong> is the mean community
effect of the continuous site covariate ‘habitat’ on occupancy
probability.</p>
<p><strong>beta.ranef.cont.habitat[1]</strong> is the effect of
continuous site covariate ‘habitat’ on occupancy probability of species
1.</p>
<p>Site-occasion covariates are denoted by <em>.obs</em> after the
submodel, e.g.:</p>
<p><strong>alpha.obs.fixed.cont.effort</strong> is the fixed effect of
the continuous observation-level covariate ‘effort’ on detection
probability</p>
</div>
<div class="section level2">
<h2 id="quick-example">Quick example<a class="anchor" aria-label="anchor" href="#quick-example"></a>
</h2>
<p>Below is a brief example using the sample data included in camtrapR.
This data set contains only five species at three fictional camera trap
stations and uses made-up covariates. As a result, the parameter
estimates will not have any ecological significance. This example serves
only as a technical demonstration of how community models fit into the
camtrapR workflow.</p>
<div class="section level3">
<h3 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>First load the camera trap table and create a camera operation
matrix:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"camtraps"</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">camop_no_problem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cameraOperation.html">cameraOperation</a></span><span class="op">(</span>CTtable      <span class="op">=</span> <span class="va">camtraps</span>,</span>
<span>                                     stationCol   <span class="op">=</span> <span class="st">"Station"</span>,</span>
<span>                                     setupCol     <span class="op">=</span> <span class="st">"Setup_date"</span>,</span>
<span>                                     retrievalCol <span class="op">=</span> <span class="st">"Retrieval_date"</span>,</span>
<span>                                     hasProblems  <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                     dateFormat   <span class="op">=</span> <span class="st">"dmy"</span></span>
<span> <span class="op">)</span></span></code></pre></div>
<p>First, we load the record table and create a list of detection
histories. While all species are included in this example, you may
choose to subset the record table beforehand. It is important to note
the includeEffort = TRUE argument, which means that the output for each
species will be a list containing both the detection history and effort
matrix.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"recordTableSample"</span><span class="op">)</span></span>
<span></span>
<span> <span class="co"># list of detection histories</span></span>
<span> <span class="va">DetHist_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">recordTableSample</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="fu"><a href="../reference/detectionHistory.html">detectionHistory</a></span><span class="op">(</span></span>
<span>     recordTable         <span class="op">=</span> <span class="va">recordTableSample</span>,</span>
<span>     camOp                <span class="op">=</span> <span class="va">camop_no_problem</span>,</span>
<span>     stationCol           <span class="op">=</span> <span class="st">"Station"</span>,</span>
<span>     speciesCol           <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>     recordDateTimeCol    <span class="op">=</span> <span class="st">"DateTimeOriginal"</span>,</span>
<span>     species              <span class="op">=</span> <span class="va">x</span>,     <span class="co"># this gets modifies by lapply</span></span>
<span>     occasionLength       <span class="op">=</span> <span class="fl">7</span>,</span>
<span>     day1                 <span class="op">=</span> <span class="st">"station"</span>,</span>
<span>     datesAsOccasionNames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     includeEffort        <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     scaleEffort          <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     timeZone             <span class="op">=</span> <span class="st">"Asia/Kuala_Lumpur"</span></span>
<span>   <span class="op">)</span><span class="op">}</span></span>
<span> <span class="op">)</span></span>
<span></span>
<span> <span class="co"># assign species names to the list items</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">DetHist_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">recordTableSample</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span> <span class="co"># note, DetHist_list is a list containing a list for each species</span></span></code></pre></div>
<p>Get the detection history of each species and put into a new list
(thereby removing the effort matrix).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">ylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">DetHist_list</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">detection_history</span><span class="op">)</span></span></code></pre></div>
<p>Create some made-up covariates (only for demonstration):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">sitecovs</span> <span class="op">&lt;-</span> <span class="va">camtraps</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span> <span class="va">sitecovs</span><span class="op">$</span><span class="va">elevation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">500</span>, <span class="fl">600</span><span class="op">)</span></span>
<span> <span class="va">sitecovs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">sitecovs</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>   <span class="co"># scale numeric covariates</span></span>
<span> <span class="va">sitecovs</span><span class="op">$</span><span class="va">fact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>    <span class="co"># categorical covariate</span></span></code></pre></div>
<p>Now we bundle the necessary data for <code>communityModel</code> in a
list with 3 items:</p>
<ul>
<li>ylist: the list of detection histories</li>
<li>siteCovs: data frame with site covariates</li>
<li>obsCovs: (named) list with observation level covariates. Requires at
least the effort matrix.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylist    <span class="op">=</span> <span class="va">ylist</span>,</span>
<span>                   siteCovs <span class="op">=</span> <span class="va">sitecovs</span>,</span>
<span>                   obsCovs  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>effort <span class="op">=</span> <span class="va">DetHist_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span><span class="op">)</span>  <span class="co"># is identical for all species</span></span></code></pre></div>
<p>Now <code>data_list</code> is a list containing the detection
histories, site covariates and occasion level covariates.</p>
<p>Please note that it is always necessary to provide an effort matrix.
This ensures that the detection probability is set to 0 when there was
no effort. This is achieved by creating a binary effort matrix based on
the user-provided effort matrix. In the binary effort matrix, all cells
with effort = NA are set to 0, while all cells with values are set to 1,
regardless of the value of effort (as long as it is not NA). As a
result, all occasions with effort = NA in the provided effort matrix
will have a detection probability of 0.</p>
<p>This does <strong>not</strong> automatically include effort as a
covariate on detection probability. To include effort as a covariate on
detection probability, include “effort” in argument
<code>detCovsObservation</code> (you can specify a fixed or random
effect of effort on detection probability).</p>
</div>
<div class="section level3">
<h3 id="fit-model-in-jags">Fit model in JAGS<a class="anchor" aria-label="anchor" href="#fit-model-in-jags"></a>
</h3>
<p>Now the interesting part. The function communityModel() creates a new
class, “commOccu”. It is an object that contains all relevant
information for running a community occupancy model. Here we will create
a JAGS model (the default). For a model in Nimble, see further
below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># text file to save the model</span></span>
<span> <span class="va">modelfile1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">mod.jags</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span><span class="va">data_list</span>,</span>
<span>                            occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="st">"utm_y"</span>, ranef <span class="op">=</span> <span class="st">"elevation"</span><span class="op">)</span>,</span>
<span>                            detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="st">"effort"</span><span class="op">)</span>,</span>
<span>                            intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>                            modelFile <span class="op">=</span> <span class="va">modelfile1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c5441323f.txt</span></span></code></pre>
<p>This call defined a model with a fixed effect of utm_y on occupancy
probability of all species, and a species-specific (random) effect of
elevation on occupancy probability. Furthermore, we specified effort as
a covariate on detection probability (constant across species), and
there are random effects of species on the intercepts of detection and
occupancy probabilities.</p>
<p>Note that throughout this vignette we use a temporary file to save
the model text. In real examples you’d probably want to use a persistent
file.</p>
<p>One can also see the model code using (not shown here for
brevity):</p>
<p>There is a very basic summary method for commOccu objects:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod.jags</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## commOccu object for community occupancy model (in JAGS)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 5 species,  3 stations,  7 occasions</span></span>
<span><span class="co">## 21 occasions with effort</span></span>
<span><span class="co">## Number of detections (by species): 2 - 11 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Available site covariates:</span></span>
<span><span class="co">##  Station, utm_y, utm_x, elevation, fact </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Used site covariates:</span></span>
<span><span class="co">##  utm_y, elevation </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Available site-occasion covariates:</span></span>
<span><span class="co">##  effort</span></span></code></pre>
<p>The model is fit with <code>fit()</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">fit.jags</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">mod.jags</span>,</span>
<span>                 n.iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                 n.burnin <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                 chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The output of the <code>fit()</code> method is an
<code>mcmc.list</code> from the coda package.</p>
<p>Summarize posterior estimates:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.jags</span><span class="op">)</span></span></code></pre></div>
<p>Statistics of parameter estimates:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note, colors may not render correctly in dark themes in RStudio.</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ddc7835347b6c5464a20" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ddc7835347b6c5464a20">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","alpha.obs.fixed.cont.effort","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0.mean","alpha0.sigma","beta.fixed.cont.utm_y","beta.ranef.cont.elevation[1]","beta.ranef.cont.elevation[2]","beta.ranef.cont.elevation[3]","beta.ranef.cont.elevation[4]","beta.ranef.cont.elevation[5]","beta.ranef.cont.elevation.mean","beta.ranef.cont.elevation.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0.mean","beta0.sigma"],[5,2.183,3.027,4.697,0.776,-4.99,-6.131,-6.387,-4.364,-4.363,-5.11,1.374,2.193,0.95,2.786,7.815,9.728,4.921,2.197,7.352,13.743,16.255,3.516,-5.391,-3.126,1.598,12.533],[0,0.389,0.164,0.46,0.331,2.291,2.332,2.453,2.329,2.303,2.29,0.891,3.569,10.172,12.93,20.246,23.108,7.69,3.745,19.723,16.839,23.134,7.317,10.974,4.348,2.954,17.784],[0,0.004,0.002,0.005,0.004,0.026,0.027,0.028,0.027,0.027,0.026,0.01,0.041,0.117,0.149,0.234,0.267,0.089,0.043,0.228,0.194,0.267,0.08400000000000001,0.127,0.05,0.034,0.205],[0,0.017,0.003,0.022,0.049,0.328,0.314,0.344,0.313,0.337,0.342,0.023,0.266,1.606,2.504,6.857,7.738,0.896,0.407,4.891,2.732,5.044,0.653,2.49,0.322,0.063,3.83]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Quantiles of parameter estimates:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_summary</span><span class="op">$</span><span class="va">quantiles</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0e4f6ac820bdb7566c04" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0e4f6ac820bdb7566c04">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","alpha.obs.fixed.cont.effort","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0.mean","alpha0.sigma","beta.fixed.cont.utm_y","beta.ranef.cont.elevation[1]","beta.ranef.cont.elevation[2]","beta.ranef.cont.elevation[3]","beta.ranef.cont.elevation[4]","beta.ranef.cont.elevation[5]","beta.ranef.cont.elevation.mean","beta.ranef.cont.elevation.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0.mean","beta0.sigma"],[5,2,3,4,0.262,-10.772,-11.886,-12.319,-10.266,-10.155,-10.758,0.346,-4.801,-31.43,-21.865,-5.298,-3.415,-3.8,-4.549,0.255,0.333,0.272,-5.216,-45.149,-15.015,-4.553,0.54],[5,2,3,4,0.5580000000000001,-6.075,-7.269,-7.63,-5.529,-5.504,-6.275,0.787,-0.134,-1.402,-0.997,-0.111,0.487,0.523,-0.278,0.641,3.403,3.474,-0.426,-4.842,-4.554,0.011,2.954],[5,2,3,5,0.717,-4.586,-5.748,-6.054,-4.021,-4.043,-4.774,1.174,2.194,1.413,1.694,2.696,3.259,3.299,2,1.35,7.694,7.841,1.514,-2.02,-2.034,1.442,6.302],[5,2,3,5,0.9340000000000001,-3.452,-4.574,-4.739,-2.797,-2.822,-3.583,1.711,4.516,4.508,4.856,6.519,6.655,6.699,4.56,3.694,16.314,16.757,5.411,-0.312,-0.318,3.214,13.51],[5,3,4,5,1.605,-1.465,-2.51,-2.432,-0.697,-0.6840000000000001,-1.418,3.615,9.250999999999999,17.209,42.934,89.035,94.608,28.308,10.344,70,68.286,96.041,23.184,1.919,1.941,7.915,65.218]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>2.5%<\/th>\n      <th>25%<\/th>\n      <th>50%<\/th>\n      <th>75%<\/th>\n      <th>97.5%<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Marginal effect plots (response curves) can be plotted with
<code><a href="../reference/plot_effects-commOccu-method.html">plot_effects()</a></code>. Argument <code>submodel</code> defines
whether the output is for the detection or occupancy part of the
model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">mod.jags</span>,</span>
<span>              <span class="va">fit.jags</span>,</span>
<span>              submodel <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $utm_y</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## $elevation</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-16-2.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">mod.jags</span>,</span>
<span>              <span class="va">fit.jags</span>,</span>
<span>              submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $effort</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-16-3.png" width="700"></p>
<p>Likewise, we can plot effect sizes for easier comparison between
species and for easily checking significance with
<code><a href="../reference/plot_coef-commOccu-method.html">plot_coef()</a></code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">mod.jags</span>,</span>
<span>           <span class="va">fit.jags</span>,</span>
<span>           submodel <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>           combine <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'combine' and 'ordered' can't both be TRUE. Setting 'ordered = FALSE'</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">mod.jags</span>,</span>
<span>           <span class="va">fit.jags</span>,</span>
<span>           submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $effort</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
<p>There are further arguments for the significance levels, sorting
species by parameter estimates, and for combining multiple plots.</p>
</div>
<div class="section level3">
<h3 id="models-in-nimble">Models in Nimble<a class="anchor" aria-label="anchor" href="#models-in-nimble"></a>
</h3>
<div class="section level4">
<h4 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h4>
<p>NIMBLE is a system for building and sharing analysis methods for
statistical models, especially for hierarchical models and
computationally-intensive methods. NIMBLE is built in R but compiles
your models and algorithms using C++ for speed.</p>
<p>(<a href="https://r-nimble.org/" class="external-link uri">https://r-nimble.org/</a>)</p>
<p>It allows you to run the same models as BUGS or JAGS, but can be much
faster in some situations.</p>
<p>Using Nimble for community occupancy models requires the packages
“nimble” and “nimbleEcology”:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-nimble.org" class="external-link">nimble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nimble-dev/nimbleEcology" class="external-link">nimbleEcology</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="compilation-and-rtools">Compilation and Rtools<a class="anchor" aria-label="anchor" href="#compilation-and-rtools"></a>
</h4>
<p>Using nimble only makes sense if one can compile the models (which
runs them as fast C++ code). Compiling Nimble code requires Rtools.</p>
<p>You can obtain Rtools from: <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a>.</p>
<p>It then needs to be put in PATH, see here for how to do it: <a href="https://cran.r-project.org/bin/windows/Rtools/#putting-rtools-on-the-path" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/#putting-rtools-on-the-path</a>.</p>
<p>Depending on the version and where you installed Rtools, you should
see something like “C:/rtools40/usr/bin” or “C:/RBuildTools/4.2”
somewhere in the output of the following line (for me it’s usually the
first or second entry).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"PATH"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fit-models-in-nimble">Fit models in Nimble<a class="anchor" aria-label="anchor" href="#fit-models-in-nimble"></a>
</h4>
<p>We can fit the same model in Nimble using the exact same functions as
for the JAGS model above. Only set <code>nimble = TRUE</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">modelfile2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">mod.nimble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span><span class="va">data_list</span>,</span>
<span>                              occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="st">"utm_x"</span>, ranef <span class="op">=</span> <span class="st">"utm_y"</span><span class="op">)</span>,</span>
<span>                              detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="st">"effort"</span><span class="op">)</span>,</span>
<span>                              intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>                              modelFile <span class="op">=</span> <span class="va">modelfile2</span>,</span>
<span>                              nimble <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>      <span class="co"># set nimble = TRUE</span></span></code></pre></div>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c7c552f72.txt</span></span></code></pre>
<p>It is possible to fit uncompiled models, but it is usually extremely
slow and should only be done for checking model structure and expected
outputs, using very few iterations.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">fit.nimble.uncomp</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">mod.nimble</span>,</span>
<span>                          n.iter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                          chains <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the notes and the error message above are harmless</span></span></code></pre></div>
<p>To fit a compiled model, set compile = TRUE:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">fit.nimble.comp</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">mod.nimble</span>,</span>
<span>                        n.iter <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>                        n.burnin <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                        chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                        compile <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output as an <code>mcmc.list</code>, just like for the JAGS model
above, and can be worked with just the same:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># parameter summary statistics (not shown)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.nimble.comp</span><span class="op">)</span></span></code></pre></div>
<p>Response curves (= marginal effect plots):</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">mod.nimble</span>,</span>
<span>              mcmc.list <span class="op">=</span> <span class="va">fit.nimble.comp</span>,</span>
<span>              submodel <span class="op">=</span> <span class="st">"state"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $utm_x</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## $utm_y</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-25-2.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">mod.nimble</span>,</span>
<span>              mcmc.list <span class="op">=</span> <span class="va">fit.nimble.comp</span>,</span>
<span>              submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $effort</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-25-3.png" width="700"></p>
<p>Effect size plots:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">mod.nimble</span>,</span>
<span>           <span class="va">fit.nimble.comp</span>,</span>
<span>           submodel <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>           combine <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'combine' and 'ordered' can't both be TRUE. Setting 'ordered = FALSE'</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">mod.nimble</span>,</span>
<span>           <span class="va">fit.nimble.comp</span>,</span>
<span>           submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $effort</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-26-2.png" width="700"></p>
<p>Traceplots (not shown)</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit.nimble.comp</span><span class="op">)</span></span></code></pre></div>
<p>The estimates and marginal effects are not very pretty, and the model
likely requires more iterations to achieve smooth estimates.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="more-complete-example">More complete example<a class="anchor" aria-label="anchor" href="#more-complete-example"></a>
</h2>
<p>The example above was very small and unrealistic. We can’t provide a
large camera trapping data set in camtrapR, but we can simulate one
using the <code>simComm</code> function from the <code>AHMbook</code>
package. Using a simulated data set also means we can compare model
estimates to the “true” parameters (which were used to create the
simulated data).</p>
<div class="section level3">
<h3 id="prepare-data">Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"></a>
</h3>
<p>First, install the AHMbook package if necessary:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"AHMbook"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sites.google.com/site/appliedhierarchicalmodeling/home" class="external-link">AHMbook</a></span><span class="op">)</span></span></code></pre></div>
<p>Simulate community with <code><a href="https://rdrr.io/pkg/AHMbook/man/simComm.html" class="external-link">simComm()</a></code>. Here we simulate a
community with 20 species, 30 camera trap stations and 5 occasions.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">com</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AHMbook/man/simComm.html" class="external-link">simComm</a></span><span class="op">(</span>nspecies <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                nsites <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                nreps <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                mean.psi <span class="op">=</span> <span class="fl">0.25</span>,     <span class="co"># community mean of psi over all species in community (probability scale)  (0.25 = -1.1 on logit scale)</span></span>
<span>                sig.lpsi <span class="op">=</span> <span class="fl">1</span>,        <span class="co"># SD around intercept of logit(psi)</span></span>
<span>                mean.p <span class="op">=</span> <span class="fl">0.25</span>,       <span class="co"># community mean of detection probability over all species (0.25 = -1.1 on logit scale)</span></span>
<span>                sig.lp <span class="op">=</span> <span class="fl">1</span>,          <span class="co"># SD around intercept of logit(p)</span></span>
<span>                mu.beta.lpsi <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># mean (community) effect of habitat on logit(psi)</span></span>
<span>                sig.beta.lpsi <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># SD around mean (community) effect of habitat on logit(psi)</span></span>
<span>                mu.beta.lp <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,   <span class="co"># mean (community) effect of wind on logit(p)</span></span>
<span>                sig.beta.lp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>     <span class="co"># SD around mean (community) effect of wind on logit(p)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-30-1.png" width="700"><img src="camtrapr5_files/figure-html/unnamed-chunk-30-2.png" width="700"></p>
<p>We need to wrangle the data a little to convert the data to input for
<code><a href="../reference/communityModel.html">communityModel()</a></code>. This is only needed here because the data
are generated by <code><a href="https://rdrr.io/pkg/AHMbook/man/simComm.html" class="external-link">AHMbook::simComm()</a></code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get continuous site covariate "habitat"</span></span>
<span><span class="va">habitat</span> <span class="op">&lt;-</span> <span class="va">com</span><span class="op">$</span><span class="va">habitat</span></span>
<span></span>
<span><span class="co"># create (fake) categorical covariate (3 levels)</span></span>
<span><span class="co"># setting "medium" as reference level</span></span>
<span><span class="va">categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">habitat</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.5</span>, <span class="st">"low"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">habitat</span> <span class="op">&lt;</span> <span class="fl">0.5</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"medium"</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get observation covariate</span></span>
<span><span class="va">wind</span> <span class="op">&lt;-</span> <span class="va">com</span><span class="op">$</span><span class="va">wind</span></span>
<span></span>
<span><span class="co"># list of detection histories</span></span>
<span><span class="va">ylist</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/array-coercion.html" class="external-link">array_branch</a></span><span class="op">(</span><span class="va">com</span><span class="op">$</span><span class="va">y.all</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove unobserved species  (we leave that to data augmentation)</span></span>
<span><span class="va">ylist</span> <span class="op">&lt;-</span> <span class="va">ylist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ylist</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># here, effort was constant at all stations and occasions. Effort is thus a matrix of all 1</span></span>
<span><span class="va">effort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ylist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, ncol <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ylist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bundle data</span></span>
<span><span class="va">input_AHM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylist <span class="op">=</span> <span class="va">ylist</span>, </span>
<span>                  siteCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>habitat <span class="op">=</span> <span class="va">habitat</span>,</span>
<span>                                        categ   <span class="op">=</span> <span class="va">categ</span><span class="op">)</span>,</span>
<span>                  obsCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>effort <span class="op">=</span> <span class="va">effort</span>,</span>
<span>                                 wind <span class="op">=</span> <span class="va">wind</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="jags-model">JAGS Model<a class="anchor" aria-label="anchor" href="#jags-model"></a>
</h3>
<p>Here’s a model in JAGS, with a species-specific effect of habitat on
occupancy and wind on detection, and species-specific intercepts.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Site covariates may not be scaled. Scaling is strongly recommended for numeric covariates.</span></span></code></pre>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c64bf507.txt</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_ahm_jags</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags</span>, </span>
<span>                    n.iter <span class="op">=</span> <span class="fl">10000</span>, </span>
<span>                    n.burnin <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                    thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                    chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Summary statistics of model parameters:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-40112afee3969824f418" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-40112afee3969824f418">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat[1]","beta.ranef.cont.habitat[2]","beta.ranef.cont.habitat[3]","beta.ranef.cont.habitat[4]","beta.ranef.cont.habitat[5]","beta.ranef.cont.habitat[6]","beta.ranef.cont.habitat[7]","beta.ranef.cont.habitat[8]","beta.ranef.cont.habitat[9]","beta.ranef.cont.habitat[10]","beta.ranef.cont.habitat[11]","beta.ranef.cont.habitat[12]","beta.ranef.cont.habitat[13]","beta.ranef.cont.habitat[14]","beta.ranef.cont.habitat[15]","beta.ranef.cont.habitat[16]","beta.ranef.cont.habitat[17]","beta.ranef.cont.habitat[18]","beta.ranef.cont.habitat[19]","beta.ranef.cont.habitat.mean","beta.ranef.cont.habitat.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,2.965,3.938,3.838,4.878,3.734,4.049,2.16,3.914,4.84,5.002,3.072,2.936,5.13,5.035,5.314,3.172,4.148,4.246,2.366,4.219,6.236,4.371,7.861,5.198,5.057,7.061,5.285,5.469,5.763,8.763999999999999,1.112,-0.002,-0.2,-0.211,0.294,-0.8100000000000001,-0.586,-0.916,-0.331,0.153,0.8080000000000001,0.359,-1.292,-0.95,-0.592,-0.052,-0.777,-0.5679999999999999,-0.419,-0.259,0.803,-1.537,-1.19,-0.82,-1.771,-1.652,-0.512,-1.273,0.697,-1.124,0.258,-1.804,-1.981,-0.635,-1.735,-1.022,-0.438,-1.453,-1.707,-1.941,-1.135,0.971,-0.482,0.024,0.737,1.991,-0.618,1.05,0.42,-0.625,0.39,-0.8179999999999999,2.128,1.038,-0.077,1.537,0.72,0.514,0.948,0.627,1.222,0.5679999999999999,1.115,-0.785,-1.432,-2.17,-0.788,-0.836,0.432,-1.156,-1.325,-1.024,-1.215,-1.218,-1.081,-1.883,-1.214,-1.641,-1.048,-2.012,-1.674,-1.89,-1.256,0.829],[0,0.872,0.882,0.902,0.898,0.849,0.9360000000000001,1.025,0.921,0.884,0.959,1.013,0.951,0.992,1.001,1.088,1.058,1.027,1.076,1.133,1.092,1.103,1.122,0.904,1.365,1.347,1.37,1.47,1.43,1.264,1.247,0.501,0.392,0.637,0.417,0.351,0.244,0.382,0.405,0.379,0.339,0.5639999999999999,0.528,0.665,0.482,0.536,0.351,0.658,0.507,0.6820000000000001,0.237,0.23,0.436,0.5590000000000001,0.922,0.483,0.457,0.248,0.514,0.371,0.454,0.328,0.544,0.609,0.6870000000000001,0.598,0.579,0.375,0.853,0.75,0.916,0.293,0.247,0.587,0.6820000000000001,0.752,1.047,0.641,0.555,0.633,0.472,0.603,0.519,1.026,0.748,0.579,0.9,0.704,0.531,0.903,0.732,0.95,0.363,0.386,0.51,0.5669999999999999,0.701,0.597,0.604,0.534,0.54,0.439,0.517,0.43,0.581,0.644,0.545,0.592,0.5620000000000001,0.433,0.716,0.65,0.78,0.272,0.259],[0,0.016,0.016,0.016,0.016,0.015,0.017,0.019,0.017,0.016,0.018,0.019,0.017,0.018,0.018,0.02,0.019,0.019,0.02,0.021,0.02,0.02,0.02,0.017,0.025,0.025,0.025,0.027,0.026,0.023,0.023,0.008999999999999999,0.007,0.012,0.008,0.006,0.004,0.007,0.007,0.007,0.006,0.01,0.01,0.012,0.008999999999999999,0.01,0.006,0.012,0.008999999999999999,0.012,0.004,0.004,0.008,0.01,0.017,0.008999999999999999,0.008,0.005,0.008999999999999999,0.007,0.008,0.006,0.01,0.011,0.013,0.011,0.011,0.007,0.016,0.014,0.017,0.005,0.005,0.011,0.012,0.014,0.019,0.012,0.01,0.012,0.008999999999999999,0.011,0.008999999999999999,0.019,0.014,0.011,0.016,0.013,0.01,0.016,0.013,0.017,0.007,0.007,0.008999999999999999,0.01,0.013,0.011,0.011,0.01,0.01,0.008,0.008999999999999999,0.008,0.011,0.012,0.01,0.011,0.01,0.008,0.013,0.012,0.014,0.005,0.005],[0,0.017,0.019,0.018,0.018,0.016,0.019,0.02,0.018,0.017,0.022,0.021,0.018,0.02,0.02,0.023,0.022,0.02,0.021,0.023,0.021,0.022,0.024,0.018,0.03,0.032,0.03,0.032,0.033,0.031,0.026,0.01,0.007,0.013,0.008,0.007,0.004,0.007,0.008,0.007,0.007,0.012,0.008999999999999999,0.014,0.008999999999999999,0.01,0.006,0.012,0.01,0.013,0.004,0.005,0.008,0.013,0.021,0.008999999999999999,0.008999999999999999,0.005,0.011,0.007,0.01,0.006,0.012,0.014,0.014,0.012,0.011,0.007,0.019,0.016,0.022,0.007,0.006,0.013,0.017,0.015,0.025,0.014,0.011,0.013,0.008999999999999999,0.012,0.011,0.026,0.016,0.011,0.021,0.013,0.01,0.02,0.014,0.022,0.008,0.012,0.011,0.012,0.017,0.013,0.014,0.012,0.012,0.008,0.011,0.008,0.011,0.017,0.011,0.013,0.011,0.008,0.017,0.014,0.02,0.007,0.007]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Since we used simulated data we can compare model estimates with the
truth. For example, the true effect of habitat on occupancy was mean =
0.5 (SD = 0.5). See <code>beta.ranef.cont.habitat.mean</code> and
<code>beta.ranef.cont.habitat.sigma</code> in the table above for
estimates.</p>
<p>The mean effect of wind on detection probability was -0.5 (SD = 1).
See <code>alpha.obs.ranef.cont.wind.mean</code> and
<code>alpha.obs.ranef.cont.wind.sigma</code> in the table above for
estimates.</p>
<p>Bayesian p-values can be inspected to check for lack of fit (overall
or by species). Lack of fit at significance level = 0.05 is indicated by
Bayesian p-values below 0.025 or greater than 0.975. In the example
above, the overall Bayesian p-value (Bpvalue) indicates no problems with
lack of fit. Likewise, species-level Bayesian p-values (Bpvalue_species)
indicate no lack of fit for any species. This is not surprising because
the model uses simulated data.</p>
<p>Plot response curves (marginal effects)</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_resp_jags_occu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_jags</span>, </span>
<span>                                    <span class="va">out_ahm_jags</span><span class="op">)</span></span>
<span><span class="va">plot_resp_jags_occu</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_resp_jags_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_jags</span>, </span>
<span>                                   <span class="va">out_ahm_jags</span>,</span>
<span>                                   submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span>
<span><span class="va">plot_resp_jags_det</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-35-2.png" width="700"></p>
<p>Plot coefficient estimates:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_eff_jags_occu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_jags</span>, </span>
<span>                                <span class="va">out_ahm_jags</span><span class="op">)</span></span>
<span><span class="va">plot_eff_jags_occu</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_eff_jags_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_jags</span>, </span>
<span>                               <span class="va">out_ahm_jags</span>,</span>
<span>                               submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span>
<span><span class="va">plot_eff_jags_det</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-36-2.png" width="700"></p>
<p>By default, species are sorted by effect size. Alternatively, you can
have them sorted by species names. Set <code>ordered = FALSE</code>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_eff_jags_occu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_jags</span>, </span>
<span>                                <span class="va">out_ahm_jags</span>,</span>
<span>                                ordered <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">plot_eff_jags_occu2</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="nimble-model">Nimble Model<a class="anchor" aria-label="anchor" href="#nimble-model"></a>
</h3>
<p>Here’s the same model in Nimble:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_nimble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_nimble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_nimble</span>,</span>
<span>  nimble <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Site covariates may not be scaled. Scaling is strongly recommended for numeric covariates.</span></span></code></pre>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c2d792031.txt</span></span></code></pre>
<p>We use some more iterations, since these Nimble models tend to
require more iterations than equivalent JAGS models to achieve good
estimates (numbers are still too low for publication quality
though).</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compiled model run</span></span>
<span><span class="va">out_ahm_nimble2</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_nimble</span>, </span>
<span>                       n.iter <span class="op">=</span><span class="fl">20000</span>,</span>
<span>                       n.burnin <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                       thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                       chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       compile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Defining model</span></span></code></pre>
<pre><code><span><span class="co">##   [Note] Using 'y' (given within 'constants') as data.</span></span></code></pre>
<pre><code><span><span class="co">## Building model</span></span></code></pre>
<pre><code><span><span class="co">## Setting data and initial values</span></span></code></pre>
<pre><code><span><span class="co">## Running calculate on model</span></span>
<span><span class="co">##   [Note] Any error reports that follow may simply reflect missing values in model variables.</span></span></code></pre>
<pre><code><span><span class="co">## Checking model sizes and dimensions</span></span></code></pre>
<pre><code><span><span class="co">##   [Note] This model is not fully initialized. This is not an error.</span></span>
<span><span class="co">##          To see which variables are not initialized, use model$initializeInfo().</span></span>
<span><span class="co">##          For more information on model initialization, see help(modelInitialization).</span></span></code></pre>
<pre><code><span><span class="co">## Compiling</span></span>
<span><span class="co">##   [Note] This may take a minute.</span></span>
<span><span class="co">##   [Note] Use 'showCompilerOutput = TRUE' to see C++ compilation details.</span></span>
<span><span class="co">## Compiling</span></span>
<span><span class="co">##   [Note] This may take a minute.</span></span>
<span><span class="co">##   [Note] Use 'showCompilerOutput = TRUE' to see C++ compilation details.</span></span></code></pre>
<pre><code><span><span class="co">## running chain 1...</span></span></code></pre>
<pre><code><span><span class="co">## running chain 2...</span></span></code></pre>
<pre><code><span><span class="co">## running chain 3...</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_nimble2</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plot responses (marginal effects):</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_resp_nimble_occu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_nimble</span>, </span>
<span>                                      <span class="va">out_ahm_nimble2</span><span class="op">)</span></span>
<span><span class="va">plot_resp_nimble_occu</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_resp_nimble_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_nimble</span>, </span>
<span>                                     <span class="va">out_ahm_nimble2</span>,</span>
<span>                                     submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span>
<span><span class="va">plot_resp_nimble_det</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-40-2.png" width="700"></p>
<p>Plot coefficient estimates:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_eff_nimble_occu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_nimble</span>, </span>
<span>                                  <span class="va">out_ahm_nimble2</span><span class="op">)</span></span>
<span><span class="va">plot_eff_nimble_occu</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_eff_nimble_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_nimble</span>, </span>
<span>                                 <span class="va">out_ahm_nimble2</span>,</span>
<span>                                 submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span>
<span><span class="va">plot_eff_nimble_det</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-41-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="missing-values-in-detection-histories">Missing values in detection histories<a class="anchor" aria-label="anchor" href="#missing-values-in-detection-histories"></a>
</h3>
<p>The examples so far did not have any missing data in the detection
histories. Real-world data commonly have missing data though, e.g. due
to camera malfunction or specific study designs. In single-species
occupancy models (e.g. in unmarked or ubms) this is handled
automatically, but requires a little more attention in these
multi-species models (at least when fitting with Nimble). Let’s modify
the above data set and introduce some NAs in the detection history and
the effort matrix:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># introduce a few missing values in detection history of all species</span></span>
<span><span class="va">index_na</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ylist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span> <span class="co">#</span></span>
<span><span class="va">ylist_with_na</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ylist</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">[</span><span class="va">index_na</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>; <span class="va">x</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># set the cells with NA in detection history to NA in effort too</span></span>
<span><span class="va">effort_with_na</span> <span class="op">&lt;-</span> <span class="va">effort</span></span>
<span><span class="va">effort_with_na</span><span class="op">[</span><span class="va">index_na</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># bundle model input</span></span>
<span><span class="va">input_AHM_with_NA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylist <span class="op">=</span> <span class="va">ylist_with_na</span>, </span>
<span>                          siteCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>habitat <span class="op">=</span> <span class="va">habitat</span>,</span>
<span>                                                categ   <span class="op">=</span> <span class="va">categ</span><span class="op">)</span>,</span>
<span>                          obsCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>effort <span class="op">=</span> <span class="va">effort_with_na</span>,</span>
<span>                                         wind <span class="op">=</span> <span class="va">wind</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And fit models in JAGS and Nimble:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_na</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_na</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM_with_NA</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_na</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Site covariates may not be scaled. Scaling is strongly recommended for numeric covariates.</span></span></code></pre>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c6a523ae0.txt</span></span></code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_ahm_jags_na</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_na</span>, </span>
<span>                    n.iter <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                    n.burnin <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                    thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                    chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Summary statistics of model parameters:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_na</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8e6e496df70af37884fb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e6e496df70af37884fb">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat[1]","beta.ranef.cont.habitat[2]","beta.ranef.cont.habitat[3]","beta.ranef.cont.habitat[4]","beta.ranef.cont.habitat[5]","beta.ranef.cont.habitat[6]","beta.ranef.cont.habitat[7]","beta.ranef.cont.habitat[8]","beta.ranef.cont.habitat[9]","beta.ranef.cont.habitat[10]","beta.ranef.cont.habitat[11]","beta.ranef.cont.habitat[12]","beta.ranef.cont.habitat[13]","beta.ranef.cont.habitat[14]","beta.ranef.cont.habitat[15]","beta.ranef.cont.habitat[16]","beta.ranef.cont.habitat[17]","beta.ranef.cont.habitat[18]","beta.ranef.cont.habitat[19]","beta.ranef.cont.habitat.mean","beta.ranef.cont.habitat.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,3.111,4.257,3.934,4.958,3.985,4.127,2.431,4.047,4.826,4.932,3.21,3.178,5.161,5.048,5.497,3.137,4.126,4.347,2.355,4.217,6.204,4.355,7.146,5.605,5.054,6.946,5.198,5.326,5.755,8.345000000000001,1.123,0.081,-0.215,-0.21,0.409,-0.84,-0.592,-0.9360000000000001,-0.287,0.092,0.802,0.469,-1.274,-0.965,-0.625,-0.02,-0.877,-0.547,-0.412,-0.247,0.828,-1.476,-1.444,-0.858,-1.707,-1.521,-0.541,-1.467,0.59,-1.173,0.275,-1.77,-2.064,-0.763,-1.619,-0.957,-0.545,-1.217,-1.631,-1.856,-1.143,0.944,-0.517,-0.046,0.677,1.985,-0.832,1.07,0.364,-0.658,0.365,-0.833,2.163,0.672,-0.099,1.542,0.726,0.491,0.999,0.664,1.245,0.523,1.15,-0.778,-1.289,-2.167,-0.8149999999999999,-1.128,0.477,-1.068,-1.304,-0.98,-1.222,-1.247,-1.238,-1.853,-1.229,-1.64,-1.014,-2.08,-1.717,-1.936,-1.285,0.843],[0,0.979,1.016,0.984,0.91,0.959,0.996,1.161,0.974,0.883,0.9330000000000001,1.075,1.071,1.015,1,1.157,1.054,1.019,1.106,1.13,1.079,1.057,1.162,1.055,1.454,1.404,1.328,1.429,1.402,1.293,1.41,0.504,0.413,0.624,0.411,0.374,0.25,0.392,0.408,0.399,0.359,0.587,0.5580000000000001,0.6830000000000001,0.481,0.549,0.352,0.698,0.508,0.6830000000000001,0.239,0.238,0.433,0.575,0.895,0.487,0.506,0.258,0.542,0.379,0.471,0.34,0.574,0.667,0.636,0.58,0.604,0.413,0.9340000000000001,0.741,0.9320000000000001,0.292,0.234,0.598,0.74,0.781,1.033,0.667,0.5649999999999999,0.734,0.481,0.619,0.515,0.994,0.802,0.593,0.892,0.732,0.53,0.946,0.743,0.894,0.351,0.376,0.54,0.624,0.718,0.577,0.604,0.5620000000000001,0.587,0.44,0.541,0.438,0.604,0.675,0.5600000000000001,0.585,0.587,0.437,0.739,0.654,0.763,0.288,0.274],[0,0.025,0.026,0.025,0.023,0.025,0.026,0.03,0.025,0.023,0.024,0.028,0.028,0.026,0.026,0.03,0.027,0.026,0.029,0.029,0.028,0.027,0.03,0.027,0.038,0.036,0.034,0.037,0.036,0.033,0.036,0.013,0.011,0.016,0.011,0.01,0.006,0.01,0.011,0.01,0.008999999999999999,0.015,0.014,0.018,0.012,0.014,0.008999999999999999,0.018,0.013,0.018,0.006,0.006,0.011,0.015,0.023,0.013,0.013,0.007,0.014,0.01,0.012,0.008999999999999999,0.015,0.017,0.016,0.015,0.016,0.011,0.024,0.019,0.024,0.008,0.006,0.015,0.019,0.02,0.027,0.017,0.015,0.019,0.012,0.016,0.013,0.026,0.021,0.015,0.023,0.019,0.014,0.024,0.019,0.023,0.008999999999999999,0.01,0.014,0.016,0.019,0.015,0.016,0.015,0.015,0.011,0.014,0.011,0.016,0.017,0.014,0.015,0.015,0.011,0.019,0.017,0.02,0.007,0.007],[0,0.03,0.03,0.031,0.023,0.028,0.03,0.033,0.028,0.024,0.026,0.031,0.029,0.026,0.028,0.035,0.032,0.027,0.031,0.033,0.033,0.031,0.035,0.031,0.039,0.045,0.044,0.045,0.045,0.045,0.047,0.014,0.011,0.017,0.01,0.01,0.007,0.011,0.01,0.01,0.008,0.018,0.015,0.02,0.013,0.015,0.008999999999999999,0.019,0.014,0.016,0.006,0.008,0.012,0.019,0.027,0.013,0.016,0.007,0.017,0.008999999999999999,0.014,0.008999999999999999,0.016,0.022,0.017,0.016,0.016,0.01,0.03,0.025,0.031,0.008999999999999999,0.008,0.016,0.024,0.022,0.034,0.021,0.018,0.023,0.012,0.016,0.014,0.031,0.024,0.017,0.027,0.021,0.014,0.025,0.02,0.026,0.011,0.014,0.016,0.02,0.024,0.015,0.019,0.018,0.02,0.011,0.017,0.012,0.02,0.024,0.017,0.018,0.017,0.012,0.025,0.019,0.025,0.008999999999999999,0.01]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>As can be seen, the JAGS model handles NAs well and parameter
estimates are very similar to the model without missing data above.</p>
<p>Nimble models can technically also be fit with NAs present, but there
will be numerous warnings and residuals as well as Bayesian p-values
cannot be computed.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_nimble_na</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_nimble_na</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM_with_NA</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_nimble_na</span>,</span>
<span>  nimble <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Site covariates may not be scaled. Scaling is strongly recommended for numeric covariates.</span></span></code></pre>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c395039c2.txt</span></span></code></pre>
<p>When fitting the model there will be numerous warnings about values
of data nodes y[,,] and determinisitc nodes res[,], R2[] and R3 being NA
(not shown here).</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_ahm_nimble_na</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_nimble_na</span>, </span>
<span>                    n.iter <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                    n.burnin <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                    thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                    chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Defining model</span></span></code></pre>
<pre><code><span><span class="co">##   [Note] Using 'y' (given within 'constants') as data.</span></span></code></pre>
<pre><code><span><span class="co">## Building model</span></span></code></pre>
<pre><code><span><span class="co">## Setting data and initial values</span></span></code></pre>
<pre><code><span><span class="co">## Running calculate on model</span></span>
<span><span class="co">##   [Note] Any error reports that follow may simply reflect missing values in model variables.</span></span></code></pre>
<pre><code><span><span class="co">## Checking model sizes and dimensions</span></span></code></pre>
<pre><code><span><span class="co">##   [Note] This model is not fully initialized. This is not an error.</span></span>
<span><span class="co">##          To see which variables are not initialized, use model$initializeInfo().</span></span>
<span><span class="co">##          For more information on model initialization, see help(modelInitialization).</span></span></code></pre>
<pre><code><span><span class="co">## Compiling</span></span>
<span><span class="co">##   [Note] This may take a minute.</span></span>
<span><span class="co">##   [Note] Use 'showCompilerOutput = TRUE' to see C++ compilation details.</span></span>
<span><span class="co">## Compiling</span></span>
<span><span class="co">##   [Note] This may take a minute.</span></span>
<span><span class="co">##   [Note] Use 'showCompilerOutput = TRUE' to see C++ compilation details.</span></span></code></pre>
<pre><code><span><span class="co">## running chain 1...</span></span></code></pre>
<pre><code><span><span class="co">## running chain 2...</span></span></code></pre>
<pre><code><span><span class="co">## running chain 3...</span></span></code></pre>
<p>Parameter summaries cannot be computed and will return an error (not
shown here).</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_nimble2</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To alleviate this, it is necessary (for Nimble models) to convert NAs
in the detection history to 0, e.g. with:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># replace NAs with 0 in the ylist component of input_AHM (for all species at once)</span></span>
<span><span class="va">input_AHM_with_NA</span><span class="op">$</span><span class="va">ylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">input_AHM_with_NA</span><span class="op">$</span><span class="va">ylist</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>After converting NAs to 0, Nimble models can be run without warnings
and summaries can be calculated.</p>
<p>To prevent the additional 0s from affecting the estimation of
detection probabilities, information about occasions without effort is
provided via the mandatory argument <code>effortCov</code> in the
<code>communityModel</code> function. Use the <code>$effort</code> part
of the output of <code><a href="../reference/detectionHistory.html">detectionHistory()</a></code> to provide the
necessary information, and of course ensure that
<code>detectionHistory</code> is run with
<code>includeEffort = T</code>. All occasions with NA in the effort
matrix will have their detection probabilities fixed at 0. This ensures
that those occasions do not affect the model fit. Be aware that this
does not include effort as a covariate on detection. Including effort as
a covariate on detection would need to be done via
<code>detCovsObservation</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-possibilies">Further possibilies<a class="anchor" aria-label="anchor" href="#further-possibilies"></a>
</h2>
<p>This section demonstrates additional possibilities. The models here
are (mostly) fit in JAGS, but can also be fit with Nimble.</p>
<div class="section level3">
<h3 id="fixed-effects">Fixed effects<a class="anchor" aria-label="anchor" href="#fixed-effects"></a>
</h3>
<p>One can define fixed effects of covariates if the responses are
thought to be constant across all species. This might make sense for the
effect of sampling effort in camera trapping studies.</p>
</div>
<div class="section level3">
<h3 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h3>
<p>It is not yet possible to customize priors. The current defaults
are:</p>
<ul>
<li>dnorm(0, 0.05) : random effect means</li>
<li>dgamma(0.1, 0.1): random effect precision (tau)</li>
</ul>
<p>Future versions may allow more flexibility. Please contact me if this
is relevant for you. In the meantime feel free to adjust the model code
in the txt file as needed.</p>
</div>
<div class="section level3">
<h3 id="data-augmentation">Data augmentation<a class="anchor" aria-label="anchor" href="#data-augmentation"></a>
</h3>
<p><code>communityModel</code> has an argument
<code>augmentation</code>, which can implement fully open data
augmentation or data augmentation up to a known maximum number of
species.</p>
<p>We know there are 20 species in the simulated community example. We
can inform the model that the community is known to consist of 20
species via: <code>augmentation = c(maxknown = 20)</code>:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_aug1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_aug1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list          <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  augmentation       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>maxknown <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  modelFile          <span class="op">=</span> <span class="va">modelFile_jags_aug1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_aug1</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_aug1</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here is another example with fully open data augmentation
(metacommunity size is unknown). The model will estimate the probability
for each species to be part of the metacommunity. Fully open data
augmentation is specified with <code>augmentation = c(full = 30)</code>
(for a maximum potential community size of 30 species in this
example).</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_aug2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_aug2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  augmentation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>full <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_aug2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_aug2</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_aug2</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>See parameters “omega” and “w[1]” to “w[30]” in the model output:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_aug2</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ced81b65d7361515ed82" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ced81b65d7361515ed82">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","Ntotal","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind[20]","alpha.obs.ranef.cont.wind[21]","alpha.obs.ranef.cont.wind[22]","alpha.obs.ranef.cont.wind[23]","alpha.obs.ranef.cont.wind[24]","alpha.obs.ranef.cont.wind[25]","alpha.obs.ranef.cont.wind[26]","alpha.obs.ranef.cont.wind[27]","alpha.obs.ranef.cont.wind[28]","alpha.obs.ranef.cont.wind[29]","alpha.obs.ranef.cont.wind[30]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0[20]","alpha0[21]","alpha0[22]","alpha0[23]","alpha0[24]","alpha0[25]","alpha0[26]","alpha0[27]","alpha0[28]","alpha0[29]","alpha0[30]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat[1]","beta.ranef.cont.habitat[2]","beta.ranef.cont.habitat[3]","beta.ranef.cont.habitat[4]","beta.ranef.cont.habitat[5]","beta.ranef.cont.habitat[6]","beta.ranef.cont.habitat[7]","beta.ranef.cont.habitat[8]","beta.ranef.cont.habitat[9]","beta.ranef.cont.habitat[10]","beta.ranef.cont.habitat[11]","beta.ranef.cont.habitat[12]","beta.ranef.cont.habitat[13]","beta.ranef.cont.habitat[14]","beta.ranef.cont.habitat[15]","beta.ranef.cont.habitat[16]","beta.ranef.cont.habitat[17]","beta.ranef.cont.habitat[18]","beta.ranef.cont.habitat[19]","beta.ranef.cont.habitat[20]","beta.ranef.cont.habitat[21]","beta.ranef.cont.habitat[22]","beta.ranef.cont.habitat[23]","beta.ranef.cont.habitat[24]","beta.ranef.cont.habitat[25]","beta.ranef.cont.habitat[26]","beta.ranef.cont.habitat[27]","beta.ranef.cont.habitat[28]","beta.ranef.cont.habitat[29]","beta.ranef.cont.habitat[30]","beta.ranef.cont.habitat.mean","beta.ranef.cont.habitat.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0[20]","beta0[21]","beta0[22]","beta0[23]","beta0[24]","beta0[25]","beta0[26]","beta0[27]","beta0[28]","beta0[29]","beta0[30]","beta0.mean","beta0.sigma","n0","omega","w[1]","w[2]","w[3]","w[4]","w[5]","w[6]","w[7]","w[8]","w[9]","w[10]","w[11]","w[12]","w[13]","w[14]","w[15]","w[16]","w[17]","w[18]","w[19]","w[20]","w[21]","w[22]","w[23]","w[24]","w[25]","w[26]","w[27]","w[28]","w[29]","w[30]"],[20.013,3.107,3.913,3.887,4.98,3.86,4.267,2.273,4.047,4.96,5.06,3.007,2.967,5.113,5.053,5.64,3.307,4.273,4.293,2.273,4.307,6.313,4.333,7.913,5.167,5.28,7.2,5.46,5.56,5.927,8.76,21.373,1.1,0.056,-0.138,-0.173,0.304,-0.791,-0.5639999999999999,-0.906,-0.314,0.172,0.799,0.378,-1.236,-0.911,-0.572,0.006,-0.776,-0.522,-0.336,-0.267,-0.219,-0.183,-0.224,-0.102,-0.022,-0.272,-0.123,-0.359,-0.274,-0.207,-0.228,0.798,-1.591,-1.223,-0.711,-1.858,-1.668,-0.5,-1.233,0.71,-1.136,0.247,-1.739,-1.993,-0.607,-1.741,-0.985,-0.402,-1.249,-1.623,-1.932,-1.326,-1.339,-1.26,-1.298,-1.265,-1.244,-1.191,-1.345,-1.228,-1.308,-1.236,-1.171,1.02,-0.458,-0.061,0.5679999999999999,1.961,-0.594,1.109,0.404,-0.604,0.362,-0.849,2.174,1.076,-0.155,1.573,0.749,0.543,0.926,0.664,1.225,0.659,0.457,0.599,0.598,0.621,0.589,0.75,0.678,0.728,0.524,0.599,0.585,1.12,-0.748,-1.473,-2.662,-0.703,-0.742,0.55,-1.177,-1.336,-1.005,-1.314,-1.356,-1.075,-2.049,-1.267,-1.68,-1.102,-2.394,-1.93,-2.191,-1.792,-1.917,-1.864,-1.944,-1.851,-1.924,-1.781,-1.968,-1.857,-2.025,-1.923,-1.565,1.111,2.373,0.6909999999999999,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.207,0.253,0.16,0.193,0.233,0.247,0.233,0.18,0.22,0.207,0.24],[1.164,0.891,0.867,0.959,0.871,0.9409999999999999,1.133,1.048,1.101,0.889,0.9360000000000001,1.007,0.87,0.966,1.067,1.194,1.176,1.067,1.144,1.129,1.049,1.063,1.047,0.948,1.49,1.291,1.414,1.436,1.407,1.443,1.283,2.446,0.478,0.374,0.556,0.482,0.369,0.238,0.387,0.434,0.364,0.326,0.617,0.493,0.657,0.498,0.48,0.354,0.736,0.545,0.651,0.822,0.776,0.8120000000000001,0.862,0.845,0.887,0.6830000000000001,0.92,0.905,0.822,0.848,0.219,0.248,0.405,0.543,0.786,0.516,0.452,0.25,0.485,0.357,0.461,0.294,0.544,0.604,0.67,0.624,0.594,0.39,0.833,0.731,0.992,1.113,1.204,1.121,1.086,1.145,1.154,1.121,1.198,1.133,1.206,1.137,0.32,0.24,0.598,0.696,0.712,1.072,0.679,0.616,0.599,0.411,0.608,0.589,0.994,0.767,0.643,0.889,0.771,0.52,0.849,0.712,0.853,1.032,1.151,1.147,1.074,1.221,1.041,1.186,1.153,1.116,1.308,1.014,0.361,0.383,0.517,0.654,0.823,0.651,0.636,0.548,0.612,0.45,0.533,0.477,0.66,0.708,0.625,0.657,0.6820000000000001,0.461,0.8110000000000001,0.826,0.928,1.341,1.212,1.223,1.535,1.379,1.415,1.468,1.569,1.375,1.5,1.268,0.449,0.452,2.446,0.11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.406,0.436,0.368,0.396,0.424,0.433,0.424,0.385,0.416,0.406,0.429],[0.095,0.073,0.07099999999999999,0.078,0.07099999999999999,0.077,0.093,0.08599999999999999,0.09,0.073,0.076,0.082,0.07099999999999999,0.079,0.08699999999999999,0.098,0.096,0.08699999999999999,0.093,0.092,0.08599999999999999,0.08699999999999999,0.08500000000000001,0.077,0.122,0.105,0.115,0.117,0.115,0.118,0.105,0.2,0.039,0.031,0.045,0.039,0.03,0.019,0.032,0.035,0.03,0.027,0.05,0.04,0.054,0.041,0.039,0.029,0.06,0.045,0.053,0.067,0.063,0.066,0.07000000000000001,0.06900000000000001,0.07199999999999999,0.056,0.075,0.074,0.067,0.06900000000000001,0.018,0.02,0.033,0.044,0.064,0.042,0.037,0.02,0.04,0.029,0.038,0.024,0.044,0.049,0.055,0.051,0.049,0.032,0.068,0.06,0.081,0.091,0.098,0.092,0.089,0.094,0.094,0.091,0.098,0.093,0.098,0.093,0.026,0.02,0.049,0.057,0.058,0.08699999999999999,0.055,0.05,0.049,0.034,0.05,0.048,0.081,0.063,0.052,0.073,0.063,0.042,0.06900000000000001,0.058,0.07000000000000001,0.08400000000000001,0.094,0.094,0.08799999999999999,0.1,0.08500000000000001,0.097,0.094,0.091,0.107,0.083,0.029,0.031,0.042,0.053,0.067,0.053,0.052,0.045,0.05,0.037,0.043,0.039,0.054,0.058,0.051,0.054,0.056,0.038,0.066,0.067,0.076,0.109,0.099,0.1,0.125,0.113,0.116,0.12,0.128,0.112,0.122,0.104,0.037,0.037,0.2,0.008999999999999999,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.033,0.036,0.03,0.032,0.035,0.035,0.035,0.031,0.034,0.033,0.035],[0.202,0.073,0.07000000000000001,0.079,0.07099999999999999,0.08699999999999999,0.093,0.079,0.097,0.07199999999999999,0.07000000000000001,0.083,0.07199999999999999,0.076,0.096,0.116,0.13,0.114,0.08500000000000001,0.103,0.091,0.08699999999999999,0.08599999999999999,0.08500000000000001,0.165,0.124,0.126,0.129,0.164,0.141,0.162,0.435,0.039,0.025,0.05,0.039,0.029,0.017,0.036,0.035,0.03,0.022,0.058,0.04,0.062,0.042,0.036,0.024,0.064,0.045,0.046,0.052,0.074,0.066,0.065,0.065,0.073,0.056,0.059,0.074,0.057,0.06,0.018,0.031,0.037,0.054,0.07099999999999999,0.048,0.039,0.02,0.044,0.029,0.038,0.021,0.045,0.063,0.053,0.065,0.067,0.03,0.091,0.06,0.117,0.107,0.169,0.096,0.093,0.108,0.107,0.102,0.105,0.093,0.126,0.107,0.034,0.03,0.046,0.077,0.058,0.117,0.06,0.054,0.049,0.031,0.053,0.054,0.1,0.078,0.053,0.089,0.08599999999999999,0.06,0.07000000000000001,0.076,0.08599999999999999,0.082,0.102,0.094,0.102,0.114,0.08500000000000001,0.105,0.1,0.089,0.107,0.113,0.037,0.049,0.047,0.053,0.121,0.07000000000000001,0.07000000000000001,0.048,0.061,0.033,0.036,0.039,0.048,0.063,0.061,0.068,0.08,0.037,0.08599999999999999,0.067,0.102,0.083,0.141,0.105,0.173,0.156,0.114,0.165,0.149,0.163,0.151,0.124,0.059,0.08599999999999999,0.435,0.013,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.048,0.077,0.034,0.047,0.048,0.049,0.06900000000000001,0.064,0.039,0.062,0.055]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Higher numbers of species in data augmentation increase model run
time.</p>
</div>
<div class="section level3">
<h3 id="categorical-covariates">Categorical covariates<a class="anchor" aria-label="anchor" href="#categorical-covariates"></a>
</h3>
<div class="section level4">
<h4 id="site-covariates">Site covariates<a class="anchor" aria-label="anchor" href="#site-covariates"></a>
</h4>
<p>Site covariates will be interpreted as categorical if they are
factors in the input data frame. If a random effect of a categorical
covariate is defined, there will be independent species-level random
effects within each factor level of the categorical covariate. In other
words, each factor level will have its own and independent random effect
of species.</p>
<p>Here is an example with a categorical site covariate “categ” on
occupancy:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_categ1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_jags_categ1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"categ"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_categ1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_categ1</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model_jags_categ1</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Plot the results:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model_jags_categ1</span>,</span>
<span>             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $categ</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model_jags_categ1</span>,</span>
<span>          mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $categ</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-54-2.png" width="700"></p>
<p>In the table below, see the arguments
<code>beta.ranef.categ.categ</code>. The species effects have two
indices: [species, factorLevel]. Accordingly, there are three estimates
for <code>mean</code> and <code>SD</code>, respectively. All estimates
for the first factor level are 0, since the intercept refers to the
first factor level (i.e. reference level, which we defined as “medium”
above).</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_categ1</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-40e5befdc214e4cc186d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-40e5befdc214e4cc186d">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.categ.categ[1,1]","beta.ranef.categ.categ[2,1]","beta.ranef.categ.categ[3,1]","beta.ranef.categ.categ[4,1]","beta.ranef.categ.categ[5,1]","beta.ranef.categ.categ[6,1]","beta.ranef.categ.categ[7,1]","beta.ranef.categ.categ[8,1]","beta.ranef.categ.categ[9,1]","beta.ranef.categ.categ[10,1]","beta.ranef.categ.categ[11,1]","beta.ranef.categ.categ[12,1]","beta.ranef.categ.categ[13,1]","beta.ranef.categ.categ[14,1]","beta.ranef.categ.categ[15,1]","beta.ranef.categ.categ[16,1]","beta.ranef.categ.categ[17,1]","beta.ranef.categ.categ[18,1]","beta.ranef.categ.categ[19,1]","beta.ranef.categ.categ[1,2]","beta.ranef.categ.categ[2,2]","beta.ranef.categ.categ[3,2]","beta.ranef.categ.categ[4,2]","beta.ranef.categ.categ[5,2]","beta.ranef.categ.categ[6,2]","beta.ranef.categ.categ[7,2]","beta.ranef.categ.categ[8,2]","beta.ranef.categ.categ[9,2]","beta.ranef.categ.categ[10,2]","beta.ranef.categ.categ[11,2]","beta.ranef.categ.categ[12,2]","beta.ranef.categ.categ[13,2]","beta.ranef.categ.categ[14,2]","beta.ranef.categ.categ[15,2]","beta.ranef.categ.categ[16,2]","beta.ranef.categ.categ[17,2]","beta.ranef.categ.categ[18,2]","beta.ranef.categ.categ[19,2]","beta.ranef.categ.categ[1,3]","beta.ranef.categ.categ[2,3]","beta.ranef.categ.categ[3,3]","beta.ranef.categ.categ[4,3]","beta.ranef.categ.categ[5,3]","beta.ranef.categ.categ[6,3]","beta.ranef.categ.categ[7,3]","beta.ranef.categ.categ[8,3]","beta.ranef.categ.categ[9,3]","beta.ranef.categ.categ[10,3]","beta.ranef.categ.categ[11,3]","beta.ranef.categ.categ[12,3]","beta.ranef.categ.categ[13,3]","beta.ranef.categ.categ[14,3]","beta.ranef.categ.categ[15,3]","beta.ranef.categ.categ[16,3]","beta.ranef.categ.categ[17,3]","beta.ranef.categ.categ[18,3]","beta.ranef.categ.categ[19,3]","beta.ranef.categ.categ.mean[1]","beta.ranef.categ.categ.mean[2]","beta.ranef.categ.categ.mean[3]","beta.ranef.categ.categ.sigma[1]","beta.ranef.categ.categ.sigma[2]","beta.ranef.categ.categ.sigma[3]","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,3.047,4.107,3.893,4.94,3.78,4.087,2.087,4.027,4.787,4.967,3.02,2.84,5.427,5.327,5.7,3.573,4.327,4.493,2.593,4.333,6.28,4.487,7.847,4.5,4.56,7.08,5.38,5.14,5.5,8.34,1.17,-0.022,-0.17,-0.181,0.254,-0.819,-0.54,-0.892,-0.353,0.161,0.865,0.364,-1.223,-0.876,-0.538,-0.078,-0.802,-0.514,-0.411,-0.254,0.8110000000000001,-1.548,-1.058,-0.666,-1.834,-1.645,-0.55,-1.183,0.702,-1.154,0.195,-1.854,-2.095,-0.518,-1.674,-1.057,-0.419,-1.35,-1.721,-1.912,-1.111,0.978,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.329,-0.275,-1.238,-1.635,0.448,-0.644,-0.505,0.492,-0.539,0.667,-1.48,-0.66,-0.847,-1.489,-1.576,-0.703,-1.421,-0.521,-1.411,-0.381,-0.853,-0.555,1.531,-1.049,1.168,-1.111,-0.125,0.023,-0.188,2.09,1.02,-0.781,1.108,-0.948,-0.311,-0.5649999999999999,0.877,0.891,0,-0.6929999999999999,0.098,0,1.139,1.514,-0.723,-1.317,-1.91,-0.798,-0.715,0.218,-1.124,-1.2,-0.9389999999999999,-1.136,-1.159,-1.049,-1.557,-1.242,-1.313,-0.922,-1.769,-1.654,-1.705,-1.148,0.742],[0,0.885,1.112,0.928,0.9429999999999999,0.858,0.996,1.029,0.882,0.872,0.823,1,0.868,1.161,1.078,1.246,1.212,1.102,1.304,1.27,1.127,1.1,1.278,0.968,1.294,1.108,1.293,1.441,1.4,1.355,1.098,0.554,0.364,0.585,0.412,0.358,0.243,0.37,0.411,0.398,0.321,0.529,0.503,0.6830000000000001,0.499,0.595,0.343,0.613,0.513,0.676,0.235,0.264,0.455,0.519,0.946,0.49,0.476,0.239,0.511,0.362,0.452,0.307,0.542,0.642,0.658,0.606,0.582,0.34,0.93,0.791,0.864,0.281,0.248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.849,0.778,0.906,1.199,0.903,0.592,0.744,0.718,0.709,0.735,1.185,0.921,0.854,0.988,1.192,0.707,1.223,0.96,1.188,1.137,1.673,1.406,1.138,1.744,1.153,1.748,0.858,1.129,1.074,1.725,1.179,1.608,1.252,2.048,0.978,1.552,1.243,1.324,0,0.429,0.679,0,0.458,0.86,0.617,0.61,0.67,0.58,0.672,0.481,0.465,0.472,0.555,0.449,0.63,0.631,0.542,0.5669999999999999,0.595,0.44,0.6830000000000001,0.6899999999999999,0.759,0.283,0.252],[0,0.07199999999999999,0.091,0.076,0.077,0.07000000000000001,0.081,0.08400000000000001,0.07199999999999999,0.07099999999999999,0.067,0.082,0.07099999999999999,0.095,0.08799999999999999,0.102,0.099,0.09,0.106,0.104,0.092,0.09,0.104,0.079,0.106,0.09,0.106,0.118,0.114,0.111,0.09,0.045,0.03,0.048,0.034,0.029,0.02,0.03,0.034,0.032,0.026,0.043,0.041,0.056,0.041,0.049,0.028,0.05,0.042,0.055,0.019,0.022,0.037,0.042,0.077,0.04,0.039,0.02,0.042,0.03,0.037,0.025,0.044,0.052,0.054,0.05,0.048,0.028,0.076,0.065,0.07099999999999999,0.023,0.02,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.06900000000000001,0.063,0.074,0.098,0.074,0.048,0.061,0.059,0.058,0.06,0.097,0.075,0.07000000000000001,0.081,0.097,0.058,0.1,0.078,0.097,0.093,0.137,0.115,0.093,0.142,0.094,0.143,0.07000000000000001,0.092,0.08799999999999999,0.141,0.096,0.131,0.102,0.167,0.08,0.127,0.101,0.108,0,0.035,0.055,0,0.037,0.07000000000000001,0.05,0.05,0.055,0.047,0.055,0.039,0.038,0.039,0.045,0.037,0.051,0.052,0.044,0.046,0.049,0.036,0.056,0.056,0.062,0.023,0.021],[0,0.083,0.109,0.076,0.08599999999999999,0.079,0.094,0.083,0.067,0.078,0.06,0.068,0.082,0.094,0.08699999999999999,0.101,0.082,0.09,0.106,0.124,0.102,0.08799999999999999,0.104,0.068,0.095,0.105,0.161,0.121,0.134,0.134,0.091,0.042,0.026,0.048,0.04,0.029,0.022,0.03,0.041,0.03,0.029,0.041,0.041,0.056,0.053,0.044,0.027,0.048,0.044,0.07199999999999999,0.018,0.024,0.035,0.049,0.08699999999999999,0.037,0.05,0.018,0.046,0.026,0.047,0.027,0.044,0.059,0.054,0.051,0.075,0.028,0.08699999999999999,0.06900000000000001,0.08400000000000001,0.027,0.017,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.095,0.068,0.09,0.131,0.097,0.054,0.08599999999999999,0.08500000000000001,0.073,0.059,0.126,0.075,0.082,0.078,0.114,0.058,0.127,0.124,0.122,0.08699999999999999,0.189,0.144,0.119,0.199,0.116,0.217,0.063,0.092,0.099,0.23,0.11,0.189,0.126,0.232,0.077,0.155,0.12,0.143,0,0.051,0.083,0,0.063,0.14,0.056,0.054,0.06,0.061,0.059,0.056,0.034,0.042,0.043,0.041,0.06,0.056,0.051,0.044,0.051,0.036,0.077,0.08699999999999999,0.074,0.037,0.03]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="observation-level-covariates">Observation-level covariates<a class="anchor" aria-label="anchor" href="#observation-level-covariates"></a>
</h4>
<p>Currently categorical observation-level covariates are only fully
supported in JAGS, not Nimble. Observation-level covariates are matrices
and thus can’t be factors. Thus they need to be defined as character
matrices.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example categorical observation covariate</span></span>
<span><span class="va">input_AHM</span><span class="op">$</span><span class="va">obsCovs</span><span class="op">$</span><span class="va">wind_categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">input_AHM</span><span class="op">$</span><span class="va">obsCovs</span><span class="op">$</span><span class="va">wind</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"windy"</span>, <span class="st">"calm"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># result is a character matrix:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">input_AHM</span><span class="op">$</span><span class="va">obsCovs</span><span class="op">$</span><span class="va">wind_categ</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  chr [1:30, 1:5] "calm" "calm" "windy" "windy" "calm" "calm" "windy" "calm" ...</span></span></code></pre>
<p>Model example:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_categ2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_jags_categ2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wind_categ"</span><span class="op">)</span><span class="op">)</span>,     <span class="co"># "wind_categ" now</span></span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_categ2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_ahm_jags_categ2</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model_jags_categ2</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                         compile <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Model estimates. As above, the estimates for the first factor level
are 0. The relevant parameters here are called
<code>alpha.obs.ranef.categ.wind_categ</code>.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_categ2</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3a30b77bfe0c926229ab" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3a30b77bfe0c926229ab">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.categ.wind_categ[1,1]","alpha.obs.ranef.categ.wind_categ[2,1]","alpha.obs.ranef.categ.wind_categ[3,1]","alpha.obs.ranef.categ.wind_categ[4,1]","alpha.obs.ranef.categ.wind_categ[5,1]","alpha.obs.ranef.categ.wind_categ[6,1]","alpha.obs.ranef.categ.wind_categ[7,1]","alpha.obs.ranef.categ.wind_categ[8,1]","alpha.obs.ranef.categ.wind_categ[9,1]","alpha.obs.ranef.categ.wind_categ[10,1]","alpha.obs.ranef.categ.wind_categ[11,1]","alpha.obs.ranef.categ.wind_categ[12,1]","alpha.obs.ranef.categ.wind_categ[13,1]","alpha.obs.ranef.categ.wind_categ[14,1]","alpha.obs.ranef.categ.wind_categ[15,1]","alpha.obs.ranef.categ.wind_categ[16,1]","alpha.obs.ranef.categ.wind_categ[17,1]","alpha.obs.ranef.categ.wind_categ[18,1]","alpha.obs.ranef.categ.wind_categ[19,1]","alpha.obs.ranef.categ.wind_categ[1,2]","alpha.obs.ranef.categ.wind_categ[2,2]","alpha.obs.ranef.categ.wind_categ[3,2]","alpha.obs.ranef.categ.wind_categ[4,2]","alpha.obs.ranef.categ.wind_categ[5,2]","alpha.obs.ranef.categ.wind_categ[6,2]","alpha.obs.ranef.categ.wind_categ[7,2]","alpha.obs.ranef.categ.wind_categ[8,2]","alpha.obs.ranef.categ.wind_categ[9,2]","alpha.obs.ranef.categ.wind_categ[10,2]","alpha.obs.ranef.categ.wind_categ[11,2]","alpha.obs.ranef.categ.wind_categ[12,2]","alpha.obs.ranef.categ.wind_categ[13,2]","alpha.obs.ranef.categ.wind_categ[14,2]","alpha.obs.ranef.categ.wind_categ[15,2]","alpha.obs.ranef.categ.wind_categ[16,2]","alpha.obs.ranef.categ.wind_categ[17,2]","alpha.obs.ranef.categ.wind_categ[18,2]","alpha.obs.ranef.categ.wind_categ[19,2]","alpha.obs.ranef.categ.wind_categ.mean[1]","alpha.obs.ranef.categ.wind_categ.mean[2]","alpha.obs.ranef.categ.wind_categ.sigma[1]","alpha.obs.ranef.categ.wind_categ.sigma[2]","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.fixed.cont.habitat","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,3.027,4.24,4.2,5.44,4.313,4.34,2.82,4.393,5.12,5.447,3.54,3.4,5.393,5.607,5.687,3.613,4.58,4.673,2.78,4.56,6.48,4.527,8.026999999999999,4.64,4.967,6.873,4.727,4.9,5.573,8.212999999999999,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.01,-0.099,-0.011,-0.766,-0.105,-0.856,-0.766,-0.646,-0.468,0.286,0.405,0.315,-0.651,-0.974,-0.5600000000000001,-0.043,-0.284,-0.612,-0.319,0,-0.256,0,0.824,-1.878,-1.022,-0.59,-1.684,-1.592,-0.001,-0.824,1.137,-0.872,0.17,-1.945,-2.306,0.315,-1.28,-0.729,-0.342,-1.332,-1.29,-2.173,-0.9379999999999999,1.144,0.238,-0.615,-1.402,-2.021,-0.621,-0.524,0.181,-1.111,-0.951,-1.038,-0.861,-0.906,-0.867,-1.701,-1.128,-1.545,-1.038,-1.791,-1.565,-1.55,-1.108,0.76],[0,0.962,1.047,1.087,1.207,1.118,1.073,1.395,1.092,1.036,1.02,1.078,1.159,1.123,1.105,1.188,1.294,1.177,1.196,1.279,1.229,1.283,1.191,0.955,1.233,1.338,1.211,1.146,1.32,1.161,0.973,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.716,0.609,0.887,0.634,0.6,0.448,0.707,0.548,0.554,0.515,0.647,0.761,0.896,0.704,0.571,0.477,0.795,0.7,0.729,0,0.262,0,0.296,0.504,0.586,0.891,0.608,0.516,0.286,0.529,0.467,0.5669999999999999,0.353,0.677,0.794,0.613,0.732,0.608,0.474,1.084,0.803,0.916,0.334,0.299,0.146,0.475,0.476,0.655,0.605,0.588,0.426,0.509,0.356,0.42,0.415,0.594,0.637,0.496,0.5620000000000001,0.534,0.405,0.747,0.637,0.796,0.249,0.246],[0,0.079,0.08500000000000001,0.089,0.099,0.091,0.08799999999999999,0.114,0.089,0.08500000000000001,0.083,0.08799999999999999,0.095,0.092,0.09,0.097,0.106,0.096,0.098,0.104,0.1,0.105,0.097,0.078,0.101,0.109,0.099,0.094,0.108,0.095,0.079,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.058,0.05,0.07199999999999999,0.052,0.049,0.037,0.058,0.045,0.045,0.042,0.053,0.062,0.073,0.057,0.047,0.039,0.065,0.057,0.06,0,0.021,0,0.024,0.041,0.048,0.073,0.05,0.042,0.023,0.043,0.038,0.046,0.029,0.055,0.065,0.05,0.06,0.05,0.039,0.089,0.066,0.075,0.027,0.024,0.012,0.039,0.039,0.054,0.049,0.048,0.035,0.042,0.029,0.034,0.034,0.049,0.052,0.041,0.046,0.044,0.033,0.061,0.052,0.065,0.02,0.02],[0,0.126,0.08599999999999999,0.092,0.099,0.102,0.081,0.113,0.09,0.08500000000000001,0.07199999999999999,0.123,0.093,0.08500000000000001,0.12,0.096,0.099,0.096,0.121,0.099,0.08799999999999999,0.092,0.111,0.07199999999999999,0.101,0.129,0.117,0.103,0.105,0.08599999999999999,0.102,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.116,0.046,0.068,0.058,0.049,0.045,0.057,0.055,0.051,0.042,0.065,0.083,0.079,0.066,0.049,0.039,0.099,0.059,0.058,0,0.022,0,0.06900000000000001,0.051,0.053,0.06,0.057,0.05,0.021,0.057,0.039,0.052,0.029,0.074,0.08400000000000001,0.046,0.065,0.05,0.041,0.173,0.075,0.111,0.039,0.043,0.012,0.044,0.046,0.063,0.053,0.075,0.044,0.041,0.026,0.049,0.037,0.054,0.096,0.041,0.049,0.043,0.03,0.098,0.076,0.108,0.022,0.025]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Plot the results:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model_jags_categ2</span>, </span>
<span>             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ2</span>,</span>
<span>             submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind_categ</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model_jags_categ2</span>, </span>
<span>          mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ2</span>,</span>
<span>          submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind_categ</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-59-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="random-effects-other-than-species">Random effects other than species<a class="anchor" aria-label="anchor" href="#random-effects-other-than-species"></a>
</h3>
<p>By default random effects are by species. Alternatively, you can
specify random effects of a categorical site covariate2 on continuous
covariate1 using the pattern:</p>
<p>occuCovs(ranef = c(“covariate1|covariate2”))</p>
<p>The same syntax can be used in</p>
<p>detCovs(ranef = c(“covariate1|covariate2”))</p>
<p>and</p>
<p>detCovs(ranef = c(“covariate1|covariate2”))</p>
<p>Here is an example, where the effect of “habitat” differs between
levels of “categ”.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat|categ"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_ranef</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_ranef</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_ranef</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Search for the term “habitat_categ” in the table below. There are 2
estimates (for stations with “A” and “B”), plus the mean and sigma of
the random effect (this is only for demonstration, 2 factor levels is of
course not enough for applying random effects).</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_ranef</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2d6dd1d15067550931c2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2d6dd1d15067550931c2">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat_categ[1]","beta.ranef.cont.habitat_categ[2]","beta.ranef.cont.habitat_categ[3]","beta.ranef.cont.habitat_categ.mean","beta.ranef.cont.habitat_categ.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,3.093,4.113,4.273,5.233,4.02,4.06,2.447,4.193,5.113,5.267,3.26,3.147,5.367,5.107,5.373,3.32,4.26,4.213,2.393,4.153,6.107,4.313,7.72,4.593,4.593,6.613,4.633,4.767,5.307,8.279999999999999,1.155,-0.037,-0.08699999999999999,-0.106,0.24,-0.804,-0.602,-0.911,-0.329,0.136,0.861,0.392,-1.273,-0.855,-0.504,-0.03,-0.787,-0.528,-0.326,-0.244,0.8100000000000001,-1.459,-1.15,-0.723,-1.878,-1.649,-0.511,-1.186,0.6820000000000001,-1.118,0.262,-1.933,-2.049,-0.645,-1.673,-1,-0.384,-1.307,-1.585,-1.928,-1.141,0.97,0.349,0.183,0.377,0.268,0.658,-0.757,-1.405,-2.127,-0.756,-0.629,0.111,-1.233,-1.09,-1.107,-0.907,-1.006,-1.131,-1.732,-1.386,-1.654,-1.119,-1.983,-1.723,-1.914,-1.233,0.763],[0,1.064,1.138,1.048,1.077,0.901,0.95,1.162,1.028,0.994,1.085,1.12,0.999,1.126,1.05,1.196,1.076,1.144,1.021,1.098,0.888,1.069,1.069,0.8120000000000001,1.182,1.182,1.134,1.217,1.245,1.158,1.112,0.538,0.396,0.666,0.375,0.315,0.232,0.379,0.419,0.387,0.327,0.543,0.506,0.6909999999999999,0.509,0.528,0.322,0.641,0.489,0.68,0.242,0.255,0.395,0.524,0.902,0.554,0.424,0.252,0.539,0.396,0.455,0.277,0.576,0.635,0.715,0.5669999999999999,0.602,0.367,0.861,0.751,0.902,0.293,0.227,0.496,0.207,0.289,0.447,0.666,0.497,0.498,0.606,0.552,0.524,0.46,0.513,0.384,0.495,0.395,0.542,0.644,0.522,0.478,0.55,0.423,0.661,0.5649999999999999,0.676,0.259,0.24],[0,0.08699999999999999,0.093,0.08599999999999999,0.08799999999999999,0.074,0.078,0.095,0.08400000000000001,0.081,0.089,0.091,0.082,0.092,0.08599999999999999,0.098,0.08799999999999999,0.093,0.083,0.09,0.07199999999999999,0.08699999999999999,0.08699999999999999,0.066,0.097,0.097,0.093,0.099,0.102,0.095,0.091,0.044,0.032,0.054,0.031,0.026,0.019,0.031,0.034,0.032,0.027,0.044,0.041,0.056,0.042,0.043,0.026,0.052,0.04,0.056,0.02,0.021,0.032,0.043,0.074,0.045,0.035,0.021,0.044,0.032,0.037,0.023,0.047,0.052,0.058,0.046,0.049,0.03,0.07000000000000001,0.061,0.074,0.024,0.019,0.04,0.017,0.024,0.036,0.054,0.041,0.041,0.049,0.045,0.043,0.038,0.042,0.031,0.04,0.032,0.044,0.053,0.043,0.039,0.045,0.035,0.054,0.046,0.055,0.021,0.02],[0,0.08699999999999999,0.08799999999999999,0.104,0.097,0.066,0.078,0.095,0.092,0.08599999999999999,0.083,0.107,0.097,0.092,0.093,0.104,0.08799999999999999,0.092,0.083,0.073,0.073,0.1,0.08799999999999999,0.065,0.097,0.096,0.092,0.099,0.102,0.095,0.096,0.047,0.032,0.048,0.027,0.026,0.021,0.035,0.035,0.033,0.021,0.042,0.041,0.057,0.044,0.043,0.026,0.052,0.038,0.056,0.016,0.023,0.032,0.047,0.08799999999999999,0.052,0.047,0.017,0.052,0.029,0.035,0.021,0.047,0.058,0.067,0.047,0.048,0.03,0.079,0.067,0.09,0.025,0.018,0.052,0.019,0.031,0.043,0.054,0.038,0.041,0.061,0.07199999999999999,0.062,0.049,0.042,0.031,0.033,0.032,0.055,0.07199999999999999,0.041,0.043,0.045,0.033,0.068,0.059,0.061,0.021,0.023]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Currently random effects other than species can not be plotted with
<code>plot_effects</code> and <code>plot_coef</code>.</p>
</div>
<div class="section level3">
<h3 id="nested-random-effects">Nested random effects<a class="anchor" aria-label="anchor" href="#nested-random-effects"></a>
</h3>
<p>Consider a numeric covariate1 and categorical covariate2.</p>
<p>Use the keyword “+Species” to specify a species-specific random
effect within each factor level of covariate2:</p>
<p>occuCovs(ranef = c(“covariate1|covariate2+Species”))</p>
<p>Here is an example, with independent random effect of “categ” on
“habitat” for each species:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat|categ+Species"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_nested</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_nested</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_nested</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Search for the term “habitat_categ_Species” in the table below.
Depending on the number of species and factor levels The number of
parameter estimates is very high when using nested random effects.</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_nested</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3f3cd6e72ff48c99c642" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3f3cd6e72ff48c99c642">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat_categ_Species[1,1]","beta.ranef.cont.habitat_categ_Species[2,1]","beta.ranef.cont.habitat_categ_Species[3,1]","beta.ranef.cont.habitat_categ_Species[4,1]","beta.ranef.cont.habitat_categ_Species[5,1]","beta.ranef.cont.habitat_categ_Species[6,1]","beta.ranef.cont.habitat_categ_Species[7,1]","beta.ranef.cont.habitat_categ_Species[8,1]","beta.ranef.cont.habitat_categ_Species[9,1]","beta.ranef.cont.habitat_categ_Species[10,1]","beta.ranef.cont.habitat_categ_Species[11,1]","beta.ranef.cont.habitat_categ_Species[12,1]","beta.ranef.cont.habitat_categ_Species[13,1]","beta.ranef.cont.habitat_categ_Species[14,1]","beta.ranef.cont.habitat_categ_Species[15,1]","beta.ranef.cont.habitat_categ_Species[16,1]","beta.ranef.cont.habitat_categ_Species[17,1]","beta.ranef.cont.habitat_categ_Species[18,1]","beta.ranef.cont.habitat_categ_Species[19,1]","beta.ranef.cont.habitat_categ_Species[1,2]","beta.ranef.cont.habitat_categ_Species[2,2]","beta.ranef.cont.habitat_categ_Species[3,2]","beta.ranef.cont.habitat_categ_Species[4,2]","beta.ranef.cont.habitat_categ_Species[5,2]","beta.ranef.cont.habitat_categ_Species[6,2]","beta.ranef.cont.habitat_categ_Species[7,2]","beta.ranef.cont.habitat_categ_Species[8,2]","beta.ranef.cont.habitat_categ_Species[9,2]","beta.ranef.cont.habitat_categ_Species[10,2]","beta.ranef.cont.habitat_categ_Species[11,2]","beta.ranef.cont.habitat_categ_Species[12,2]","beta.ranef.cont.habitat_categ_Species[13,2]","beta.ranef.cont.habitat_categ_Species[14,2]","beta.ranef.cont.habitat_categ_Species[15,2]","beta.ranef.cont.habitat_categ_Species[16,2]","beta.ranef.cont.habitat_categ_Species[17,2]","beta.ranef.cont.habitat_categ_Species[18,2]","beta.ranef.cont.habitat_categ_Species[19,2]","beta.ranef.cont.habitat_categ_Species[1,3]","beta.ranef.cont.habitat_categ_Species[2,3]","beta.ranef.cont.habitat_categ_Species[3,3]","beta.ranef.cont.habitat_categ_Species[4,3]","beta.ranef.cont.habitat_categ_Species[5,3]","beta.ranef.cont.habitat_categ_Species[6,3]","beta.ranef.cont.habitat_categ_Species[7,3]","beta.ranef.cont.habitat_categ_Species[8,3]","beta.ranef.cont.habitat_categ_Species[9,3]","beta.ranef.cont.habitat_categ_Species[10,3]","beta.ranef.cont.habitat_categ_Species[11,3]","beta.ranef.cont.habitat_categ_Species[12,3]","beta.ranef.cont.habitat_categ_Species[13,3]","beta.ranef.cont.habitat_categ_Species[14,3]","beta.ranef.cont.habitat_categ_Species[15,3]","beta.ranef.cont.habitat_categ_Species[16,3]","beta.ranef.cont.habitat_categ_Species[17,3]","beta.ranef.cont.habitat_categ_Species[18,3]","beta.ranef.cont.habitat_categ_Species[19,3]","beta.ranef.cont.habitat_categ_Species.mean[1]","beta.ranef.cont.habitat_categ_Species.mean[2]","beta.ranef.cont.habitat_categ_Species.mean[3]","beta.ranef.cont.habitat_categ_Species.mean[4]","beta.ranef.cont.habitat_categ_Species.mean[5]","beta.ranef.cont.habitat_categ_Species.mean[6]","beta.ranef.cont.habitat_categ_Species.mean[7]","beta.ranef.cont.habitat_categ_Species.mean[8]","beta.ranef.cont.habitat_categ_Species.mean[9]","beta.ranef.cont.habitat_categ_Species.mean[10]","beta.ranef.cont.habitat_categ_Species.mean[11]","beta.ranef.cont.habitat_categ_Species.mean[12]","beta.ranef.cont.habitat_categ_Species.mean[13]","beta.ranef.cont.habitat_categ_Species.mean[14]","beta.ranef.cont.habitat_categ_Species.mean[15]","beta.ranef.cont.habitat_categ_Species.mean[16]","beta.ranef.cont.habitat_categ_Species.mean[17]","beta.ranef.cont.habitat_categ_Species.mean[18]","beta.ranef.cont.habitat_categ_Species.mean[19]","beta.ranef.cont.habitat_categ_Species.sigma[1]","beta.ranef.cont.habitat_categ_Species.sigma[2]","beta.ranef.cont.habitat_categ_Species.sigma[3]","beta.ranef.cont.habitat_categ_Species.sigma[4]","beta.ranef.cont.habitat_categ_Species.sigma[5]","beta.ranef.cont.habitat_categ_Species.sigma[6]","beta.ranef.cont.habitat_categ_Species.sigma[7]","beta.ranef.cont.habitat_categ_Species.sigma[8]","beta.ranef.cont.habitat_categ_Species.sigma[9]","beta.ranef.cont.habitat_categ_Species.sigma[10]","beta.ranef.cont.habitat_categ_Species.sigma[11]","beta.ranef.cont.habitat_categ_Species.sigma[12]","beta.ranef.cont.habitat_categ_Species.sigma[13]","beta.ranef.cont.habitat_categ_Species.sigma[14]","beta.ranef.cont.habitat_categ_Species.sigma[15]","beta.ranef.cont.habitat_categ_Species.sigma[16]","beta.ranef.cont.habitat_categ_Species.sigma[17]","beta.ranef.cont.habitat_categ_Species.sigma[18]","beta.ranef.cont.habitat_categ_Species.sigma[19]","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,4.493,5.447,5.24,6.187,5.013,5.26,3.787,5.18,5.667,6.267,4.147,3.987,5.773,5.387,5.833,3.58,4.453,4.867,2.88,4.553,7,5.793,8.907,7.453,8.193,8.76,7.3,7.307,7.287,9.58,1.008,0.028,-0.177,-0.308,0.344,-0.796,-0.577,-0.952,-0.333,0.181,0.751,0.393,-1.409,-1.068,-0.598,-0.08,-0.925,-0.651,-0.391,-0.273,0.8080000000000001,-1.953,-1.631,-1.149,-2.1,-1.905,-0.526,-1.303,0.824,-1.252,0.241,-2.024,-2.678,-0.744,-2.078,-0.953,-0.447,-1.953,-2.827,-2.719,-1.426,1.244,-5.409,-1.609,10.281,8.113,9.119,0.723,0.767,-0.297,0.649,-1.551,5.287,-2.387,-0.659,3.084,0.023,0.754,7.647,22.783,4.42,-5.445,-0.917,10.106,6.856,-5.33,1.343,0.8100000000000001,-1.066,0.381,-1.272,5.385,-2.582,-0.049,4.002,6.234,0.746,7.06,-20.435,6.789,0.367,-2.102,-6.296,14.781,-6.084,1.866,-2.568,-0.583,0.201,-1.008,6.031,6.601,-1.733,4.095,-10.728,0.319,-2.167,10.127,6.103,-1.712,-1.217,1.018,3.45,-0.451,1.124,-0.013,-0.605,0.387,-1.329,5,0.696,-0.577,3.386,-0.287,0.59,2.684,0.5620000000000001,4.208,5.524,1.99,15.657,10.745,9.694000000000001,1.351,3.113,1.381,1.383,1.456,1.885,7.139,1.94,1.741,11.44,1.39,8.613,26.755,4.732,-0.756,-1.089,-1.565,-0.345,-0.9,0.635,-0.858,-1.514,-0.796,-1.406,-1.254,-0.949,-1.846,-0.861,-1.196,-0.967,-1.415,-1.302,-1.569,-1.045,0.922],[0,0.981,1.132,1.139,0.986,1.068,1.065,1.278,1.199,1.115,1.157,1.178,1.164,1.1,1.073,1.212,1.255,1.027,1.151,1.158,1.144,1.248,1.598,1.307,1.786,1.853,1.359,1.575,1.351,1.292,1.166,0.481,0.382,0.665,0.464,0.343,0.234,0.384,0.439,0.366,0.33,0.494,0.554,0.74,0.495,0.529,0.351,0.632,0.506,0.637,0.249,0.23,0.527,0.729,1.145,0.489,0.455,0.245,0.59,0.352,0.518,0.315,0.493,0.6879999999999999,0.756,0.603,0.653,0.364,0.891,1.066,0.892,0.343,0.28,5.999,2.369,19.372,6.709,9.407999999999999,1.463,2.318,1.505,1.54,1.456,2.915,6.902,1.687,2.275,2.669,1.236,7.35,34.806,4.414,8.151,3.02,12.391,4.926,6.681,0.779,1.02,0.595,0.902,0.655,2.617,6.439,0.773,2.522,5.513,0.765,7.41,32.25,5.65,2.962,2.337,9.513999999999999,16.604,6.475,1.583,4.005,1.032,1.526,1.068,3.39,8.800000000000001,3.917,2.662,16.77,0.849,7.112,14.88,4.712,2.563,1.882,3.062,3.74,2.873,1.336,1.737,1.231,1.332,1.29,2.089,3.072,1.406,2.021,2.861,1.169,3.456,3.61,3.714,7.494,2.632,32.98,15.909,9.363,1.324,3.232,1.716,1.299,2.991,2.244,9.113,3.584,2.247,16.502,2.123,12.586,37.245,7.46,0.715,0.836,1.052,0.877,0.8,0.64,0.656,0.547,0.648,0.507,0.821,0.857,0.619,0.681,0.631,0.514,0.783,0.887,0.9,0.384,0.326],[0,0.08,0.092,0.093,0.08,0.08699999999999999,0.08699999999999999,0.104,0.098,0.091,0.094,0.096,0.095,0.09,0.08799999999999999,0.099,0.102,0.08400000000000001,0.094,0.095,0.093,0.102,0.13,0.107,0.146,0.151,0.111,0.129,0.11,0.105,0.095,0.039,0.031,0.054,0.038,0.028,0.019,0.031,0.036,0.03,0.027,0.04,0.045,0.06,0.04,0.043,0.029,0.052,0.041,0.052,0.02,0.019,0.043,0.059,0.093,0.04,0.037,0.02,0.048,0.029,0.042,0.026,0.04,0.056,0.062,0.049,0.053,0.03,0.073,0.08699999999999999,0.073,0.028,0.023,0.49,0.193,1.582,0.548,0.768,0.119,0.189,0.123,0.126,0.119,0.238,0.5639999999999999,0.138,0.186,0.218,0.101,0.6,2.842,0.36,0.665,0.247,1.012,0.402,0.545,0.064,0.083,0.049,0.074,0.053,0.214,0.526,0.063,0.206,0.45,0.062,0.605,2.633,0.461,0.242,0.191,0.777,1.356,0.529,0.129,0.327,0.08400000000000001,0.125,0.08699999999999999,0.277,0.719,0.32,0.217,1.369,0.06900000000000001,0.581,1.215,0.385,0.209,0.154,0.25,0.305,0.235,0.109,0.142,0.101,0.109,0.105,0.171,0.251,0.115,0.165,0.234,0.095,0.282,0.295,0.303,0.612,0.215,2.693,1.299,0.765,0.108,0.264,0.14,0.106,0.244,0.183,0.744,0.293,0.183,1.347,0.173,1.028,3.041,0.609,0.058,0.068,0.08599999999999999,0.07199999999999999,0.065,0.052,0.054,0.045,0.053,0.041,0.067,0.07000000000000001,0.051,0.056,0.052,0.042,0.064,0.07199999999999999,0.073,0.031,0.027],[0,0.124,0.174,0.123,0.133,0.122,0.095,0.126,0.182,0.1,0.149,0.157,0.133,0.121,0.092,0.121,0.147,0.095,0.127,0.091,0.093,0.098,0.186,0.218,0.274,0.337,0.273,0.211,0.246,0.196,0.164,0.035,0.034,0.064,0.044,0.032,0.019,0.029,0.04,0.03,0.027,0.036,0.045,0.061,0.04,0.038,0.023,0.057,0.041,0.052,0.02,0.021,0.044,0.109,0.167,0.039,0.03,0.019,0.049,0.029,0.049,0.026,0.037,0.08699999999999999,0.066,0.042,0.062,0.03,0.143,0.094,0.095,0.028,0.022,0.95,0.378,6.834,1.131,1.621,0.158,0.246,0.134,0.124,0.131,0.382,1.569,0.171,0.283,0.233,0.08699999999999999,1.265,3.777,0.783,1.654,0.572,3.235,1.17,0.955,0.094,0.08,0.049,0.102,0.058,0.26,2.186,0.079,0.43,0.618,0.067,1.407,5.424,0.93,0.667,0.316,2.302,5.483,1.01,0.16,0.631,0.111,0.158,0.082,0.475,1.956,0.635,0.598,5.513,0.066,0.981,3.534,0.762,0.166,0.19,0.322,0.628,0.25,0.127,0.141,0.09,0.129,0.112,0.263,0.491,0.111,0.384,0.233,0.08400000000000001,0.606,0.371,0.395,0.996,0.313,5.638,4.137,1.721,0.102,0.371,0.217,0.106,0.245,0.327,1.881,0.476,0.273,4.627,0.173,1.643,2.728,0.894,0.076,0.097,0.188,0.08699999999999999,0.065,0.068,0.066,0.049,0.074,0.053,0.065,0.082,0.054,0.052,0.056,0.04,0.1,0.07099999999999999,0.08,0.037,0.046]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Currently nested random effects can not be plotted with
<code>plot_effects</code> and <code>plot_coef</code>.</p>
</div>
<div class="section level3">
<h3 id="species-and-site-random-effect-on-detection">Species and site random effect on detection<a class="anchor" aria-label="anchor" href="#species-and-site-random-effect-on-detection"></a>
</h3>
<p>Species and site random effect on detection probability can be
helpful if Bayesian p-values indicate lack of fit (overall and / or for
individual species). Such an effect can be added via argument
<code>speciesSiteRandomEffect</code>. Setting it to TRUE adds a random
effect “ran” to detection probability in the form:</p>
<p>logit.p[i,j,k] &lt;- alpha0[i] + … + <strong>ran[i, j]</strong></p>
<p>where i,j are species and station and occasion indices.
<code>ran</code> is defined as:</p>
<p>ran[i,j] ~ dnorm(0, tau.ran)</p>
<p>with <code>tau.ran</code> being the precision of the normal
distribution (precision = 1 / standard deviation).</p>
<p>Site is defined as the sampling location (e.g. camera trap station in
this context).</p>
<p>Below is an example model:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_species_station_ran</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_species_station_ran</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  speciesSiteRandomEffect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_species_station_ran</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_species_station_ran</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_species_station_ran</span>, </span>
<span>                                        n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                                        n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                                        thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                        chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                        quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The model returns the standard deviation of this random effect as
<code>alpha.speciessite.ranef.sigma</code>, which can be found in the
table below.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_species_station_ran</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-07da001a05366ad2440f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-07da001a05366ad2440f">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha.speciesstation.ranef[1,1]","alpha.speciesstation.ranef[2,1]","alpha.speciesstation.ranef[3,1]","alpha.speciesstation.ranef[4,1]","alpha.speciesstation.ranef[5,1]","alpha.speciesstation.ranef[6,1]","alpha.speciesstation.ranef[7,1]","alpha.speciesstation.ranef[8,1]","alpha.speciesstation.ranef[9,1]","alpha.speciesstation.ranef[10,1]","alpha.speciesstation.ranef[11,1]","alpha.speciesstation.ranef[12,1]","alpha.speciesstation.ranef[13,1]","alpha.speciesstation.ranef[14,1]","alpha.speciesstation.ranef[15,1]","alpha.speciesstation.ranef[16,1]","alpha.speciesstation.ranef[17,1]","alpha.speciesstation.ranef[18,1]","alpha.speciesstation.ranef[19,1]","alpha.speciesstation.ranef[1,2]","alpha.speciesstation.ranef[2,2]","alpha.speciesstation.ranef[3,2]","alpha.speciesstation.ranef[4,2]","alpha.speciesstation.ranef[5,2]","alpha.speciesstation.ranef[6,2]","alpha.speciesstation.ranef[7,2]","alpha.speciesstation.ranef[8,2]","alpha.speciesstation.ranef[9,2]","alpha.speciesstation.ranef[10,2]","alpha.speciesstation.ranef[11,2]","alpha.speciesstation.ranef[12,2]","alpha.speciesstation.ranef[13,2]","alpha.speciesstation.ranef[14,2]","alpha.speciesstation.ranef[15,2]","alpha.speciesstation.ranef[16,2]","alpha.speciesstation.ranef[17,2]","alpha.speciesstation.ranef[18,2]","alpha.speciesstation.ranef[19,2]","alpha.speciesstation.ranef[1,3]","alpha.speciesstation.ranef[2,3]","alpha.speciesstation.ranef[3,3]","alpha.speciesstation.ranef[4,3]","alpha.speciesstation.ranef[5,3]","alpha.speciesstation.ranef[6,3]","alpha.speciesstation.ranef[7,3]","alpha.speciesstation.ranef[8,3]","alpha.speciesstation.ranef[9,3]","alpha.speciesstation.ranef[10,3]","alpha.speciesstation.ranef[11,3]","alpha.speciesstation.ranef[12,3]","alpha.speciesstation.ranef[13,3]","alpha.speciesstation.ranef[14,3]","alpha.speciesstation.ranef[15,3]","alpha.speciesstation.ranef[16,3]","alpha.speciesstation.ranef[17,3]","alpha.speciesstation.ranef[18,3]","alpha.speciesstation.ranef[19,3]","alpha.speciesstation.ranef[1,4]","alpha.speciesstation.ranef[2,4]","alpha.speciesstation.ranef[3,4]","alpha.speciesstation.ranef[4,4]","alpha.speciesstation.ranef[5,4]","alpha.speciesstation.ranef[6,4]","alpha.speciesstation.ranef[7,4]","alpha.speciesstation.ranef[8,4]","alpha.speciesstation.ranef[9,4]","alpha.speciesstation.ranef[10,4]","alpha.speciesstation.ranef[11,4]","alpha.speciesstation.ranef[12,4]","alpha.speciesstation.ranef[13,4]","alpha.speciesstation.ranef[14,4]","alpha.speciesstation.ranef[15,4]","alpha.speciesstation.ranef[16,4]","alpha.speciesstation.ranef[17,4]","alpha.speciesstation.ranef[18,4]","alpha.speciesstation.ranef[19,4]","alpha.speciesstation.ranef[1,5]","alpha.speciesstation.ranef[2,5]","alpha.speciesstation.ranef[3,5]","alpha.speciesstation.ranef[4,5]","alpha.speciesstation.ranef[5,5]","alpha.speciesstation.ranef[6,5]","alpha.speciesstation.ranef[7,5]","alpha.speciesstation.ranef[8,5]","alpha.speciesstation.ranef[9,5]","alpha.speciesstation.ranef[10,5]","alpha.speciesstation.ranef[11,5]","alpha.speciesstation.ranef[12,5]","alpha.speciesstation.ranef[13,5]","alpha.speciesstation.ranef[14,5]","alpha.speciesstation.ranef[15,5]","alpha.speciesstation.ranef[16,5]","alpha.speciesstation.ranef[17,5]","alpha.speciesstation.ranef[18,5]","alpha.speciesstation.ranef[19,5]","alpha.speciesstation.ranef[1,6]","alpha.speciesstation.ranef[2,6]","alpha.speciesstation.ranef[3,6]","alpha.speciesstation.ranef[4,6]","alpha.speciesstation.ranef[5,6]","alpha.speciesstation.ranef[6,6]","alpha.speciesstation.ranef[7,6]","alpha.speciesstation.ranef[8,6]","alpha.speciesstation.ranef[9,6]","alpha.speciesstation.ranef[10,6]","alpha.speciesstation.ranef[11,6]","alpha.speciesstation.ranef[12,6]","alpha.speciesstation.ranef[13,6]","alpha.speciesstation.ranef[14,6]","alpha.speciesstation.ranef[15,6]","alpha.speciesstation.ranef[16,6]","alpha.speciesstation.ranef[17,6]","alpha.speciesstation.ranef[18,6]","alpha.speciesstation.ranef[19,6]","alpha.speciesstation.ranef[1,7]","alpha.speciesstation.ranef[2,7]","alpha.speciesstation.ranef[3,7]","alpha.speciesstation.ranef[4,7]","alpha.speciesstation.ranef[5,7]","alpha.speciesstation.ranef[6,7]","alpha.speciesstation.ranef[7,7]","alpha.speciesstation.ranef[8,7]","alpha.speciesstation.ranef[9,7]","alpha.speciesstation.ranef[10,7]","alpha.speciesstation.ranef[11,7]","alpha.speciesstation.ranef[12,7]","alpha.speciesstation.ranef[13,7]","alpha.speciesstation.ranef[14,7]","alpha.speciesstation.ranef[15,7]","alpha.speciesstation.ranef[16,7]","alpha.speciesstation.ranef[17,7]","alpha.speciesstation.ranef[18,7]","alpha.speciesstation.ranef[19,7]","alpha.speciesstation.ranef[1,8]","alpha.speciesstation.ranef[2,8]","alpha.speciesstation.ranef[3,8]","alpha.speciesstation.ranef[4,8]","alpha.speciesstation.ranef[5,8]","alpha.speciesstation.ranef[6,8]","alpha.speciesstation.ranef[7,8]","alpha.speciesstation.ranef[8,8]","alpha.speciesstation.ranef[9,8]","alpha.speciesstation.ranef[10,8]","alpha.speciesstation.ranef[11,8]","alpha.speciesstation.ranef[12,8]","alpha.speciesstation.ranef[13,8]","alpha.speciesstation.ranef[14,8]","alpha.speciesstation.ranef[15,8]","alpha.speciesstation.ranef[16,8]","alpha.speciesstation.ranef[17,8]","alpha.speciesstation.ranef[18,8]","alpha.speciesstation.ranef[19,8]","alpha.speciesstation.ranef[1,9]","alpha.speciesstation.ranef[2,9]","alpha.speciesstation.ranef[3,9]","alpha.speciesstation.ranef[4,9]","alpha.speciesstation.ranef[5,9]","alpha.speciesstation.ranef[6,9]","alpha.speciesstation.ranef[7,9]","alpha.speciesstation.ranef[8,9]","alpha.speciesstation.ranef[9,9]","alpha.speciesstation.ranef[10,9]","alpha.speciesstation.ranef[11,9]","alpha.speciesstation.ranef[12,9]","alpha.speciesstation.ranef[13,9]","alpha.speciesstation.ranef[14,9]","alpha.speciesstation.ranef[15,9]","alpha.speciesstation.ranef[16,9]","alpha.speciesstation.ranef[17,9]","alpha.speciesstation.ranef[18,9]","alpha.speciesstation.ranef[19,9]","alpha.speciesstation.ranef[1,10]","alpha.speciesstation.ranef[2,10]","alpha.speciesstation.ranef[3,10]","alpha.speciesstation.ranef[4,10]","alpha.speciesstation.ranef[5,10]","alpha.speciesstation.ranef[6,10]","alpha.speciesstation.ranef[7,10]","alpha.speciesstation.ranef[8,10]","alpha.speciesstation.ranef[9,10]","alpha.speciesstation.ranef[10,10]","alpha.speciesstation.ranef[11,10]","alpha.speciesstation.ranef[12,10]","alpha.speciesstation.ranef[13,10]","alpha.speciesstation.ranef[14,10]","alpha.speciesstation.ranef[15,10]","alpha.speciesstation.ranef[16,10]","alpha.speciesstation.ranef[17,10]","alpha.speciesstation.ranef[18,10]","alpha.speciesstation.ranef[19,10]","alpha.speciesstation.ranef[1,11]","alpha.speciesstation.ranef[2,11]","alpha.speciesstation.ranef[3,11]","alpha.speciesstation.ranef[4,11]","alpha.speciesstation.ranef[5,11]","alpha.speciesstation.ranef[6,11]","alpha.speciesstation.ranef[7,11]","alpha.speciesstation.ranef[8,11]","alpha.speciesstation.ranef[9,11]","alpha.speciesstation.ranef[10,11]","alpha.speciesstation.ranef[11,11]","alpha.speciesstation.ranef[12,11]","alpha.speciesstation.ranef[13,11]","alpha.speciesstation.ranef[14,11]","alpha.speciesstation.ranef[15,11]","alpha.speciesstation.ranef[16,11]","alpha.speciesstation.ranef[17,11]","alpha.speciesstation.ranef[18,11]","alpha.speciesstation.ranef[19,11]","alpha.speciesstation.ranef[1,12]","alpha.speciesstation.ranef[2,12]","alpha.speciesstation.ranef[3,12]","alpha.speciesstation.ranef[4,12]","alpha.speciesstation.ranef[5,12]","alpha.speciesstation.ranef[6,12]","alpha.speciesstation.ranef[7,12]","alpha.speciesstation.ranef[8,12]","alpha.speciesstation.ranef[9,12]","alpha.speciesstation.ranef[10,12]","alpha.speciesstation.ranef[11,12]","alpha.speciesstation.ranef[12,12]","alpha.speciesstation.ranef[13,12]","alpha.speciesstation.ranef[14,12]","alpha.speciesstation.ranef[15,12]","alpha.speciesstation.ranef[16,12]","alpha.speciesstation.ranef[17,12]","alpha.speciesstation.ranef[18,12]","alpha.speciesstation.ranef[19,12]","alpha.speciesstation.ranef[1,13]","alpha.speciesstation.ranef[2,13]","alpha.speciesstation.ranef[3,13]","alpha.speciesstation.ranef[4,13]","alpha.speciesstation.ranef[5,13]","alpha.speciesstation.ranef[6,13]","alpha.speciesstation.ranef[7,13]","alpha.speciesstation.ranef[8,13]","alpha.speciesstation.ranef[9,13]","alpha.speciesstation.ranef[10,13]","alpha.speciesstation.ranef[11,13]","alpha.speciesstation.ranef[12,13]","alpha.speciesstation.ranef[13,13]","alpha.speciesstation.ranef[14,13]","alpha.speciesstation.ranef[15,13]","alpha.speciesstation.ranef[16,13]","alpha.speciesstation.ranef[17,13]","alpha.speciesstation.ranef[18,13]","alpha.speciesstation.ranef[19,13]","alpha.speciesstation.ranef[1,14]","alpha.speciesstation.ranef[2,14]","alpha.speciesstation.ranef[3,14]","alpha.speciesstation.ranef[4,14]","alpha.speciesstation.ranef[5,14]","alpha.speciesstation.ranef[6,14]","alpha.speciesstation.ranef[7,14]","alpha.speciesstation.ranef[8,14]","alpha.speciesstation.ranef[9,14]","alpha.speciesstation.ranef[10,14]","alpha.speciesstation.ranef[11,14]","alpha.speciesstation.ranef[12,14]","alpha.speciesstation.ranef[13,14]","alpha.speciesstation.ranef[14,14]","alpha.speciesstation.ranef[15,14]","alpha.speciesstation.ranef[16,14]","alpha.speciesstation.ranef[17,14]","alpha.speciesstation.ranef[18,14]","alpha.speciesstation.ranef[19,14]","alpha.speciesstation.ranef[1,15]","alpha.speciesstation.ranef[2,15]","alpha.speciesstation.ranef[3,15]","alpha.speciesstation.ranef[4,15]","alpha.speciesstation.ranef[5,15]","alpha.speciesstation.ranef[6,15]","alpha.speciesstation.ranef[7,15]","alpha.speciesstation.ranef[8,15]","alpha.speciesstation.ranef[9,15]","alpha.speciesstation.ranef[10,15]","alpha.speciesstation.ranef[11,15]","alpha.speciesstation.ranef[12,15]","alpha.speciesstation.ranef[13,15]","alpha.speciesstation.ranef[14,15]","alpha.speciesstation.ranef[15,15]","alpha.speciesstation.ranef[16,15]","alpha.speciesstation.ranef[17,15]","alpha.speciesstation.ranef[18,15]","alpha.speciesstation.ranef[19,15]","alpha.speciesstation.ranef[1,16]","alpha.speciesstation.ranef[2,16]","alpha.speciesstation.ranef[3,16]","alpha.speciesstation.ranef[4,16]","alpha.speciesstation.ranef[5,16]","alpha.speciesstation.ranef[6,16]","alpha.speciesstation.ranef[7,16]","alpha.speciesstation.ranef[8,16]","alpha.speciesstation.ranef[9,16]","alpha.speciesstation.ranef[10,16]","alpha.speciesstation.ranef[11,16]","alpha.speciesstation.ranef[12,16]","alpha.speciesstation.ranef[13,16]","alpha.speciesstation.ranef[14,16]","alpha.speciesstation.ranef[15,16]","alpha.speciesstation.ranef[16,16]","alpha.speciesstation.ranef[17,16]","alpha.speciesstation.ranef[18,16]","alpha.speciesstation.ranef[19,16]","alpha.speciesstation.ranef[1,17]","alpha.speciesstation.ranef[2,17]","alpha.speciesstation.ranef[3,17]","alpha.speciesstation.ranef[4,17]","alpha.speciesstation.ranef[5,17]","alpha.speciesstation.ranef[6,17]","alpha.speciesstation.ranef[7,17]","alpha.speciesstation.ranef[8,17]","alpha.speciesstation.ranef[9,17]","alpha.speciesstation.ranef[10,17]","alpha.speciesstation.ranef[11,17]","alpha.speciesstation.ranef[12,17]","alpha.speciesstation.ranef[13,17]","alpha.speciesstation.ranef[14,17]","alpha.speciesstation.ranef[15,17]","alpha.speciesstation.ranef[16,17]","alpha.speciesstation.ranef[17,17]","alpha.speciesstation.ranef[18,17]","alpha.speciesstation.ranef[19,17]","alpha.speciesstation.ranef[1,18]","alpha.speciesstation.ranef[2,18]","alpha.speciesstation.ranef[3,18]","alpha.speciesstation.ranef[4,18]","alpha.speciesstation.ranef[5,18]","alpha.speciesstation.ranef[6,18]","alpha.speciesstation.ranef[7,18]","alpha.speciesstation.ranef[8,18]","alpha.speciesstation.ranef[9,18]","alpha.speciesstation.ranef[10,18]","alpha.speciesstation.ranef[11,18]","alpha.speciesstation.ranef[12,18]","alpha.speciesstation.ranef[13,18]","alpha.speciesstation.ranef[14,18]","alpha.speciesstation.ranef[15,18]","alpha.speciesstation.ranef[16,18]","alpha.speciesstation.ranef[17,18]","alpha.speciesstation.ranef[18,18]","alpha.speciesstation.ranef[19,18]","alpha.speciesstation.ranef[1,19]","alpha.speciesstation.ranef[2,19]","alpha.speciesstation.ranef[3,19]","alpha.speciesstation.ranef[4,19]","alpha.speciesstation.ranef[5,19]","alpha.speciesstation.ranef[6,19]","alpha.speciesstation.ranef[7,19]","alpha.speciesstation.ranef[8,19]","alpha.speciesstation.ranef[9,19]","alpha.speciesstation.ranef[10,19]","alpha.speciesstation.ranef[11,19]","alpha.speciesstation.ranef[12,19]","alpha.speciesstation.ranef[13,19]","alpha.speciesstation.ranef[14,19]","alpha.speciesstation.ranef[15,19]","alpha.speciesstation.ranef[16,19]","alpha.speciesstation.ranef[17,19]","alpha.speciesstation.ranef[18,19]","alpha.speciesstation.ranef[19,19]","alpha.speciesstation.ranef[1,20]","alpha.speciesstation.ranef[2,20]","alpha.speciesstation.ranef[3,20]","alpha.speciesstation.ranef[4,20]","alpha.speciesstation.ranef[5,20]","alpha.speciesstation.ranef[6,20]","alpha.speciesstation.ranef[7,20]","alpha.speciesstation.ranef[8,20]","alpha.speciesstation.ranef[9,20]","alpha.speciesstation.ranef[10,20]","alpha.speciesstation.ranef[11,20]","alpha.speciesstation.ranef[12,20]","alpha.speciesstation.ranef[13,20]","alpha.speciesstation.ranef[14,20]","alpha.speciesstation.ranef[15,20]","alpha.speciesstation.ranef[16,20]","alpha.speciesstation.ranef[17,20]","alpha.speciesstation.ranef[18,20]","alpha.speciesstation.ranef[19,20]","alpha.speciesstation.ranef[1,21]","alpha.speciesstation.ranef[2,21]","alpha.speciesstation.ranef[3,21]","alpha.speciesstation.ranef[4,21]","alpha.speciesstation.ranef[5,21]","alpha.speciesstation.ranef[6,21]","alpha.speciesstation.ranef[7,21]","alpha.speciesstation.ranef[8,21]","alpha.speciesstation.ranef[9,21]","alpha.speciesstation.ranef[10,21]","alpha.speciesstation.ranef[11,21]","alpha.speciesstation.ranef[12,21]","alpha.speciesstation.ranef[13,21]","alpha.speciesstation.ranef[14,21]","alpha.speciesstation.ranef[15,21]","alpha.speciesstation.ranef[16,21]","alpha.speciesstation.ranef[17,21]","alpha.speciesstation.ranef[18,21]","alpha.speciesstation.ranef[19,21]","alpha.speciesstation.ranef[1,22]","alpha.speciesstation.ranef[2,22]","alpha.speciesstation.ranef[3,22]","alpha.speciesstation.ranef[4,22]","alpha.speciesstation.ranef[5,22]","alpha.speciesstation.ranef[6,22]","alpha.speciesstation.ranef[7,22]","alpha.speciesstation.ranef[8,22]","alpha.speciesstation.ranef[9,22]","alpha.speciesstation.ranef[10,22]","alpha.speciesstation.ranef[11,22]","alpha.speciesstation.ranef[12,22]","alpha.speciesstation.ranef[13,22]","alpha.speciesstation.ranef[14,22]","alpha.speciesstation.ranef[15,22]","alpha.speciesstation.ranef[16,22]","alpha.speciesstation.ranef[17,22]","alpha.speciesstation.ranef[18,22]","alpha.speciesstation.ranef[19,22]","alpha.speciesstation.ranef[1,23]","alpha.speciesstation.ranef[2,23]","alpha.speciesstation.ranef[3,23]","alpha.speciesstation.ranef[4,23]","alpha.speciesstation.ranef[5,23]","alpha.speciesstation.ranef[6,23]","alpha.speciesstation.ranef[7,23]","alpha.speciesstation.ranef[8,23]","alpha.speciesstation.ranef[9,23]","alpha.speciesstation.ranef[10,23]","alpha.speciesstation.ranef[11,23]","alpha.speciesstation.ranef[12,23]","alpha.speciesstation.ranef[13,23]","alpha.speciesstation.ranef[14,23]","alpha.speciesstation.ranef[15,23]","alpha.speciesstation.ranef[16,23]","alpha.speciesstation.ranef[17,23]","alpha.speciesstation.ranef[18,23]","alpha.speciesstation.ranef[19,23]","alpha.speciesstation.ranef[1,24]","alpha.speciesstation.ranef[2,24]","alpha.speciesstation.ranef[3,24]","alpha.speciesstation.ranef[4,24]","alpha.speciesstation.ranef[5,24]","alpha.speciesstation.ranef[6,24]","alpha.speciesstation.ranef[7,24]","alpha.speciesstation.ranef[8,24]","alpha.speciesstation.ranef[9,24]","alpha.speciesstation.ranef[10,24]","alpha.speciesstation.ranef[11,24]","alpha.speciesstation.ranef[12,24]","alpha.speciesstation.ranef[13,24]","alpha.speciesstation.ranef[14,24]","alpha.speciesstation.ranef[15,24]","alpha.speciesstation.ranef[16,24]","alpha.speciesstation.ranef[17,24]","alpha.speciesstation.ranef[18,24]","alpha.speciesstation.ranef[19,24]","alpha.speciesstation.ranef[1,25]","alpha.speciesstation.ranef[2,25]","alpha.speciesstation.ranef[3,25]","alpha.speciesstation.ranef[4,25]","alpha.speciesstation.ranef[5,25]","alpha.speciesstation.ranef[6,25]","alpha.speciesstation.ranef[7,25]","alpha.speciesstation.ranef[8,25]","alpha.speciesstation.ranef[9,25]","alpha.speciesstation.ranef[10,25]","alpha.speciesstation.ranef[11,25]","alpha.speciesstation.ranef[12,25]","alpha.speciesstation.ranef[13,25]","alpha.speciesstation.ranef[14,25]","alpha.speciesstation.ranef[15,25]","alpha.speciesstation.ranef[16,25]","alpha.speciesstation.ranef[17,25]","alpha.speciesstation.ranef[18,25]","alpha.speciesstation.ranef[19,25]","alpha.speciesstation.ranef[1,26]","alpha.speciesstation.ranef[2,26]","alpha.speciesstation.ranef[3,26]","alpha.speciesstation.ranef[4,26]","alpha.speciesstation.ranef[5,26]","alpha.speciesstation.ranef[6,26]","alpha.speciesstation.ranef[7,26]","alpha.speciesstation.ranef[8,26]","alpha.speciesstation.ranef[9,26]","alpha.speciesstation.ranef[10,26]","alpha.speciesstation.ranef[11,26]","alpha.speciesstation.ranef[12,26]","alpha.speciesstation.ranef[13,26]","alpha.speciesstation.ranef[14,26]","alpha.speciesstation.ranef[15,26]","alpha.speciesstation.ranef[16,26]","alpha.speciesstation.ranef[17,26]","alpha.speciesstation.ranef[18,26]","alpha.speciesstation.ranef[19,26]","alpha.speciesstation.ranef[1,27]","alpha.speciesstation.ranef[2,27]","alpha.speciesstation.ranef[3,27]","alpha.speciesstation.ranef[4,27]","alpha.speciesstation.ranef[5,27]","alpha.speciesstation.ranef[6,27]","alpha.speciesstation.ranef[7,27]","alpha.speciesstation.ranef[8,27]","alpha.speciesstation.ranef[9,27]","alpha.speciesstation.ranef[10,27]","alpha.speciesstation.ranef[11,27]","alpha.speciesstation.ranef[12,27]","alpha.speciesstation.ranef[13,27]","alpha.speciesstation.ranef[14,27]","alpha.speciesstation.ranef[15,27]","alpha.speciesstation.ranef[16,27]","alpha.speciesstation.ranef[17,27]","alpha.speciesstation.ranef[18,27]","alpha.speciesstation.ranef[19,27]","alpha.speciesstation.ranef[1,28]","alpha.speciesstation.ranef[2,28]","alpha.speciesstation.ranef[3,28]","alpha.speciesstation.ranef[4,28]","alpha.speciesstation.ranef[5,28]","alpha.speciesstation.ranef[6,28]","alpha.speciesstation.ranef[7,28]","alpha.speciesstation.ranef[8,28]","alpha.speciesstation.ranef[9,28]","alpha.speciesstation.ranef[10,28]","alpha.speciesstation.ranef[11,28]","alpha.speciesstation.ranef[12,28]","alpha.speciesstation.ranef[13,28]","alpha.speciesstation.ranef[14,28]","alpha.speciesstation.ranef[15,28]","alpha.speciesstation.ranef[16,28]","alpha.speciesstation.ranef[17,28]","alpha.speciesstation.ranef[18,28]","alpha.speciesstation.ranef[19,28]","alpha.speciesstation.ranef[1,29]","alpha.speciesstation.ranef[2,29]","alpha.speciesstation.ranef[3,29]","alpha.speciesstation.ranef[4,29]","alpha.speciesstation.ranef[5,29]","alpha.speciesstation.ranef[6,29]","alpha.speciesstation.ranef[7,29]","alpha.speciesstation.ranef[8,29]","alpha.speciesstation.ranef[9,29]","alpha.speciesstation.ranef[10,29]","alpha.speciesstation.ranef[11,29]","alpha.speciesstation.ranef[12,29]","alpha.speciesstation.ranef[13,29]","alpha.speciesstation.ranef[14,29]","alpha.speciesstation.ranef[15,29]","alpha.speciesstation.ranef[16,29]","alpha.speciesstation.ranef[17,29]","alpha.speciesstation.ranef[18,29]","alpha.speciesstation.ranef[19,29]","alpha.speciesstation.ranef[1,30]","alpha.speciesstation.ranef[2,30]","alpha.speciesstation.ranef[3,30]","alpha.speciesstation.ranef[4,30]","alpha.speciesstation.ranef[5,30]","alpha.speciesstation.ranef[6,30]","alpha.speciesstation.ranef[7,30]","alpha.speciesstation.ranef[8,30]","alpha.speciesstation.ranef[9,30]","alpha.speciesstation.ranef[10,30]","alpha.speciesstation.ranef[11,30]","alpha.speciesstation.ranef[12,30]","alpha.speciesstation.ranef[13,30]","alpha.speciesstation.ranef[14,30]","alpha.speciesstation.ranef[15,30]","alpha.speciesstation.ranef[16,30]","alpha.speciesstation.ranef[17,30]","alpha.speciesstation.ranef[18,30]","alpha.speciesstation.ranef[19,30]","alpha.speciesstation.ranef.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat[1]","beta.ranef.cont.habitat[2]","beta.ranef.cont.habitat[3]","beta.ranef.cont.habitat[4]","beta.ranef.cont.habitat[5]","beta.ranef.cont.habitat[6]","beta.ranef.cont.habitat[7]","beta.ranef.cont.habitat[8]","beta.ranef.cont.habitat[9]","beta.ranef.cont.habitat[10]","beta.ranef.cont.habitat[11]","beta.ranef.cont.habitat[12]","beta.ranef.cont.habitat[13]","beta.ranef.cont.habitat[14]","beta.ranef.cont.habitat[15]","beta.ranef.cont.habitat[16]","beta.ranef.cont.habitat[17]","beta.ranef.cont.habitat[18]","beta.ranef.cont.habitat[19]","beta.ranef.cont.habitat.mean","beta.ranef.cont.habitat.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,3.313,4.327,4.213,5.307,3.993,4.567,2.58,4.333,5.147,5.507,3.733,3.393,5.747,5.447,5.96,3.733,4.733,4.793,3.053,4.933,6.92,5.14,8.573,6.12,6.007,8.227,6.587,6.4,6.88,9.833,1.211,-0.032,-0.265,-0.241,0.325,-0.919,-0.819,-0.992,-0.377,0.139,0.951,0.451,-1.371,-1.068,-0.669,0.008999999999999999,-0.829,-0.638,-0.456,-0.3,0.909,-0.107,-0.021,0.038,0.07000000000000001,0.04,-0.093,-0.111,-0.027,-0.039,-0.189,-0.015,-0.08400000000000001,0.499,0.04,-0.078,0.021,-0.122,0.074,0.08400000000000001,0.066,0.006,0.104,-0.021,-0.209,0.12,0.023,0.598,-0.075,0.145,0.136,0.008999999999999999,-0.056,0.073,-0.123,-0.011,-0.041,-0.053,-0.037,-0.161,-0.097,-0.045,-0.08799999999999999,0.101,-0.036,0.043,-0.247,0.047,0.478,-0.059,0.056,0.047,-0.039,-0.054,-0.129,-0.097,-0.011,-0.018,0.06,-0.075,-0.017,0.022,-0.094,-0.073,-0.041,0.849,-0.019,-0.191,-0.044,-0.012,-0.026,-0.046,0.013,0.181,0.006,-0.105,-0.082,-0.028,-0.014,-0.091,0.118,0.5639999999999999,-0.026,0.068,-0.008,0.403,0.242,-0.055,0.029,0.09,-0.039,-0.118,0.007,0.07099999999999999,0.013,0.035,-0.125,-0.105,0.063,-0.162,-0.173,0.098,-0.06,0.104,-0.095,-0.135,-0.049,-0.114,-0.022,-0.079,-0.06900000000000001,-0.011,-0.056,0.215,-0.008,-0.061,0.056,0.116,0.001,-0.013,-0.06900000000000001,-0.039,0.042,-0.012,-0.01,-0.002,0.027,0.052,-0.051,0.13,-0.039,-0.017,-0.113,0.024,-0.08,0.456,-0.031,0.053,-0.116,-0.455,-0.09,0.026,0.724,-0.159,-0.04,-0.035,-0.016,0.037,-0.056,0.038,-0.064,-0.007,0.035,0.103,-0.06,-0.05,-0.065,-0.064,-0.017,-0.083,0.006,-0.164,0.606,0.135,0.239,0.019,-0.074,-0.081,-0.114,0.023,0.042,-0.075,-0.116,0.061,-0.048,0.022,-0.056,-0.522,-0.164,-0.006,-0.038,0.142,0.022,-0.028,0.018,0.047,0.023,-0.045,-0.014,0.001,-0.034,-0.111,-0.08500000000000001,0.028,-0.041,0.018,-0.075,-0.08599999999999999,-0.029,-0.118,-0.043,-0.018,-0.08500000000000001,-0.077,-0.057,0.042,-0.212,-0.006,-0.05,-0.066,0.467,-0.039,-0.047,-0.145,-0.051,-0.078,0.07099999999999999,-0.042,0.029,-0.016,-0.187,0.061,0.023,0.014,0.024,-0.079,0.003,-0.113,0.064,-0.06900000000000001,-0.063,-0.089,-0.062,-0.132,0.553,0.3,0.012,-0.092,-0.042,-0.134,0.02,-0.029,0.13,-0.008999999999999999,-0.041,0.016,-0.066,0.026,0.075,-0.073,-0.073,-0.06900000000000001,-0.005,-0.311,0.064,-0.07199999999999999,-0.093,0.017,-0.007,-0.134,-0.08400000000000001,0.054,-0.003,0.462,-0.169,-0.08599999999999999,-0.046,-0.048,-0.08599999999999999,-0.06900000000000001,0.036,-0.091,0.114,-0.101,-0.074,-0.131,0.26,-0.108,0.029,0.533,-0.097,0.005,0.485,0.013,-0.059,-0.021,0.496,0.016,-0.006,0.045,0.017,0.04,-0.028,-0.11,-0.08400000000000001,0.034,-0.058,0.077,0.032,-0.033,-0.046,-0.035,-0.015,-0.082,0.008999999999999999,0.021,0.575,-0.018,0.036,0.001,-0.089,-0.08599999999999999,-0.053,0.005,-0.019,-0.032,0.165,0.053,-0.008,0.018,-0.023,-0.032,-0.12,-0.02,-0.121,-0.127,-0.048,-0.034,-0.197,-0.066,-0.089,-0.068,-0.023,-0.056,-0.041,-0.029,0.07099999999999999,-0.127,0.073,0.003,0.03,-0.013,0.037,0.022,-0.143,-0.097,-0.025,-0.079,0.093,-0.066,-0.005,-0.091,-0.104,-0.08799999999999999,0.016,-0.134,-0.029,-0.018,-0.005,-0.007,-0.141,-0.098,0.169,0.37,-0.067,0.131,-0.004,-0.312,-0.101,0.002,0.007,-0.059,-0.082,-0.091,-0.08400000000000001,0.066,-0.076,-0.031,-0.033,-0.013,0.058,-0.053,-0.037,0.797,-0.162,0.207,-0.091,0.288,0.097,-0.098,-0.007,0.104,-0.134,-0.186,-0.03,-0.031,-0.038,0.033,-0.143,-0.042,-0.062,-0.051,-0.137,0.203,-0.054,0.694,-0.01,0.317,-0.003,-0.045,-0.008999999999999999,-0.037,-0.005,0.053,-0.029,0.013,-0.08400000000000001,-0.012,-0.014,-0.01,-0.02,-0.144,0.106,0.211,0.453,-0.038,0.091,-0.073,0.013,0.141,-0.075,-0.141,0.041,0.01,0.122,0.506,-0.048,0.081,-0.146,-0.128,-0.001,-0.184,0.404,-0.253,1.094,0.06900000000000001,-0.047,0.003,-0.149,-0.024,-0.022,-0.036,-0.073,0.154,0.08699999999999999,-0.064,-0.052,-0.111,0.07199999999999999,0.151,-0.142,0.006,0.126,-0.043,-0.031,0.017,-0.021,-0.216,-0.028,0.007,-0.074,0.748,-0.206,0.06,0.055,-0.164,-0.099,0.001,-0.047,-0.183,-0.029,0.062,-0.062,-0.196,0.459,-0.157,0.332,-0.036,-0.058,0.337,-0.119,-0.018,-0.012,-0.127,-0.035,-0.098,0.018,-0.027,0.092,-0.074,-0.306,-0.008,0.008999999999999999,-0.073,0.208,0.027,-0.132,-0.008,-0.188,-0.098,0.07099999999999999,-0.022,0.064,-0.027,-0.106,-0.075,-0.016,-0.237,-0.189,-0.171,-0.06900000000000001,-0.017,-0.02,0.107,-0.193,-0.102,-0.017,0.295,-0.044,-0.055,-0.04,-0.037,0.13,-0.038,-0.111,-0.081,0.109,0.08,0.5669999999999999,-0.074,-0.097,-0.149,0.007,-0.017,0.073,0.073,-0.097,-0.023,-0.031,-0.012,-0.077,-0.049,-0.049,-0.121,-0.083,0.148,-0.059,0.489,-0.029,-0.162,-0.061,-0.106,0.004,0.194,-0.054,-0.097,-0.163,0.427,-0.214,0.256,0.02,0.754,-1.893,-1.694,-1.541,-2.103,-1.987,-0.676,-1.755,0.55,-1.466,0.047,-2.028,-2.34,-0.959,-2.029,-1.369,-0.778,-1.801,-2.133,-2.413,-1.512,1.058,-0.479,0.051,0.616,2.054,-0.647,1.113,0.476,-0.623,0.453,-0.862,2.074,1.147,-0.05,1.619,0.838,0.621,1.232,0.852,1.421,0.623,1.19,-0.487,-1.098,-1.906,-0.542,-0.611,0.674,-0.866,-1.23,-0.775,-1.176,-1.042,-0.839,-1.644,-1.022,-1.461,-0.785,-1.785,-1.505,-1.61,-1.022,0.865],[0,0.977,1.09,0.931,1.029,0.901,1.132,1.166,1.085,1.071,1.191,1.309,1.175,1.265,1.167,1.33,1.23,1.278,1.353,1.345,1.344,1.261,1.419,1.217,1.658,1.603,1.647,1.684,1.85,1.654,1.586,0.519,0.366,0.636,0.486,0.418,0.291,0.433,0.457,0.394,0.343,0.598,0.572,0.699,0.501,0.492,0.382,0.609,0.581,0.764,0.237,0.258,0.711,0.767,0.831,0.851,0.732,0.73,0.706,0.719,0.726,0.776,0.782,0.694,0.681,0.776,0.759,0.746,0.873,0.752,0.753,0.642,0.74,0.676,0.83,0.824,0.904,0.725,0.723,0.721,0.5659999999999999,0.892,0.772,0.836,0.733,0.777,0.797,0.766,0.793,0.762,0.797,0.737,0.8129999999999999,0.863,0.599,0.8139999999999999,0.821,0.595,0.784,0.666,0.787,0.734,0.8120000000000001,0.719,0.786,0.91,0.792,0.821,0.8,0.663,0.841,0.715,0.749,0.791,0.756,0.844,0.708,0.738,0.523,0.872,0.79,0.764,0.778,0.828,0.644,0.77,0.8169999999999999,0.778,0.797,0.75,0.835,0.8100000000000001,0.649,0.8,0.703,0.732,0.584,0.659,0.82,0.735,0.8,0.695,0.783,0.705,0.824,0.824,0.728,0.899,0.771,0.716,0.799,0.742,0.628,0.776,0.704,0.739,0.896,0.786,0.8179999999999999,0.888,0.735,0.763,0.8139999999999999,0.842,0.796,0.752,0.6840000000000001,0.789,0.869,0.74,0.721,0.758,0.792,0.651,0.802,0.8080000000000001,0.777,0.778,0.857,0.734,0.909,0.8090000000000001,0.8100000000000001,0.88,0.8129999999999999,0.723,0.6870000000000001,0.773,0.805,0.714,0.642,0.8159999999999999,0.882,0.632,0.76,0.75,0.853,0.787,0.744,0.731,0.771,0.753,0.8120000000000001,0.822,0.6909999999999999,0.8179999999999999,0.775,0.754,0.722,0.786,0.677,0.766,0.766,0.68,0.801,0.6840000000000001,0.8129999999999999,0.737,0.705,0.8110000000000001,0.906,0.791,0.706,0.774,0.6860000000000001,0.745,0.704,0.707,0.648,0.646,0.8120000000000001,0.8149999999999999,0.647,0.762,0.737,0.801,0.776,0.751,0.768,0.783,0.774,0.8129999999999999,0.695,0.704,0.8080000000000001,0.71,0.605,0.792,0.779,0.836,0.738,0.706,0.771,0.709,0.838,0.663,0.72,0.709,0.76,0.839,0.781,0.71,0.763,0.761,0.71,0.8100000000000001,0.5580000000000001,0.715,0.77,0.745,0.793,0.827,0.83,0.893,0.745,0.646,0.779,0.851,0.665,0.755,0.698,0.708,0.827,0.801,0.863,0.653,0.6870000000000001,0.832,0.725,0.574,0.77,0.78,0.8149999999999999,0.6860000000000001,0.82,0.862,0.751,0.755,0.769,0.658,0.703,0.696,0.826,0.769,0.617,0.761,0.791,0.747,0.944,0.78,0.819,0.826,0.8149999999999999,0.724,0.697,0.8090000000000001,0.874,0.707,0.829,0.844,0.6909999999999999,0.705,0.803,0.614,0.897,0.794,0.853,0.648,0.758,0.859,0.6870000000000001,0.882,0.793,0.658,0.78,0.836,0.798,0.668,0.822,0.822,0.789,0.739,0.6929999999999999,0.726,0.74,0.728,0.837,0.715,0.778,0.752,0.806,0.785,0.782,0.804,0.801,0.799,0.752,0.678,0.747,0.858,0.751,0.6909999999999999,0.765,0.806,0.744,0.764,0.876,0.629,0.772,0.723,0.866,0.795,0.777,0.787,0.661,0.786,0.745,0.728,0.732,0.714,0.637,0.836,0.801,0.5629999999999999,0.746,0.79,0.785,0.885,0.767,0.705,0.754,0.6889999999999999,0.723,0.837,0.778,0.76,0.716,0.78,0.761,0.663,0.804,0.8149999999999999,0.766,0.784,0.83,0.85,0.771,0.8149999999999999,0.712,0.716,0.713,0.697,0.8070000000000001,0.667,0.67,0.803,0.645,0.699,0.912,0.773,0.752,0.718,0.806,0.777,0.778,0.739,0.776,0.672,0.841,0.805,0.79,0.837,0.742,0.8159999999999999,0.744,0.821,0.698,0.8169999999999999,0.642,0.663,0.8080000000000001,0.827,0.799,0.917,0.643,0.825,0.802,0.872,0.6820000000000001,0.803,0.777,0.713,0.775,0.826,0.641,0.825,0.663,0.826,0.698,0.8149999999999999,0.675,0.752,0.6899999999999999,0.848,0.724,0.765,0.736,0.839,0.758,0.74,0.737,0.909,0.8159999999999999,0.639,0.681,0.604,0.759,0.725,0.8100000000000001,0.755,0.636,0.8,0.795,0.607,0.799,0.714,0.801,0.743,0.727,0.798,0.822,0.791,0.77,0.644,0.725,0.725,0.766,0.779,0.8139999999999999,0.79,0.773,0.801,0.827,0.694,0.667,0.708,0.6899999999999999,0.739,0.729,0.8149999999999999,0.827,0.85,0.8,0.596,0.764,0.6889999999999999,0.63,0.793,0.728,0.741,0.8,0.824,0.733,0.783,0.797,0.6830000000000001,0.745,0.656,0.783,0.757,0.725,0.8,0.657,0.791,0.616,0.63,0.796,0.6830000000000001,0.711,0.73,0.6889999999999999,0.659,0.782,0.8100000000000001,0.703,0.765,0.766,0.792,0.729,0.631,0.673,0.797,0.8,0.78,0.822,0.652,0.645,0.776,0.733,0.74,0.725,0.835,0.742,0.844,0.868,0.713,0.764,0.668,0.724,0.719,0.663,0.72,0.744,0.6870000000000001,0.769,0.762,0.748,0.806,0.722,0.794,0.859,0.729,0.796,0.743,0.752,0.6889999999999999,0.821,0.6899999999999999,0.806,0.664,0.767,0.8120000000000001,0.749,0.821,0.571,0.68,0.8129999999999999,0.771,0.763,0.775,0.796,0.8070000000000001,0.8169999999999999,0.678,0.755,0.756,0.6919999999999999,0.831,0.63,0.8179999999999999,0.672,0.715,0.8139999999999999,0.696,0.668,0.791,0.798,0.759,0.592,0.742,0.642,0.898,0.189,0.516,0.636,1.015,0.582,0.539,0.321,0.598,0.5600000000000001,0.555,0.451,0.678,0.664,0.805,0.646,0.78,0.543,1.026,0.733,0.958,0.32,0.257,0.628,0.922,0.8090000000000001,0.959,0.71,0.634,0.6889999999999999,0.499,0.715,0.585,1.088,0.667,0.596,0.85,0.774,0.5639999999999999,0.959,0.76,0.9360000000000001,0.366,0.383,0.645,0.582,0.802,0.625,0.6889999999999999,0.576,0.612,0.449,0.608,0.439,0.5639999999999999,0.661,0.5580000000000001,0.556,0.628,0.511,0.801,0.656,0.752,0.318,0.274],[0,0.08,0.089,0.076,0.08400000000000001,0.074,0.092,0.095,0.089,0.08699999999999999,0.097,0.107,0.096,0.103,0.095,0.109,0.1,0.104,0.11,0.11,0.11,0.103,0.116,0.099,0.135,0.131,0.134,0.137,0.151,0.135,0.13,0.042,0.03,0.052,0.04,0.034,0.024,0.035,0.037,0.032,0.028,0.049,0.047,0.057,0.041,0.04,0.031,0.05,0.047,0.062,0.019,0.021,0.058,0.063,0.068,0.06900000000000001,0.06,0.06,0.058,0.059,0.059,0.063,0.064,0.057,0.056,0.063,0.062,0.061,0.07099999999999999,0.061,0.061,0.052,0.06,0.055,0.068,0.067,0.074,0.059,0.059,0.059,0.046,0.073,0.063,0.068,0.06,0.063,0.065,0.063,0.065,0.062,0.065,0.06,0.066,0.07000000000000001,0.049,0.066,0.067,0.049,0.064,0.054,0.064,0.06,0.066,0.059,0.064,0.074,0.065,0.067,0.065,0.054,0.06900000000000001,0.058,0.061,0.065,0.062,0.06900000000000001,0.058,0.06,0.043,0.07099999999999999,0.064,0.062,0.064,0.068,0.053,0.063,0.067,0.063,0.065,0.061,0.068,0.066,0.053,0.065,0.057,0.06,0.048,0.054,0.067,0.06,0.065,0.057,0.064,0.058,0.067,0.067,0.059,0.073,0.063,0.058,0.065,0.061,0.051,0.063,0.057,0.06,0.073,0.064,0.067,0.073,0.06,0.062,0.066,0.06900000000000001,0.065,0.061,0.056,0.064,0.07099999999999999,0.06,0.059,0.062,0.065,0.053,0.065,0.066,0.063,0.064,0.07000000000000001,0.06,0.074,0.066,0.066,0.07199999999999999,0.066,0.059,0.056,0.063,0.066,0.058,0.052,0.067,0.07199999999999999,0.052,0.062,0.061,0.07000000000000001,0.064,0.061,0.06,0.063,0.062,0.066,0.067,0.056,0.067,0.063,0.062,0.059,0.064,0.055,0.063,0.063,0.056,0.065,0.056,0.066,0.06,0.058,0.066,0.074,0.065,0.058,0.063,0.056,0.061,0.057,0.058,0.053,0.053,0.066,0.067,0.053,0.062,0.06,0.065,0.063,0.061,0.063,0.064,0.063,0.066,0.057,0.057,0.066,0.058,0.049,0.065,0.064,0.068,0.06,0.058,0.063,0.058,0.068,0.054,0.059,0.058,0.062,0.06900000000000001,0.064,0.058,0.062,0.062,0.058,0.066,0.046,0.058,0.063,0.061,0.065,0.068,0.068,0.073,0.061,0.053,0.064,0.07000000000000001,0.054,0.062,0.057,0.058,0.068,0.065,0.07099999999999999,0.053,0.056,0.068,0.059,0.047,0.063,0.064,0.067,0.056,0.067,0.07000000000000001,0.061,0.062,0.063,0.054,0.057,0.057,0.067,0.063,0.05,0.062,0.065,0.061,0.077,0.064,0.067,0.067,0.067,0.059,0.057,0.066,0.07099999999999999,0.058,0.068,0.06900000000000001,0.056,0.058,0.066,0.05,0.073,0.065,0.07000000000000001,0.053,0.062,0.07000000000000001,0.056,0.07199999999999999,0.065,0.054,0.064,0.068,0.065,0.055,0.067,0.067,0.064,0.06,0.057,0.059,0.06,0.059,0.068,0.058,0.063,0.061,0.066,0.064,0.064,0.066,0.065,0.065,0.061,0.055,0.061,0.07000000000000001,0.061,0.056,0.062,0.066,0.061,0.062,0.07199999999999999,0.051,0.063,0.059,0.07099999999999999,0.065,0.063,0.064,0.054,0.064,0.061,0.059,0.06,0.058,0.052,0.068,0.065,0.046,0.061,0.065,0.064,0.07199999999999999,0.063,0.058,0.062,0.056,0.059,0.068,0.064,0.062,0.058,0.064,0.062,0.054,0.066,0.067,0.063,0.064,0.068,0.06900000000000001,0.063,0.067,0.058,0.058,0.058,0.057,0.066,0.054,0.055,0.066,0.053,0.057,0.074,0.063,0.061,0.059,0.066,0.063,0.064,0.06,0.063,0.055,0.06900000000000001,0.066,0.064,0.068,0.061,0.067,0.061,0.067,0.057,0.067,0.052,0.054,0.066,0.068,0.065,0.075,0.053,0.067,0.065,0.07099999999999999,0.056,0.066,0.063,0.058,0.063,0.067,0.052,0.067,0.054,0.067,0.057,0.067,0.055,0.061,0.056,0.06900000000000001,0.059,0.062,0.06,0.068,0.062,0.06,0.06,0.074,0.067,0.052,0.056,0.049,0.062,0.059,0.066,0.062,0.052,0.065,0.065,0.05,0.065,0.058,0.065,0.061,0.059,0.065,0.067,0.065,0.063,0.053,0.059,0.059,0.063,0.064,0.067,0.065,0.063,0.065,0.068,0.057,0.054,0.058,0.056,0.06,0.059,0.067,0.068,0.06900000000000001,0.065,0.049,0.062,0.056,0.051,0.065,0.059,0.06,0.065,0.067,0.06,0.064,0.065,0.056,0.061,0.054,0.064,0.062,0.059,0.065,0.054,0.065,0.05,0.051,0.065,0.056,0.058,0.06,0.056,0.054,0.064,0.066,0.057,0.062,0.063,0.065,0.06,0.051,0.055,0.065,0.065,0.064,0.067,0.053,0.053,0.063,0.06,0.06,0.059,0.068,0.061,0.06900000000000001,0.07099999999999999,0.058,0.062,0.055,0.059,0.059,0.054,0.059,0.061,0.056,0.063,0.062,0.061,0.066,0.059,0.065,0.07000000000000001,0.059,0.065,0.061,0.061,0.056,0.067,0.056,0.066,0.054,0.063,0.066,0.061,0.067,0.047,0.056,0.066,0.063,0.062,0.063,0.065,0.066,0.067,0.055,0.062,0.062,0.057,0.068,0.051,0.067,0.055,0.058,0.066,0.057,0.055,0.065,0.065,0.062,0.048,0.061,0.052,0.073,0.015,0.042,0.052,0.083,0.048,0.044,0.026,0.049,0.046,0.045,0.037,0.055,0.054,0.066,0.053,0.064,0.044,0.08400000000000001,0.06,0.078,0.026,0.021,0.051,0.075,0.066,0.078,0.058,0.052,0.056,0.041,0.058,0.048,0.089,0.054,0.049,0.06900000000000001,0.063,0.046,0.078,0.062,0.076,0.03,0.031,0.053,0.048,0.065,0.051,0.056,0.047,0.05,0.037,0.05,0.036,0.046,0.054,0.046,0.045,0.051,0.042,0.065,0.054,0.061,0.026,0.022],[0,0.114,0.183,0.076,0.096,0.074,0.092,0.1,0.143,0.092,0.106,0.129,0.112,0.119,0.095,0.119,0.101,0.11,0.121,0.108,0.122,0.103,0.138,0.102,0.173,0.154,0.225,0.207,0.198,0.208,0.206,0.042,0.03,0.067,0.04,0.032,0.021,0.037,0.034,0.031,0.028,0.049,0.047,0.057,0.044,0.04,0.031,0.047,0.048,0.058,0.019,0.017,0.058,0.062,0.062,0.06900000000000001,0.06,0.06900000000000001,0.058,0.059,0.056,0.078,0.07099999999999999,0.053,0.062,0.051,0.059,0.059,0.07000000000000001,0.068,0.135,0.07099999999999999,0.049,0.061,0.067,0.067,0.07000000000000001,0.055,0.064,0.059,0.063,0.06,0.066,0.06900000000000001,0.06900000000000001,0.058,0.073,0.063,0.064,0.051,0.07099999999999999,0.06,0.073,0.066,0.053,0.064,0.066,0.049,0.06,0.076,0.074,0.058,0.067,0.052,0.057,0.067,0.065,0.067,0.062,0.044,0.055,0.053,0.061,0.07199999999999999,0.062,0.063,0.08500000000000001,0.056,0.041,0.07000000000000001,0.07099999999999999,0.058,0.057,0.061,0.052,0.063,0.065,0.06900000000000001,0.063,0.058,0.068,0.078,0.068,0.056,0.058,0.057,0.049,0.052,0.06,0.06,0.066,0.057,0.07099999999999999,0.057,0.061,0.075,0.056,0.073,0.067,0.058,0.062,0.061,0.051,0.07000000000000001,0.058,0.044,0.073,0.064,0.067,0.065,0.06,0.042,0.066,0.064,0.065,0.045,0.056,0.058,0.063,0.064,0.058,0.062,0.057,0.048,0.07000000000000001,0.056,0.064,0.059,0.061,0.054,0.074,0.06,0.063,0.07199999999999999,0.061,0.055,0.056,0.07199999999999999,0.066,0.051,0.043,0.067,0.07199999999999999,0.08,0.051,0.062,0.068,0.064,0.056,0.059,0.058,0.065,0.067,0.067,0.062,0.067,0.07000000000000001,0.052,0.049,0.06,0.051,0.055,0.059,0.118,0.066,0.056,0.074,0.054,0.052,0.063,0.058,0.063,0.066,0.057,0.056,0.06,0.058,0.052,0.053,0.049,0.062,0.067,0.052,0.061,0.056,0.066,0.063,0.062,0.053,0.063,0.059,0.067,0.053,0.046,0.076,0.054,0.05,0.054,0.058,0.068,0.066,0.055,0.058,0.055,0.065,0.054,0.046,0.058,0.061,0.068,0.064,0.058,0.063,0.062,0.058,0.066,0.049,0.044,0.058,0.061,0.052,0.081,0.065,0.07199999999999999,0.056,0.045,0.057,0.063,0.047,0.058,0.052,0.059,0.064,0.064,0.07099999999999999,0.053,0.056,0.058,0.058,0.047,0.063,0.064,0.061,0.056,0.056,0.064,0.062,0.055,0.054,0.06,0.051,0.057,0.059,0.051,0.051,0.059,0.056,0.063,0.076,0.064,0.083,0.064,0.055,0.063,0.063,0.06,0.07099999999999999,0.062,0.063,0.066,0.055,0.057,0.095,0.043,0.102,0.064,0.07000000000000001,0.059,0.08799999999999999,0.07000000000000001,0.061,0.075,0.065,0.101,0.07099999999999999,0.068,0.074,0.054,0.067,0.067,0.065,0.06,0.063,0.067,0.058,0.06,0.068,0.044,0.065,0.062,0.061,0.055,0.054,0.07099999999999999,0.065,0.055,0.058,0.055,0.059,0.099,0.056,0.05,0.056,0.06,0.083,0.062,0.073,0.059,0.062,0.054,0.066,0.068,0.062,0.042,0.043,0.06,0.07199999999999999,0.051,0.042,0.047,0.052,0.055,0.062,0.042,0.061,0.064,0.059,0.074,0.056,0.05,0.065,0.057,0.067,0.068,0.064,0.052,0.044,0.063,0.058,0.054,0.066,0.067,0.064,0.063,0.049,0.064,0.049,0.056,0.06,0.042,0.045,0.056,0.08500000000000001,0.046,0.054,0.061,0.052,0.059,0.105,0.056,0.07000000000000001,0.048,0.066,0.078,0.064,0.077,0.063,0.044,0.075,0.061,0.059,0.06900000000000001,0.059,0.067,0.073,0.07000000000000001,0.043,0.06900000000000001,0.052,0.043,0.062,0.064,0.064,0.07199999999999999,0.052,0.09,0.054,0.068,0.06900000000000001,0.059,0.063,0.052,0.045,0.068,0.064,0.06900000000000001,0.062,0.068,0.056,0.076,0.055,0.062,0.05,0.062,0.055,0.049,0.05,0.074,0.062,0.06,0.066,0.067,0.07099999999999999,0.052,0.048,0.055,0.058,0.048,0.061,0.063,0.046,0.061,0.075,0.05,0.056,0.059,0.065,0.049,0.073,0.066,0.067,0.065,0.083,0.059,0.06,0.118,0.058,0.07099999999999999,0.06,0.06,0.064,0.065,0.062,0.057,0.06,0.067,0.056,0.066,0.051,0.066,0.056,0.055,0.065,0.054,0.047,0.056,0.051,0.064,0.06,0.055,0.055,0.053,0.121,0.067,0.079,0.056,0.061,0.061,0.061,0.077,0.059,0.057,0.054,0.079,0.045,0.051,0.06,0.063,0.063,0.073,0.056,0.054,0.059,0.07000000000000001,0.05,0.062,0.065,0.07199999999999999,0.06,0.053,0.053,0.078,0.059,0.064,0.089,0.053,0.049,0.064,0.06,0.048,0.06,0.068,0.061,0.06,0.07099999999999999,0.079,0.051,0.048,0.058,0.059,0.053,0.07199999999999999,0.06,0.051,0.067,0.061,0.049,0.061,0.054,0.064,0.057,0.053,0.055,0.063,0.077,0.053,0.07000000000000001,0.053,0.054,0.07199999999999999,0.063,0.067,0.05,0.067,0.043,0.046,0.063,0.063,0.054,0.059,0.06,0.066,0.057,0.051,0.062,0.056,0.055,0.068,0.075,0.063,0.049,0.058,0.073,0.057,0.063,0.06,0.056,0.062,0.054,0.057,0.048,0.073,0.063,0.047,0.068,0.107,0.048,0.042,0.042,0.052,0.053,0.053,0.046,0.066,0.048,0.076,0.06,0.111,0.06,0.114,0.058,0.078,0.041,0.027,0.055,0.09,0.074,0.112,0.058,0.067,0.062,0.043,0.07000000000000001,0.045,0.131,0.054,0.042,0.075,0.063,0.042,0.097,0.062,0.08500000000000001,0.039,0.052,0.08500000000000001,0.068,0.081,0.058,0.08400000000000001,0.054,0.06,0.048,0.057,0.047,0.046,0.08500000000000001,0.059,0.043,0.067,0.046,0.111,0.076,0.082,0.031,0.034]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="quadratic-covariate-effects">Quadratic covariate effects<a class="anchor" aria-label="anchor" href="#quadratic-covariate-effects"></a>
</h3>
<p>The easiest way to include quadratic effects is by squaring the
covariate and including it as a new covariate. The plot_* and predict
methods will be able to identify the quadratic term via a required
keyword (the suffix “_squared” by default).</p>
<p>Covariates should be scaled to prior to squaring (“habitat” in this
examples is already scaled).</p>
<p>Create quadratic covariate:</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_AHM</span><span class="op">$</span><span class="va">siteCovs</span><span class="op">$</span><span class="va">habitat_squared</span> <span class="op">&lt;-</span> <span class="va">input_AHM</span><span class="op">$</span><span class="va">siteCovs</span><span class="op">$</span><span class="va">habitat</span> <span class="op">^</span><span class="fl">2</span></span></code></pre></div>
<p>Create and fit model:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_quadratic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">model1_jags_quadratic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span>, <span class="st">"habitat_squared"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_quadratic</span>,</span>
<span>  keyword_quadratic <span class="op">=</span> <span class="st">"_squared"</span><span class="op">)</span>   <span class="co"># this is the default, added for clarity</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_quadratic</span><span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_quadratic</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">10000</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Thanks to to keyword “_squared” in the covariate name,
<code>plot_effects</code> knows that “habitat” and “habitat_squared” are
the same covariate and will combine the effects of “habitat” and
“habitat_squared” in response curves. If a different keyword was used,
set the parameter “keyword_quadratic” accordingly (it defaults to
“_squared”).</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_jags_quadratic</span>, </span>
<span>             <span class="va">out_ahm_jags_quadratic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-68-1.png" width="700"></p>
<p>The simulated data have no quadratic relationship with covariates,
hence the quadratic effects are rather weak in this example.</p>
</div>
<div class="section level3">
<h3 id="waic">WAIC<a class="anchor" aria-label="anchor" href="#waic"></a>
</h3>
<p>Nimble models can return WAIC. Set argument
<code>fit(..., WAIC = TRUE)</code>.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_ahm_nimble3</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_nimble</span>, </span>
<span>                       n.iter <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                       n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                       thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                       chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       compile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       quiet <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                       WAIC <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The message about “individual pWAIC values that are greater than 0.4”
in the example is likely due to the short model run.</p>
<p>If <code>WAIC = TRUE</code>, the output will be a list with 2
elements. The first (“samples”) is the familiar mcmc.list, the second
(“WAIC”) is a waicList.</p>
<p>mcmc.list is accessible with $samples:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># not printed here</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_nimble3</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span></span></code></pre></div>
<p>WAIC:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_ahm_nimble3</span><span class="op">$</span><span class="va">WAIC</span></span></code></pre></div>
<pre><code><span><span class="co">## nimbleList object of type waicNimbleList</span></span>
<span><span class="co">## Field "WAIC":</span></span>
<span><span class="co">## [1] 1071.5</span></span>
<span><span class="co">## Field "lppd":</span></span>
<span><span class="co">## [1] -490.7924</span></span>
<span><span class="co">## Field "pWAIC":</span></span>
<span><span class="co">## [1] 44.95773</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="species-richness">Species richness<a class="anchor" aria-label="anchor" href="#species-richness"></a>
</h3>
<div class="section level4">
<h4 id="global">Global<a class="anchor" aria-label="anchor" href="#global"></a>
</h4>
<p>Global species richness estimates is returned in parameter “Nspecies”
(see below).</p>
</div>
<div class="section level4">
<h4 id="by-station">By station<a class="anchor" aria-label="anchor" href="#by-station"></a>
</h4>
<p>Species richness by station is returned in parameter
“Nspecies_station” (see below).</p>
</div>
<div class="section level4">
<h4 id="richness-estimates-for-categorical-covariates">Richness estimates for categorical covariates<a class="anchor" aria-label="anchor" href="#richness-estimates-for-categorical-covariates"></a>
</h4>
<p>This is only possible in JAGS models. Argument “richnessCategories”
can be used to calculate separate species richness estimates for
different levels of categorical site covariates. If it is not defined,
there will only be global and by-station species richness estimates.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_richness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_richness</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  richnessCategories <span class="op">=</span> <span class="st">"categ"</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_richness</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_rich</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_richness</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now search for “Nspecies” in the table below. You will see entries
for three different parameters.</p>
<ul>
<li>“Nspecies” is overall species richness,</li>
<li>“Nspecies_by_category[1]”, “…[2]” and “…[3]” are for the stations in
category “medium” and “low”, “high” respectively.</li>
<li>“Nspecies_by_station[1]” to “…[30]” are species richness estimates
for each sampling station.</li>
</ul>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_rich</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f432fb6e650d619481b2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f432fb6e650d619481b2">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_categ[1]","Nspecies_categ[2]","Nspecies_categ[3]","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat[1]","beta.ranef.cont.habitat[2]","beta.ranef.cont.habitat[3]","beta.ranef.cont.habitat[4]","beta.ranef.cont.habitat[5]","beta.ranef.cont.habitat[6]","beta.ranef.cont.habitat[7]","beta.ranef.cont.habitat[8]","beta.ranef.cont.habitat[9]","beta.ranef.cont.habitat[10]","beta.ranef.cont.habitat[11]","beta.ranef.cont.habitat[12]","beta.ranef.cont.habitat[13]","beta.ranef.cont.habitat[14]","beta.ranef.cont.habitat[15]","beta.ranef.cont.habitat[16]","beta.ranef.cont.habitat[17]","beta.ranef.cont.habitat[18]","beta.ranef.cont.habitat[19]","beta.ranef.cont.habitat.mean","beta.ranef.cont.habitat.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,14.567,18.08,14.507,3.013,3.947,3.72,4.84,3.647,4.04,2.253,3.78,4.86,4.84,3.1,2.967,5.12,5.087,5.227,3.233,4.26,4.153,2.213,4.293,6.3,4.327,7.953,5.18,5.073,6.98,5.087,5.54,5.807,8.880000000000001,1.082,0.037,-0.101,-0.217,0.252,-0.825,-0.573,-0.921,-0.325,0.167,0.6840000000000001,0.293,-1.181,-0.89,-0.5580000000000001,-0.025,-0.758,-0.6,-0.426,-0.258,0.785,-1.534,-1.203,-0.792,-1.745,-1.634,-0.512,-1.31,0.75,-1.104,0.267,-1.816,-2.046,-0.632,-1.82,-1.001,-0.474,-1.445,-1.771,-1.918,-1.148,0.971,-0.404,0.133,0.723,1.987,-0.575,0.984,0.39,-0.631,0.358,-0.772,2.031,0.9389999999999999,-0.03,1.49,0.82,0.455,0.947,0.657,1.173,0.526,1.057,-0.797,-1.421,-2.172,-0.776,-0.805,0.392,-1.205,-1.28,-1.098,-1.22,-1.171,-1.093,-1.867,-1.113,-1.619,-1.075,-2.027,-1.544,-1.911,-1.245,0.8080000000000001],[0,1.155,0.671,1.225,0.912,0.873,0.795,0.963,0.778,0.9399999999999999,0.971,0.889,0.927,0.828,0.975,1.013,0.962,1.117,1.063,1.108,0.993,1.035,1.139,1.096,0.954,1.179,0.838,1.27,1.443,1.184,1.419,1.427,1.364,1.341,0.497,0.419,0.636,0.413,0.337,0.255,0.414,0.439,0.347,0.34,0.591,0.609,0.651,0.459,0.5580000000000001,0.362,0.6860000000000001,0.471,0.656,0.239,0.277,0.426,0.551,0.848,0.436,0.483,0.243,0.546,0.376,0.48,0.359,0.5629999999999999,0.586,0.607,0.622,0.604,0.38,0.872,0.8120000000000001,0.844,0.309,0.218,0.521,0.644,0.732,1.049,0.578,0.571,0.548,0.486,0.585,0.455,0.899,0.754,0.538,0.833,0.63,0.5610000000000001,0.792,0.706,0.84,0.325,0.37,0.484,0.5580000000000001,0.646,0.552,0.611,0.5,0.547,0.439,0.507,0.362,0.527,0.594,0.546,0.545,0.662,0.412,0.674,0.659,0.8,0.276,0.253],[0,0.094,0.055,0.1,0.074,0.07099999999999999,0.065,0.079,0.064,0.077,0.079,0.073,0.076,0.068,0.08,0.083,0.079,0.091,0.08699999999999999,0.09,0.081,0.08400000000000001,0.093,0.09,0.078,0.096,0.068,0.104,0.118,0.097,0.116,0.116,0.111,0.109,0.041,0.034,0.052,0.034,0.028,0.021,0.034,0.036,0.028,0.028,0.048,0.05,0.053,0.037,0.046,0.03,0.056,0.038,0.054,0.02,0.023,0.035,0.045,0.06900000000000001,0.036,0.039,0.02,0.045,0.031,0.039,0.029,0.046,0.048,0.05,0.051,0.049,0.031,0.07099999999999999,0.066,0.06900000000000001,0.025,0.018,0.043,0.053,0.06,0.08599999999999999,0.047,0.047,0.045,0.04,0.048,0.037,0.073,0.062,0.044,0.068,0.051,0.046,0.065,0.058,0.06900000000000001,0.027,0.03,0.04,0.046,0.053,0.045,0.05,0.041,0.045,0.036,0.041,0.03,0.043,0.049,0.045,0.044,0.054,0.034,0.055,0.054,0.065,0.023,0.021],[0,0.106,0.06900000000000001,0.101,0.075,0.093,0.08799999999999999,0.06900000000000001,0.07000000000000001,0.075,0.06900000000000001,0.073,0.125,0.068,0.08500000000000001,0.08400000000000001,0.08699999999999999,0.091,0.08699999999999999,0.109,0.081,0.083,0.1,0.105,0.08699999999999999,0.096,0.068,0.104,0.171,0.097,0.116,0.114,0.112,0.145,0.049,0.032,0.052,0.052,0.027,0.022,0.039,0.034,0.025,0.028,0.051,0.042,0.053,0.048,0.045,0.038,0.053,0.039,0.05,0.019,0.04,0.03,0.044,0.074,0.036,0.043,0.022,0.048,0.029,0.039,0.029,0.051,0.054,0.049,0.066,0.049,0.031,0.083,0.066,0.083,0.034,0.02,0.043,0.08699999999999999,0.054,0.125,0.054,0.053,0.037,0.037,0.046,0.041,0.104,0.073,0.044,0.08699999999999999,0.058,0.034,0.065,0.05,0.061,0.026,0.05,0.044,0.043,0.061,0.049,0.058,0.041,0.053,0.04,0.041,0.029,0.05,0.048,0.046,0.045,0.049,0.03,0.051,0.064,0.075,0.022,0.021]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level3">
<h3 id="spatial-predictions">Spatial predictions<a class="anchor" aria-label="anchor" href="#spatial-predictions"></a>
</h3>
<p>You can create spatial predictions based on the occupancy models
created with <code>communityModel</code>, their model fits and covariate
rasters.</p>
<p>This requires the terra package.</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<p>For demonstration we will use a model that has both a continuous and
a categorical covariate.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_categ3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_jags_categ3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span>, </span>
<span>                            <span class="st">"categ"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_categ3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># short model run for demonstration</span></span>
<span><span class="va">out_ahm_jags_categ3</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model_jags_categ3</span>, </span>
<span>                         n.iter <span class="op">=</span> <span class="fl">500</span>, </span>
<span>                         n.burnin <span class="op">=</span> <span class="fl">250</span>,</span>
<span>                         thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                         chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Create a habitat raster</strong>. We’ll use the volcano
raster for demonstration. The coordinates are not geographic though
since this is only for demonstration.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"volcano"</span><span class="op">)</span></span>
<span><span class="va">r_volcano</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Create a categorical raster</strong>. Since it is not
possible to have categorical raster (with data type “factor”), the
raster must consist of integer numbers that refer to the factor levels
(as defined in the model input).</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/factors.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">input_AHM</span><span class="op">$</span><span class="va">siteCovs</span><span class="op">$</span><span class="va">categ</span><span class="op">)</span>    <span class="co"># show the order of factor levels, first one is reference</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "medium" "low"    "high"</span></span></code></pre>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raster_categ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r_volcano</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, </span>
<span>                                  ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">r_volcano</span><span class="op">)</span>,</span>
<span>                                  nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">r_volcano</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add raster to list</span></span>
<span><span class="va">stack_prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>habitat <span class="op">=</span> <span class="va">r_volcano</span>,</span>
<span>                                 categ <span class="op">=</span> <span class="va">raster_categ</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stack_prediction</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-78-1.png" width="700"></p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># raster categ, from west to east: 1 = medium, 2 = low, 3 = high</span></span></code></pre></div>
<p>Species occupancy maps:</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># species occupancy estimates</span></span>
<span>  <span class="va">predictions_psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object    <span class="op">=</span> <span class="va">model_jags_categ3</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ3</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"psi"</span>,</span>
<span>                             draws     <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## draws (1000) is greater than the number of available samples (150).</span></span></code></pre>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictions_psi</span><span class="op">$</span><span class="va">mean</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, </span>
<span>       maxnl <span class="op">=</span> <span class="fl">9</span>,   <span class="co"># plotting only the first 9 species for space reasons</span></span>
<span>       asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-79-1.png" width="700"></p>
<p>Species richness maps:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># species richness estimates</span></span>
<span>  <span class="va">predictions_rich</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object   <span class="op">=</span> <span class="va">model_jags_categ3</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ3</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"richness"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictions_rich</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-80-1.png" width="700"></p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># mean = mean species richness estimate</span></span>
<span>  <span class="co"># sd = standard deviation of richness estimate</span></span></code></pre></div>
<p>In these examples we did not return confidence intervals. Doing so
would be easy by setting <code>intervals =  "confidence"</code>.</p>
<p>Computation can take long on larger rasters and can require lots of
RAM. Check RAM usage during computations. Parameter “batch” can help
reduce memory load.</p>
</div>
<div class="section level3">
<h3 id="percentage-of-area-occupied-by-species">Percentage of area occupied (by species)<a class="anchor" aria-label="anchor" href="#percentage-of-area-occupied-by-species"></a>
</h3>
<p>The <code>predict</code> function can be used to calculate Percentage
of Area Occupied (PAO) for all species, optionally for a given area of
interest (AOI).</p>
<p>For demonstration, let’s create a AOI as a simple feature (from the
sf package) Normally you’d just load a shapefile or other spatial vector
data set.</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sr1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">70</span>, <span class="fl">80</span>, <span class="fl">40</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"My AOI"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">Sr1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_volcano</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>   <span class="co"># easier plotting via SpatVect object from terra </span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-82-1.png" width="700"></p>
<p>To use the vector layer as an AOI, we need to rasterize it. PAO will
refer to all cells in the AOI raster that are not NA.</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rasterize.html" class="external-link">rasterize</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="va">r_volcano</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_aoi</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-83-1.png" width="700"></p>
<p>Now the prediction of PAO:</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">predictions_pao</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object    <span class="op">=</span> <span class="va">model_jags_categ3</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_categ3</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"pao"</span>, </span>
<span>                             aoi       <span class="op">=</span> <span class="va">r_aoi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No id variables; using all as measure variables</span></span>
<span><span class="co">## No id variables; using all as measure variables</span></span></code></pre>
<p>Output is a list with several components:</p>
<p>$pao_summary is a summary table with quantiles of predicted PAO for
all species.</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions_pao</span><span class="op">$</span><span class="va">pao_summary</span></span></code></pre></div>
<pre><code><span><span class="co">##       Min. lower.ci.0.025 1st Qu. Median  Mean 3rd Qu. upper.ci.0.975  Max.</span></span>
<span><span class="co">## sp1  0.027          0.053   0.132  0.243 0.308   0.450          0.797 0.919</span></span>
<span><span class="co">## sp2  0.020          0.047   0.142  0.286 0.326   0.488          0.777 0.900</span></span>
<span><span class="co">## sp3  0.013          0.026   0.115  0.271 0.312   0.495          0.780 0.826</span></span>
<span><span class="co">## sp4  0.130          0.230   0.659  0.786 0.740   0.881          0.945 0.966</span></span>
<span><span class="co">## sp5  0.031          0.049   0.129  0.227 0.288   0.431          0.669 0.741</span></span>
<span><span class="co">## sp6  0.167          0.388   0.698  0.841 0.786   0.900          0.973 0.983</span></span>
<span><span class="co">## sp7  0.063          0.084   0.278  0.421 0.443   0.604          0.820 0.910</span></span>
<span><span class="co">## sp8  0.014          0.027   0.089  0.164 0.209   0.277          0.583 0.664</span></span>
<span><span class="co">## sp9  0.043          0.099   0.289  0.404 0.448   0.643          0.826 0.867</span></span>
<span><span class="co">## sp10 0.011          0.034   0.080  0.148 0.177   0.238          0.508 0.653</span></span>
<span><span class="co">## sp11 0.083          0.157   0.590  0.731 0.687   0.823          0.911 0.973</span></span>
<span><span class="co">## sp12 0.050          0.086   0.373  0.575 0.542   0.735          0.885 0.943</span></span>
<span><span class="co">## sp13 0.017          0.026   0.069  0.141 0.199   0.294          0.627 0.701</span></span>
<span><span class="co">## sp14 0.074          0.112   0.410  0.611 0.581   0.771          0.898 0.936</span></span>
<span><span class="co">## sp15 0.047          0.067   0.201  0.389 0.400   0.587          0.796 0.856</span></span>
<span><span class="co">## sp16 0.091          0.101   0.313  0.492 0.478   0.645          0.814 0.890</span></span>
<span><span class="co">## sp18 0.006          0.030   0.170  0.375 0.378   0.567          0.839 0.914</span></span>
<span><span class="co">## sp19 0.007          0.035   0.177  0.355 0.365   0.517          0.829 0.913</span></span>
<span><span class="co">## sp20 0.030          0.061   0.232  0.454 0.446   0.657          0.834 0.917</span></span></code></pre>
<p>$pao_matrix contains the PAO estimates for all species from all
posterior draws (not shown here)</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions_pao</span><span class="op">$</span><span class="va">pao_matrix</span></span></code></pre></div>
<p>$pao_df is similar to $pao_matrix, but in a data frame in long
format, ready for use in ggplot2.</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">predictions_pao</span><span class="op">$</span><span class="va">pao_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span> , y <span class="op">=</span> <span class="va">PAO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-87-1.png" width="700"></p>
<p>$aoi is a raster layer (SpatRaster) showing the AOI (now with cells
removed that are NA in the prediction rasters)</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictions_pao</span><span class="op">$</span><span class="va">aoi</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-88-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="bayesplot">bayesplot<a class="anchor" aria-label="anchor" href="#bayesplot"></a>
</h3>
<p>We can also use the powerful bayesplot package for visualizing model
estimates. One downside is that it won’t automatically insert the
species names.</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span></code></pre></div>
<p>Here is an example for density plots showing the species-level
effects of habitat on occupancy:</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html" class="external-link">mcmc_areas</a></span><span class="op">(</span><span class="va">out_ahm_nimble2</span>, regex_pars <span class="op">=</span> <span class="st">"beta.ranef.cont.habitat"</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-90-1.png" width="700"></p>
<p>bayesplot has many other visualization options beyond this example.
See the respective documentation, e.g. <a href="https://mc-stan.org/bayesplot/" class="external-link uri">https://mc-stan.org/bayesplot/</a>.</p>
</div>
<div class="section level3">
<h3 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h3>
<p>Output of <code>fit()</code> is a coda::mcmc.list, so
<code><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot()</a></code> provides traceplots (not shown here for space
reasons):</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_ahm_nimble2</span><span class="op">)</span></span></code></pre></div>
<p>The Gelman-Rubin convergence statistic (potential scale reduction
factor) can be calculated with <code>gelman.diag()</code> from
<code>coda</code>:</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gd</span> <span class="op">&lt;-</span> <span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.diag.html" class="external-link">gelman.diag</a></span><span class="op">(</span><span class="va">out_ahm_nimble2</span>,  multivariate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">gd</span></span></code></pre></div>
<pre><code><span><span class="co">## Potential scale reduction factors:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                                 Point est. Upper C.I.</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[1]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[2]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[3]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[4]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[5]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[6]          1.00       1.01</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[7]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[8]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[9]          1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[10]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[11]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[12]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[13]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[14]         1.01       1.02</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[15]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[16]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[17]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[18]         1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind[19]         1.00       1.01</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind.mean        1.00       1.00</span></span>
<span><span class="co">## alpha.obs.ranef.cont.wind.sigma       1.00       1.01</span></span>
<span><span class="co">## alpha0[1]                             1.00       1.01</span></span>
<span><span class="co">## alpha0[2]                             1.00       1.01</span></span>
<span><span class="co">## alpha0[3]                             1.00       1.00</span></span>
<span><span class="co">## alpha0[4]                             1.00       1.01</span></span>
<span><span class="co">## alpha0[5]                             1.00       1.00</span></span>
<span><span class="co">## alpha0[6]                             1.00       1.00</span></span>
<span><span class="co">## alpha0[7]                             1.00       1.00</span></span>
<span><span class="co">## alpha0[8]                             1.01       1.02</span></span>
<span><span class="co">## alpha0[9]                             1.00       1.00</span></span>
<span><span class="co">## alpha0[10]                            1.00       1.00</span></span>
<span><span class="co">## alpha0[11]                            1.00       1.01</span></span>
<span><span class="co">## alpha0[12]                            1.00       1.01</span></span>
<span><span class="co">## alpha0[13]                            1.00       1.00</span></span>
<span><span class="co">## alpha0[14]                            1.00       1.00</span></span>
<span><span class="co">## alpha0[15]                            1.00       1.00</span></span>
<span><span class="co">## alpha0[16]                            1.00       1.00</span></span>
<span><span class="co">## alpha0[17]                            1.00       1.01</span></span>
<span><span class="co">## alpha0[18]                            1.00       1.00</span></span>
<span><span class="co">## alpha0[19]                            1.00       1.01</span></span>
<span><span class="co">## alpha0.mean                           1.00       1.01</span></span>
<span><span class="co">## alpha0.sigma                          1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[1]            1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[2]            1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[3]            1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[4]            1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[5]            1.01       1.02</span></span>
<span><span class="co">## beta.ranef.cont.habitat[6]            1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[7]            1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[8]            1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[9]            1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[10]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[11]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[12]           1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[13]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[14]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[15]           1.00       1.01</span></span>
<span><span class="co">## beta.ranef.cont.habitat[16]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[17]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[18]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat[19]           1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat.mean          1.00       1.00</span></span>
<span><span class="co">## beta.ranef.cont.habitat.sigma         1.00       1.01</span></span>
<span><span class="co">## beta0[1]                              1.00       1.00</span></span>
<span><span class="co">## beta0[2]                              1.00       1.00</span></span>
<span><span class="co">## beta0[3]                              1.01       1.02</span></span>
<span><span class="co">## beta0[4]                              1.00       1.00</span></span>
<span><span class="co">## beta0[5]                              1.00       1.00</span></span>
<span><span class="co">## beta0[6]                              1.00       1.02</span></span>
<span><span class="co">## beta0[7]                              1.00       1.00</span></span>
<span><span class="co">## beta0[8]                              1.00       1.02</span></span>
<span><span class="co">## beta0[9]                              1.00       1.00</span></span>
<span><span class="co">## beta0[10]                             1.00       1.00</span></span>
<span><span class="co">## beta0[11]                             1.00       1.01</span></span>
<span><span class="co">## beta0[12]                             1.00       1.01</span></span>
<span><span class="co">## beta0[13]                             1.00       1.01</span></span>
<span><span class="co">## beta0[14]                             1.00       1.00</span></span>
<span><span class="co">## beta0[15]                             1.00       1.00</span></span>
<span><span class="co">## beta0[16]                             1.00       1.00</span></span>
<span><span class="co">## beta0[17]                             1.00       1.01</span></span>
<span><span class="co">## beta0[18]                             1.00       1.00</span></span>
<span><span class="co">## beta0[19]                             1.00       1.01</span></span>
<span><span class="co">## beta0.mean                            1.01       1.02</span></span>
<span><span class="co">## beta0.sigma                           1.00       1.02</span></span></code></pre>
<p>One can also use <code>gelman.plot</code> to create
Gelman-Rubin-Brooks plots (evolution of Gelman-Rubin statistic over
iterations):</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># not shown here due to space reasons</span></span>
<span><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.plot.html" class="external-link">gelman.plot</a></span><span class="op">(</span><span class="va">out_ahm_nimble2</span>,  multivariate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="royle-nichols-model">Royle-Nichols model<a class="anchor" aria-label="anchor" href="#royle-nichols-model"></a>
</h3>
<p>Instead of a standard occupancy model one can fit the occupancy model
of Royle and Nichols (2003), which relates probability of detection of
the species to the number of individuals available for detection at each
site (instead of their occupancy status alone). Probability of occupancy
is a derived parameter: the probability that at least one individual is
available for detection at the site. It is achieve by setting the
parameter “model” to “RN”:</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model1_jags_RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="st">"RN"</span>,</span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"ranef"</span>, occu <span class="op">=</span> <span class="st">"ranef"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_RN</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Site covariates may not be scaled. Scaling is strongly recommended for numeric covariates.</span></span></code></pre>
<pre><code><span><span class="co">## Wrote model to C:\Users\NIEDBA~1\AppData\Local\Temp\Rtmpi03Mlp\file255c5ee657b.txt</span></span></code></pre>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_ahm_jags_RN</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model1_jags_RN</span>, </span>
<span>                    n.iter <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                    n.burnin <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                    thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                    chains <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    quiet <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The models can be processed as shown before, e.g.:</p>
<p>Summary statistics of model parameters:</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_ahm_jags_RN</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5d31a5e531c131e14046" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d31a5e531c131e14046">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.ranef.cont.wind[1]","alpha.obs.ranef.cont.wind[2]","alpha.obs.ranef.cont.wind[3]","alpha.obs.ranef.cont.wind[4]","alpha.obs.ranef.cont.wind[5]","alpha.obs.ranef.cont.wind[6]","alpha.obs.ranef.cont.wind[7]","alpha.obs.ranef.cont.wind[8]","alpha.obs.ranef.cont.wind[9]","alpha.obs.ranef.cont.wind[10]","alpha.obs.ranef.cont.wind[11]","alpha.obs.ranef.cont.wind[12]","alpha.obs.ranef.cont.wind[13]","alpha.obs.ranef.cont.wind[14]","alpha.obs.ranef.cont.wind[15]","alpha.obs.ranef.cont.wind[16]","alpha.obs.ranef.cont.wind[17]","alpha.obs.ranef.cont.wind[18]","alpha.obs.ranef.cont.wind[19]","alpha.obs.ranef.cont.wind.mean","alpha.obs.ranef.cont.wind.sigma","alpha0[1]","alpha0[2]","alpha0[3]","alpha0[4]","alpha0[5]","alpha0[6]","alpha0[7]","alpha0[8]","alpha0[9]","alpha0[10]","alpha0[11]","alpha0[12]","alpha0[13]","alpha0[14]","alpha0[15]","alpha0[16]","alpha0[17]","alpha0[18]","alpha0[19]","alpha0.mean","alpha0.sigma","beta.ranef.cont.habitat[1]","beta.ranef.cont.habitat[2]","beta.ranef.cont.habitat[3]","beta.ranef.cont.habitat[4]","beta.ranef.cont.habitat[5]","beta.ranef.cont.habitat[6]","beta.ranef.cont.habitat[7]","beta.ranef.cont.habitat[8]","beta.ranef.cont.habitat[9]","beta.ranef.cont.habitat[10]","beta.ranef.cont.habitat[11]","beta.ranef.cont.habitat[12]","beta.ranef.cont.habitat[13]","beta.ranef.cont.habitat[14]","beta.ranef.cont.habitat[15]","beta.ranef.cont.habitat[16]","beta.ranef.cont.habitat[17]","beta.ranef.cont.habitat[18]","beta.ranef.cont.habitat[19]","beta.ranef.cont.habitat.mean","beta.ranef.cont.habitat.sigma","beta0[1]","beta0[2]","beta0[3]","beta0[4]","beta0[5]","beta0[6]","beta0[7]","beta0[8]","beta0[9]","beta0[10]","beta0[11]","beta0[12]","beta0[13]","beta0[14]","beta0[15]","beta0[16]","beta0[17]","beta0[18]","beta0[19]","beta0.mean","beta0.sigma"],[19,2.915,3.967,3.918,4.931,3.842,4.055,2.26,3.947,5.033,5.049,3.312,3.085,5.194,5.217,5.404,3.309,4.348,4.283,2.502,4.448,6.358,4.452,7.858,5.301,5.027,6.893,5.327,5.275,5.673,8.648999999999999,1.134,-0.008999999999999999,-0.225,-0.218,0.289,-0.917,-0.613,-0.885,-0.356,0.13,0.791,0.383,-1.355,-0.995,-0.604,-0.043,-0.803,-0.618,-0.4,-0.278,0.8110000000000001,-1.773,-1.275,-1.027,-2.122,-1.861,-1.189,-1.437,0.426,-1.285,-0.03,-2.24,-2.24,-0.878,-1.971,-1.182,-0.655,-1.653,-1.872,-2.143,-1.38,0.99,-0.222,0.096,0.512,1.222,-0.333,0.8149999999999999,0.339,-0.548,0.278,-0.502,1.367,0.735,-0.034,0.973,0.53,0.42,0.619,0.493,0.8120000000000001,0.402,0.736,-1.018,-1.607,-2.164,-1.049,-1.067,0.034,-1.324,-1.405,-1.245,-1.32,-1.264,-1.278,-1.883,-1.377,-1.706,-1.239,-2.033,-1.77,-1.934,-1.388,0.6889999999999999],[0,0.91,0.931,0.9320000000000001,0.9320000000000001,0.889,0.993,1.076,0.918,0.995,0.975,1.139,0.987,1.037,1.053,1.101,1.111,1.12,1.071,1.192,1.14,1.148,1.184,0.916,1.407,1.362,1.27,1.487,1.392,1.273,1.229,0.537,0.397,0.617,0.417,0.349,0.252,0.381,0.394,0.378,0.334,0.569,0.55,0.669,0.484,0.552,0.351,0.629,0.517,0.667,0.238,0.229,0.495,0.574,0.976,0.554,0.53,0.364,0.554,0.404,0.487,0.382,0.6850000000000001,0.678,0.697,0.669,0.611,0.427,0.9370000000000001,0.742,0.9389999999999999,0.306,0.259,0.372,0.454,0.542,0.546,0.386,0.314,0.415,0.366,0.42,0.343,0.607,0.516,0.467,0.542,0.497,0.413,0.554,0.541,0.605,0.226,0.209,0.42,0.464,0.591,0.455,0.467,0.356,0.45,0.35,0.417,0.358,0.517,0.514,0.464,0.517,0.486,0.365,0.604,0.535,0.628,0.228,0.206],[0,0.023,0.024,0.024,0.024,0.023,0.026,0.028,0.024,0.026,0.025,0.029,0.025,0.027,0.027,0.028,0.029,0.029,0.028,0.031,0.029,0.03,0.031,0.024,0.036,0.035,0.033,0.038,0.036,0.033,0.032,0.014,0.01,0.016,0.011,0.008999999999999999,0.006,0.01,0.01,0.01,0.008999999999999999,0.015,0.014,0.017,0.013,0.014,0.008999999999999999,0.016,0.013,0.017,0.006,0.006,0.013,0.015,0.025,0.014,0.014,0.008999999999999999,0.014,0.01,0.013,0.01,0.018,0.017,0.018,0.017,0.016,0.011,0.024,0.019,0.024,0.008,0.007,0.01,0.012,0.014,0.014,0.01,0.008,0.011,0.008999999999999999,0.011,0.008999999999999999,0.016,0.013,0.012,0.014,0.013,0.011,0.014,0.014,0.016,0.006,0.005,0.011,0.012,0.015,0.012,0.012,0.008999999999999999,0.012,0.008999999999999999,0.011,0.008999999999999999,0.013,0.013,0.012,0.013,0.013,0.008999999999999999,0.016,0.014,0.016,0.006,0.005],[0,0.028,0.032,0.026,0.032,0.028,0.031,0.035,0.031,0.03,0.027,0.036,0.031,0.037,0.034,0.035,0.035,0.035,0.035,0.039,0.039,0.037,0.035,0.029,0.056,0.049,0.046,0.054,0.055,0.045,0.043,0.017,0.01,0.016,0.011,0.008999999999999999,0.007,0.011,0.011,0.01,0.008,0.018,0.014,0.02,0.013,0.015,0.008999999999999999,0.017,0.013,0.018,0.006,0.008,0.02,0.02,0.033,0.023,0.022,0.016,0.019,0.012,0.017,0.012,0.035,0.027,0.022,0.027,0.019,0.014,0.035,0.025,0.037,0.011,0.01,0.011,0.012,0.015,0.019,0.012,0.008999999999999999,0.012,0.011,0.012,0.01,0.029,0.015,0.013,0.019,0.015,0.011,0.015,0.017,0.02,0.006,0.008999999999999999,0.021,0.017,0.02,0.02,0.018,0.016,0.017,0.01,0.015,0.01,0.027,0.022,0.014,0.02,0.017,0.011,0.021,0.019,0.025,0.01,0.008999999999999999]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Response curves (marginal effect plots).</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In the occupancy (state) submodel, one can show abundance (the latent quantity modelled) </span></span>
<span><span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_jags_RN</span>, </span>
<span>             <span class="va">out_ahm_jags_RN</span>,</span>
<span>             submodel <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>             response <span class="op">=</span> <span class="st">"abundance"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-96-1.png" width="700"></p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In the occupancy (state) submodel, one can also show occupancy (which is derived from abundance):</span></span>
<span><span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_jags_RN</span>, </span>
<span>             <span class="va">out_ahm_jags_RN</span>,</span>
<span>             submodel <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>             response <span class="op">=</span> <span class="st">"occupancy"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-96-2.png" width="700"></p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_effects-commOccu-method.html">plot_effects</a></span><span class="op">(</span><span class="va">model1_jags_RN</span>, </span>
<span>             <span class="va">out_ahm_jags_RN</span>,</span>
<span>             submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-96-3.png" width="700"></p>
<p>Coefficient plots:</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_jags_RN</span>,</span>
<span>          <span class="va">out_ahm_jags_RN</span>,</span>
<span>          ordered <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $habitat</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-97-1.png" width="700"></p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_coef-commOccu-method.html">plot_coef</a></span><span class="op">(</span><span class="va">model1_jags_RN</span>,</span>
<span>          <span class="va">out_ahm_jags_RN</span>,</span>
<span>          ordered <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          submodel <span class="op">=</span> <span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $wind</span></span></code></pre>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-97-2.png" width="700"></p>
<p>Predictions work as before, but a Royle-Nichols model allows for
returning expected species abundance (lambda) via type = “abundance” and
type = “lambda_array”. Occupancy predictions internally convert
abundance to occupancy.</p>
<p>Occupancy predictions (type = “psi”)</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions_psi_RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object    <span class="op">=</span> <span class="va">model1_jags_RN</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_RN</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"psi"</span>,</span>
<span>                             draws     <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictions_psi_RN</span><span class="op">$</span><span class="va">mean</span>, </span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>       maxnl <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>  <span class="co"># first 9 species only</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-98-1.png" width="700"></p>
<p>Abundance predictions (type = “abundance”):</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions_abundance_RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object    <span class="op">=</span> <span class="va">model1_jags_RN</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_RN</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"abundance"</span>,</span>
<span>                             draws     <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictions_abundance_RN</span><span class="op">$</span><span class="va">mean</span>, </span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>     maxnl <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>   <span class="co"># first 9 species only</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-99-1.png" width="700"></p>
<p>Richness predictions (type = “richness”)</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">predictions_richness_RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object    <span class="op">=</span> <span class="va">model1_jags_RN</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_RN</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"richness"</span>,</span>
<span>                             draws     <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">predictions_richness_RN</span><span class="op">$</span><span class="va">mean</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="camtrapr5_files/figure-html/unnamed-chunk-100-1.png" width="700"></p>
<p>PAO predictions (type = “pao”):</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">predictions_pao_RN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-commOccu-method.html">predict</a></span><span class="op">(</span>object    <span class="op">=</span> <span class="va">model1_jags_RN</span>, </span>
<span>                             mcmc.list <span class="op">=</span> <span class="va">out_ahm_jags_RN</span>,</span>
<span>                             x         <span class="op">=</span> <span class="va">stack_prediction</span>,</span>
<span>                             type      <span class="op">=</span> <span class="st">"pao"</span>,</span>
<span>                             draws     <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No id variables; using all as measure variables</span></span>
<span><span class="co">## No id variables; using all as measure variables</span></span></code></pre>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">predictions_pao_RN</span><span class="op">$</span><span class="va">pao_summary</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c51dd290fcb155dbe3d2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c51dd290fcb155dbe3d2">{"x":{"filter":"none","vertical":false,"data":[["sp1","sp2","sp3","sp4","sp5","sp6","sp7","sp8","sp9","sp10","sp11","sp12","sp13","sp14","sp15","sp16","sp18","sp19","sp20"],[0.143,0.038,0.013,0.121,0.06,0.327,0.082,0.08599999999999999,0.095,0.113,0.104,0.11,0.053,0.083,0.057,0.103,0.013,0.027,0.039],[0.163,0.08799999999999999,0.039,0.206,0.154,0.39,0.119,0.129,0.132,0.154,0.194,0.138,0.068,0.123,0.075,0.141,0.042,0.064,0.058],[0.252,0.15,0.093,0.307,0.242,0.53,0.202,0.201,0.208,0.214,0.276,0.223,0.125,0.231,0.144,0.227,0.113,0.136,0.137],[0.311,0.194,0.138,0.362,0.302,0.602,0.258,0.245,0.272,0.261,0.328,0.267,0.162,0.303,0.19,0.273,0.164,0.195,0.203],[0.313,0.209,0.148,0.366,0.319,0.599,0.272,0.248,0.275,0.27,0.336,0.284,0.169,0.3,0.202,0.28,0.171,0.203,0.211],[0.373,0.255,0.191,0.417,0.384,0.669,0.325,0.287,0.328,0.31,0.391,0.326,0.208,0.364,0.255,0.327,0.218,0.271,0.272],[0.501,0.388,0.312,0.535,0.589,0.8,0.496,0.393,0.477,0.428,0.527,0.534,0.299,0.51,0.367,0.432,0.33,0.384,0.397],[0.542,0.613,0.449,0.67,0.735,0.833,0.57,0.458,0.716,0.472,0.676,0.649,0.383,0.634,0.487,0.51,0.39,0.435,0.525]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Min.<\/th>\n      <th>lower.ci.0.025<\/th>\n      <th>1st Qu.<\/th>\n      <th>Median<\/th>\n      <th>Mean<\/th>\n      <th>3rd Qu.<\/th>\n      <th>upper.ci.0.975<\/th>\n      <th>Max.<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="single-species-occupancy-models">Single-species occupancy models<a class="anchor" aria-label="anchor" href="#single-species-occupancy-models"></a>
</h3>
<p>Incidentally, the workflow above can be used for single-species
models too. The code will be less streamlined and possibly slower than
normal code for single-species models (due to the species loop which is
unnecessary for single-species models), but it is possible.</p>
<p>To create a single-species occupancy model, simply pass a single
detection history in the data_list$ylist of the input to
<code>communityModel</code>.</p>
<p>Take care to only define fixed effects for covariates and the
intercepts, not random effects of species. It is possible however to
specify random effects of categorical site covariates on continuous site
covariates as in the example below.</p>
<p>In this example we use species 1 from the community created with
<code><a href="https://rdrr.io/pkg/AHMbook/man/simComm.html" class="external-link">AHMbook::simComm</a></code>.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_AHM_sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ylist <span class="op">=</span> <span class="va">ylist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,    <span class="co"># ylist[1] is still a list, with 1 element</span></span>
<span>                      siteCovs <span class="op">=</span> <span class="va">input_AHM</span><span class="op">$</span><span class="va">siteCovs</span>,</span>
<span>                      obsCovs <span class="op">=</span> <span class="va">input_AHM</span><span class="op">$</span><span class="va">obsCovs</span><span class="op">)</span></span></code></pre></div>
<p>Create model:</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFile_jags_sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_sp1_jags_ranef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/communityModel.html">communityModel</a></span><span class="op">(</span></span>
<span>  occuCovs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"habitat|categ"</span><span class="op">)</span><span class="op">)</span>,    <span class="co"># response to habitat differs between categ via random effect</span></span>
<span>  detCovsObservation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="st">"wind"</span><span class="op">)</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"fixed"</span>, occu <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span>,</span>
<span>  data_list <span class="op">=</span> <span class="va">input_AHM_sp1</span>,</span>
<span>  modelFile <span class="op">=</span> <span class="va">modelFile_jags_sp1</span><span class="op">)</span></span></code></pre></div>
<p>Fit model:</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_jags_sp1</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">model_sp1_jags_ranef</span>, n.iter <span class="op">=</span> <span class="fl">1000</span>, n.burnin <span class="op">=</span> <span class="fl">500</span>, thin <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Print summary statistics:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_jags_sp1</span><span class="op">)</span><span class="op">$</span><span class="va">statistics</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-aa74129ae6b166901a95" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-aa74129ae6b166901a95">{"x":{"filter":"none","vertical":false,"data":[["Nspecies","Nspecies_station[1]","Nspecies_station[2]","Nspecies_station[3]","Nspecies_station[4]","Nspecies_station[5]","Nspecies_station[6]","Nspecies_station[7]","Nspecies_station[8]","Nspecies_station[9]","Nspecies_station[10]","Nspecies_station[11]","Nspecies_station[12]","Nspecies_station[13]","Nspecies_station[14]","Nspecies_station[15]","Nspecies_station[16]","Nspecies_station[17]","Nspecies_station[18]","Nspecies_station[19]","Nspecies_station[20]","Nspecies_station[21]","Nspecies_station[22]","Nspecies_station[23]","Nspecies_station[24]","Nspecies_station[25]","Nspecies_station[26]","Nspecies_station[27]","Nspecies_station[28]","Nspecies_station[29]","Nspecies_station[30]","alpha.obs.fixed.cont.wind","alpha0","beta.ranef.cont.habitat_categ[1]","beta.ranef.cont.habitat_categ[2]","beta.ranef.cont.habitat_categ[3]","beta.ranef.cont.habitat_categ.mean","beta.ranef.cont.habitat_categ.sigma","beta0"],[1,0.797,1,0.6,1,0.523,0.633,0.5629999999999999,0.533,1,0.543,0.463,1,0.64,1,0.62,1,0.46,0.5629999999999999,0.477,1,0.36,0.25,0.133,0.073,0.08699999999999999,0.283,0.31,0.27,0.293,1,1.758,-2.333,-10.814,-10.856,4.515,-1.293,12.622,0.064],[0,0.403,0,0.491,0,0.5,0.483,0.497,0.5,0,0.499,0.499,0,0.481,0,0.486,0,0.499,0.497,0.5,0,0.481,0.434,0.341,0.261,0.282,0.451,0.463,0.445,0.456,0,0.716,0.662,16.944,22.195,14.664,2.969,25.619,2.03],[0,0.023,0,0.028,0,0.029,0.028,0.029,0.029,0,0.029,0.029,0,0.028,0,0.028,0,0.029,0.029,0.029,0,0.028,0.025,0.02,0.015,0.016,0.026,0.027,0.026,0.026,0,0.041,0.038,0.978,1.281,0.847,0.171,1.479,0.117],[0,0.023,0,0.062,0,0.08400000000000001,0.06,0.064,0.06,0,0.08500000000000001,0.073,0,0.04,0,0.048,0,0.101,0.058,0.103,0,0.037,0.07099999999999999,0.04,0.036,0.047,0.064,0.076,0.096,0.096,0,0.076,0.066,3.667,7.049,3.874,0.2,6.991,0.305]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Mean<\/th>\n      <th>SD<\/th>\n      <th>Naive SE<\/th>\n      <th>Time-series SE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>The <code><a href="../reference/plot_effects-commOccu-method.html">plot_effects()</a></code> and <code><a href="../reference/plot_coef-commOccu-method.html">plot_coef()</a></code>
functions currently don’t work for this case, since single-species
models are mostly a side-effect of the intended community occupancy
workflow and not the main goal. There are other great options for
Bayesian single-species occupancy models, e.g. in the packages ubms or
wiqid, or unmarked for a frequentist implementation.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Juergen Niedballa, Alexandre Courtiol, Rahel Sollmann.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
