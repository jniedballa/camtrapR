<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Write values to DateTimeOriginal tag in image metadata — writeDateTimeOriginal • camtrapR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Write values to DateTimeOriginal tag in image metadata — writeDateTimeOriginal"><meta property="og:description" content="This function assigns values to the DateTimeOriginal tag in image's EXIF
metadata using Exiftool. It can be used when the original DateTimeOriginal
values in the metadata were lost for whatever reason. In order to first read
the Date/Time values from the data fields in the images, see the function
OCRdataFields. After running OCRdataFields and checking
its output you can run writeDateTimeOriginal."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">camtrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/camtrapr1.html">1. Organising raw camera trap images in camtrapR</a>
    </li>
    <li>
      <a href="../articles/camtrapr2.html">2. Species and Individual Identification</a>
    </li>
    <li>
      <a href="../articles/camtrapr3.html">3. Data Extraction from Images and videos, creating occupancy &amp; secr input</a>
    </li>
    <li>
      <a href="../articles/camtrapr4.html">4. Data exploration and visualisation</a>
    </li>
    <li>
      <a href="../articles/camtrapr5.html">5. Multi-species occupancy models</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jniedballa/camtrapR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Write values to DateTimeOriginal tag in image metadata</h1>
    <small class="dont-index">Source: <a href="https://github.com/jniedballa/camtrapR/blob/HEAD/R/writeDateTimeOriginal.R" class="external-link"><code>R/writeDateTimeOriginal.R</code></a></small>
    <div class="hidden name"><code>writeDateTimeOriginal.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function assigns values to the DateTimeOriginal tag in image's EXIF
metadata using Exiftool. It can be used when the original DateTimeOriginal
values in the metadata were lost for whatever reason. In order to first read
the Date/Time values from the data fields in the images, see the function
<code><a href="OCRdataFields.html">OCRdataFields</a></code>. After running <code>OCRdataFields</code> and checking
its output you can run <code>writeDateTimeOriginal</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">writeDateTimeOriginal</span><span class="op">(</span><span class="va">DateTimeOriginal</span>, <span class="va">fileNames</span>, <span class="va">parallel</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>DateTimeOriginal</dt>
<dd><p>character. DateTimeOriginal values to write into
EXIF:DateTimeOriginal tag of the files in fileNames.</p></dd>


<dt>fileNames</dt>
<dd><p>character. Full file names (including directories) of
images to process.</p></dd>


<dt>parallel</dt>
<dd><p>A parallel cluster object. Specify if you wish to run this
function in parallel. Provide a cluster object (output of makeCluster()) -
optional.</p></dd>


<dt>overwrite</dt>
<dd><p>logical. Overwrite existing files (TRUE) or create new
files while saving the original data as jpg_original files as a backup
(FALSE)?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Invisible NULL. The actual output is the JPG images which now have a
DateTimeOriginal tag.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The first value in <code>DateTimeOriginal</code> will be assigned to the first
image in <code>fileNames</code>, and so on. Both <code>DateTimeOriginal</code> and
<code>fileNames</code> can be obtained from the output of
<code><a href="OCRdataFields.html">OCRdataFields</a></code>.  <code>DateTimeOriginal</code> uses the standard
"YYYY-MM-SS HH:MM:SS"" notation. If the values extracted via
<code><a href="OCRdataFields.html">OCRdataFields</a></code> are in a different format you'll need to
reformat them first. Please provide them as character. Also, before using
this function, make sure that the date/time values read by
<code><a href="OCRdataFields.html">OCRdataFields</a></code> are correct (sometimes OCR misreads values, so
check carefully).</p>
<p>Parallel processing is advised since the function is rather slow (due to
calling Exiftool separately on every, so about 1 second per image). If you
know how to batch-assign DateTimeOriginal values in one Exiftool call,
please let me know.</p>
<p>The function only works on JPG images, not video files.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="OCRdataFields.html">OCRdataFields</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Juergen Niedballa</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># dontrun is to avoid forcing users to install additional dependencies</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wd_images_OCR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"pictures/full_size_for_ocr"</span>, package <span class="op">=</span> <span class="st">"camtrapR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define geometries</span></span></span>
<span class="r-in"><span><span class="va">geometry1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/geometry.html" class="external-link">geometry_area</a></span><span class="op">(</span>x_off <span class="op">=</span> <span class="fl">0</span>, y_off <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">183</span>, height <span class="op">=</span> <span class="fl">37</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geometry2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/geometry.html" class="external-link">geometry_area</a></span><span class="op">(</span>x_off <span class="op">=</span> <span class="fl">196</span>, y_off <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">200</span>, height <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geometry3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/geometry.html" class="external-link">geometry_area</a></span><span class="op">(</span>x_off <span class="op">=</span> <span class="fl">447</span>, y_off <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">63</span>, height <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geometry4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/geometry.html" class="external-link">geometry_area</a></span><span class="op">(</span>x_off <span class="op">=</span> <span class="fl">984</span>, y_off <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">47</span>, height <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">geometry5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/magick/reference/geometry.html" class="external-link">geometry_area</a></span><span class="op">(</span>x_off <span class="op">=</span> <span class="fl">0</span>, y_off <span class="op">=</span> <span class="fl">793</span>, width <span class="op">=</span> <span class="fl">320</span>, height <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine geometries into list</span></span></span>
<span class="r-in"><span><span class="va">geometries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">geometry1</span>, </span></span>
<span class="r-in"><span>                   time <span class="op">=</span> <span class="va">geometry2</span>, </span></span>
<span class="r-in"><span>                   sequence_id <span class="op">=</span> <span class="va">geometry3</span>,</span></span>
<span class="r-in"><span>                   temperature <span class="op">=</span> <span class="va">geometry4</span>,</span></span>
<span class="r-in"><span>                   camera_model <span class="op">=</span> <span class="va">geometry5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_image_data</span>  <span class="op">&lt;-</span> <span class="fu"><a href="OCRdataFields.html">OCRdataFields</a></span><span class="op">(</span>inDir <span class="op">=</span> <span class="va">wd_images_OCR</span>,</span></span>
<span class="r-in"><span>                                geometries <span class="op">=</span> <span class="va">geometries</span>, </span></span>
<span class="r-in"><span>                                invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>       </span></span>
<span class="r-in"><span><span class="va">df_image_data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prepare DateTimeOriginal column (ymd_hms() automatically respects the PM indicator)</span></span></span>
<span class="r-in"><span><span class="va">df_image_data</span><span class="op">$</span><span class="va">DateTimeOriginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">df_image_data</span><span class="op">$</span><span class="va">date</span>, <span class="va">df_image_data</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_image_data</span><span class="op">$</span><span class="va">DateTimeOriginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">df_image_data</span><span class="op">$</span><span class="va">DateTimeOriginal</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create cluster (3 cores)</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assign new DateTimeOriginal</span></span></span>
<span class="r-in"><span><span class="fu">writeDateTimeOriginal</span><span class="op">(</span>DateTimeOriginal <span class="op">=</span> <span class="va">df_image_data</span><span class="op">$</span><span class="va">DateTimeOriginal</span>,</span></span>
<span class="r-in"><span>                      fileNames <span class="op">=</span> <span class="va">df_image_data</span><span class="op">$</span><span class="va">filename_full</span>,</span></span>
<span class="r-in"><span>                      parallel <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span>                      </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Juergen Niedballa, Alexandre Courtiol, Rahel Sollmann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

